<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>äº‘åŸç”Ÿ</title>
      <link href="/2024/11/01/%E4%BA%91%E5%8E%9F%E7%94%9F/"/>
      <url>/2024/11/01/%E4%BA%91%E5%8E%9F%E7%94%9F/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
        <tags>
            
            <tag> äº‘åŸç”Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring Cloud</title>
      <link href="/2024/08/25/Spring%20Cloud/"/>
      <url>/2024/08/25/Spring%20Cloud/</url>
      
        <content type="html"><![CDATA[<h1 id="1-ä»‹ç»-ğŸš€"><a href="#1-ä»‹ç»-ğŸš€" class="headerlink" title="1. ä»‹ç» ğŸš€"></a><strong>1. ä»‹ç» ğŸš€</strong></h1><p><strong>ä¼ ç»Ÿçš„å•ä½“æ¶æ„åœ¨æ»¡è¶³ä¸­å°å‹é¡¹ç›®éœ€æ±‚æ–¹é¢è¡¨ç°å°šå¯ï¼Œç„¶è€Œï¼Œå½“é¢å¯¹ç”¨æˆ·é‡åºå¤§çš„ç³»ç»Ÿæ—¶ï¼Œå°±ä¼šæš´éœ²å‡ºè¯¸å¤šé—®é¢˜ã€‚</strong></p><blockquote><p>ä¾‹å¦‚ï¼Œè‹¥ä»…æœ‰ä¸€ä¸ªæ”¯ä»˜ç³»ç»Ÿï¼Œä¸€æ—¦è¯¥ç³»ç»Ÿå´©æºƒï¼Œæ•´ä¸ªç³»ç»Ÿä¾¿æ— æ³•æ­£å¸¸è¿ä½œã€‚</p><p>è€Œå¾®æœåŠ¡æ¶æ„åˆ™æœ‰æ•ˆåœ°è§£å†³äº†è¿™ä¸€é—®é¢˜ï¼Œå®ƒèƒ½å¤Ÿä½¿ç³»ç»Ÿä»¥é›†ç¾¤å½¢å¼è¿›è¡Œéƒ¨ç½²ï¼Œä»è€Œå½¢æˆè´Ÿè½½å‡è¡¡ï¼Œæœ€å¤§é™åº¦åœ°å‡å°‘ç³»ç»Ÿå´©æºƒæ‰€å¸¦æ¥çš„ä¸è‰¯å½±å“ã€‚</p></blockquote><p>ç»„ä»¶ä»‹ç»ï¼š</p><img src="/2024/08/25/Spring%20Cloud/%E4%BB%8B%E7%BB%8D.png" class="" title="ä»‹ç»"><blockquote><p>æ³¨å†Œä¸å‘ç°</p></blockquote><ul><li>Eurekaã€Netflixæœ€åçš„ç«ç§ï¼Œä¸æ¨èã€‘</li><li>Consulã€æ¨èä½¿ç”¨ã€‘</li><li>Etcd</li><li><strong>Nacosã€æ¨èä½¿ç”¨ï¼Œå‘éŸ³ï¼šå‘æ‰£ä¸ï¼Œé˜¿é‡Œå·´å·´æä¾›çš„ã€‘</strong></li></ul><blockquote><p>æœåŠ¡è°ƒç”¨å’Œè´Ÿè½½å‡è¡¡</p></blockquote><ul><li>Ribbonã€Netflixæä¾›çš„ï¼Œå»ºè®®ç›´æ¥å¼ƒç”¨ã€‘</li><li>OpenFeign</li><li>LoadBalancer</li></ul><blockquote><p>åˆ†å¸ƒå¼äº‹åŠ¡</p></blockquote><ul><li><strong>Seataã€æ¨èä½¿ç”¨ï¼Œé˜¿é‡Œå·´å·´çš„ã€‘</strong></li><li>LCN</li><li>Hmily</li></ul><blockquote><p>æœåŠ¡ç†”æ–­å’Œé™çº§</p></blockquote><ul><li>Hystrixã€å·²ç»åœæ›´äº†ï¼Œä¸æ¨èã€‘</li><li>CircuitBreakerã€è¿™åªä¸€å¥—è§„èŒƒï¼Œä½¿ç”¨çš„æ˜¯å®ƒçš„å®ç°ç±»ã€‘</li><li>Resilience4Jã€CircuitBreakerçš„å®ç°ç±»ï¼Œå¯ä»¥ä½¿ç”¨ã€‘</li><li><strong>Sentinelã€é˜¿é‡Œå·´å·´çš„ï¼Œæ¨èä½¿ç”¨ã€‘</strong></li></ul><blockquote><p>æœåŠ¡é“¾è·¯è¿½è¸ª</p></blockquote><ul><li>Sleuthã€é€æ¸è¢«æ›¿ä»£äº†ï¼Œä¸æ¨èã€‘</li><li><strong>Micrometer Tracingã€æ¨èä½¿ç”¨ã€‘</strong></li></ul><blockquote><p>æœåŠ¡ç½‘å…³</p></blockquote><ul><li>Zuulã€ä¸æ¨èä½¿ç”¨ã€‘</li><li><strong>Gate Way</strong></li></ul><blockquote><p>åˆ†å¸ƒå¼é…ç½®ç®¡ç†</p></blockquote><ul><li>Config+Busã€ä¸æ¨èäº†ã€‘</li><li>Consul</li><li><strong>Nacos</strong></li></ul><h2 id="1-1-é¡¹ç›®æ„å»º"><a href="#1-1-é¡¹ç›®æ„å»º" class="headerlink" title="1.1 é¡¹ç›®æ„å»º"></a><em>1.1 é¡¹ç›®æ„å»º</em></h2><p><strong>é¦–å…ˆåˆ›å»ºä¸€ä¸ªmavençˆ¶å·¥ç¨‹ï¼Œè¯¥é¡¹ç›®åªç•™ä¸‹pom.xmlæ–‡ä»¶ï¼Œ</strong></p><p>åœ¨pom.xmlæ–‡ä»¶ä¸­å†™å…¥ä»¥ä¸‹é…ç½®ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">hutool.version</span>&gt;</span>5.8.22<span class="tag">&lt;/<span class="name">hutool.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">lombok.version</span>&gt;</span>1.18.26<span class="tag">&lt;/<span class="name">lombok.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">druid.version</span>&gt;</span>1.1.20<span class="tag">&lt;/<span class="name">druid.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mybatis.springboot.version</span>&gt;</span>3.0.2<span class="tag">&lt;/<span class="name">mybatis.springboot.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mysql.version</span>&gt;</span>8.0.11<span class="tag">&lt;/<span class="name">mysql.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">swagger3.version</span>&gt;</span>2.2.0<span class="tag">&lt;/<span class="name">swagger3.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper.version</span>&gt;</span>4.2.3<span class="tag">&lt;/<span class="name">mapper.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">fastjson2.version</span>&gt;</span>2.0.40<span class="tag">&lt;/<span class="name">fastjson2.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">persistence-api.version</span>&gt;</span>1.0.2<span class="tag">&lt;/<span class="name">persistence-api.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">spring.boot.test.version</span>&gt;</span>3.1.5<span class="tag">&lt;/<span class="name">spring.boot.test.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">spring.boot.version</span>&gt;</span>3.2.0<span class="tag">&lt;/<span class="name">spring.boot.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">spring.cloud.version</span>&gt;</span>2023.0.0<span class="tag">&lt;/<span class="name">spring.cloud.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">spring.cloud.alibaba.version</span>&gt;</span>2022.0.0.0-RC2<span class="tag">&lt;/<span class="name">spring.cloud.alibaba.version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--springboot 3.2.0--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.boot.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--springcloud 2023.0.0--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.cloud.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--springcloud alibaba 2022.0.0.0-RC2--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-alibaba-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.cloud.alibaba.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--SpringBooté›†æˆmybatis--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mybatis.springboot.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--Mysqlæ•°æ®åº“é©±åŠ¨8 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mysql.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--SpringBooté›†æˆdruidè¿æ¥æ± --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;druid.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--é€šç”¨Mapper4ä¹‹tk.mybatis--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>tk.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mapper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mapper.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--persistence--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.persistence<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>persistence-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;persistence-api.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- fastjson2 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.fastjson2<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;fastjson2.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- swagger3 è°ƒç”¨æ–¹å¼ http://ä½ çš„ä¸»æœºIPåœ°å€:5555/swagger-ui/index.html --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springdoc<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springdoc-openapi-starter-webmvc-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;swagger3.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--hutool--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.hutool<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hutool-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;hutool.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--lombok--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;lombok.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- spring-boot-starter-test --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.boot.test.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>æ–°å»ºæ•°æ®åº“ï¼Œè®¾ç½® t_payè¡¨ï¼š</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `t_pay`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `t_pay` (</span><br><span class="line">  `id` <span class="type">INT</span>(<span class="number">10</span>) UNSIGNED <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `pay_no` <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ”¯ä»˜æµæ°´å·&#x27;</span>,</span><br><span class="line">  `order_no` <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;è®¢å•æµæ°´å·&#x27;</span>,</span><br><span class="line">  `user_id` <span class="type">INT</span>(<span class="number">10</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;1&#x27;</span> COMMENT <span class="string">&#x27;ç”¨æˆ·è´¦å·ID&#x27;</span>,</span><br><span class="line">  `amount` <span class="type">DECIMAL</span>(<span class="number">8</span>,<span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;9.9&#x27;</span> COMMENT <span class="string">&#x27;äº¤æ˜“é‡‘é¢&#x27;</span>,</span><br><span class="line">  `deleted` TINYINT(<span class="number">4</span>) UNSIGNED <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;åˆ é™¤æ ‡å¿—ï¼Œé»˜è®¤0ä¸åˆ é™¤ï¼Œ1åˆ é™¤&#x27;</span>,</span><br><span class="line">  `create_time` <span class="type">TIMESTAMP</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">  `update_time` <span class="type">TIMESTAMP</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;æ›´æ–°æ—¶é—´&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line"></span><br><span class="line">) ENGINE<span class="operator">=</span>INNODB AUTO_INCREMENT<span class="operator">=</span><span class="number">1</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 COMMENT<span class="operator">=</span><span class="string">&#x27;æ”¯ä»˜äº¤æ˜“è¡¨&#x27;</span>;</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_pay(pay_no,order_no) <span class="keyword">VALUES</span>(<span class="string">&#x27;pay17203699&#x27;</span>,<span class="string">&#x27;6544bafb424a&#x27;</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> t_pay;</span><br></pre></td></tr></table></figure><p><strong>åˆ›å»ºä¸€ä¸ªmybatisè‡ªåŠ¨ç”Ÿæˆæ¨¡å—</strong><br>åœ¨çˆ¶å·¥ç¨‹ä¸‹åˆ›å»ºä¸€ä¸ªå­æ¨¡å—ï¼Œè¯¥æ¨¡å—çš„ä½œç”¨åªç”¨äºæ ¹æ®æ•°æ®åº“ç”Ÿæˆå®ä½“ç±»</p><p>è¯¥æ¨¡å—çš„pomï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--Mybatis é€šç”¨mapper tkå•ç‹¬ä½¿ç”¨ï¼Œè‡ªå·±ç‹¬æœ‰+è‡ªå¸¦ç‰ˆæœ¬å·--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.13<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Mybatis Generator è‡ªå·±ç‹¬æœ‰+è‡ªå¸¦ç‰ˆæœ¬å·--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--é€šç”¨Mapper--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>tk.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mapper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--mysql8.0--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--persistence--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.persistence<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>persistence-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--hutool--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.hutool<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hutool-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--lombok--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.vintage<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-vintage-engine<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">directory</span>&gt;</span>$&#123;basedir&#125;/src/main/java<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">directory</span>&gt;</span>$&#123;basedir&#125;/src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">excludes</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">exclude</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">exclude</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">excludes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">configurationFile</span>&gt;</span>$&#123;basedir&#125;/src/main/resources/generatorConfig.xml<span class="tag">&lt;/<span class="name">configurationFile</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">overwrite</span>&gt;</span>true<span class="tag">&lt;/<span class="name">overwrite</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">verbose</span>&gt;</span>true<span class="tag">&lt;/<span class="name">verbose</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.33<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>tk.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mapper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.2.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨å­æ¨¡å—çš„resourcesä¸‹æ–°å»ºæ–‡ä»¶config.properties</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#t_payè¡¨åŒ…å</span></span><br><span class="line"><span class="attr">package.name</span>=<span class="string">com.atguigu.cloud</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># mysql8.0</span></span><br><span class="line"><span class="attr">jdbc.driverClass</span> = <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">jdbc.url</span>= <span class="string">jdbc:mysql://localhost:3306/db2024?characterEncoding=utf8&amp;useSSL=false&amp;serverTimezone=GMT%2B8&amp;rewriteBatchedStatements=true&amp;allowPublicKeyRetrieval=true</span></span><br><span class="line"><span class="attr">jdbc.user</span> = <span class="string">root</span></span><br><span class="line"><span class="attr">jdbc.password</span> =<span class="string">123456</span></span><br></pre></td></tr></table></figure><p>åœ¨å­æ¨¡å—çš„resourcesä¸‹æ–°å»ºæ–‡ä»¶generatorConfig.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">generatorConfiguration</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">generatorConfiguration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">&quot;config.properties&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">context</span> <span class="attr">id</span>=<span class="string">&quot;Mysql&quot;</span> <span class="attr">targetRuntime</span>=<span class="string">&quot;MyBatis3Simple&quot;</span> <span class="attr">defaultModelType</span>=<span class="string">&quot;flat&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;beginningDelimiter&quot;</span> <span class="attr">value</span>=<span class="string">&quot;`&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;endingDelimiter&quot;</span> <span class="attr">value</span>=<span class="string">&quot;`&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span> <span class="attr">type</span>=<span class="string">&quot;tk.mybatis.mapper.generator.MapperPlugin&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;mappers&quot;</span> <span class="attr">value</span>=<span class="string">&quot;tk.mybatis.mapper.common.Mapper&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;caseSensitive&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">jdbcConnection</span> <span class="attr">driverClass</span>=<span class="string">&quot;$&#123;jdbc.driverClass&#125;&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">connectionURL</span>=<span class="string">&quot;$&#123;jdbc.url&#125;&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">userId</span>=<span class="string">&quot;$&#123;jdbc.user&#125;&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">password</span>=<span class="string">&quot;$&#123;jdbc.password&#125;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">jdbcConnection</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaModelGenerator</span> <span class="attr">targetPackage</span>=<span class="string">&quot;$&#123;package.name&#125;.entities&quot;</span> <span class="attr">targetProject</span>=<span class="string">&quot;src/main/java&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">sqlMapGenerator</span> <span class="attr">targetPackage</span>=<span class="string">&quot;$&#123;package.name&#125;.mapper&quot;</span> <span class="attr">targetProject</span>=<span class="string">&quot;src/main/java&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaClientGenerator</span> <span class="attr">targetPackage</span>=<span class="string">&quot;$&#123;package.name&#125;.mapper&quot;</span> <span class="attr">targetProject</span>=<span class="string">&quot;src/main/java&quot;</span> <span class="attr">type</span>=<span class="string">&quot;XMLMAPPER&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">&quot;t_pay&quot;</span> <span class="attr">domainObjectName</span>=<span class="string">&quot;Pay&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">generatedKey</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> <span class="attr">sqlStatement</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">generatorConfiguration</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>åˆ›å»ºä¸šåŠ¡é€»è¾‘æ¨¡å—ï¼ˆcloud-provider-payment8001ï¼‰</strong><br>å¾®æœåŠ¡å°å£è¯€ï¼š<br>1ã€å»ºmodule<br>2ã€æ”¹pom<br>3ã€å†™yml<br>4ã€ä¸»å¯åŠ¨<br>5ã€ä¸šåŠ¡ç±»</p><blockquote><p>Spring cloud æ˜¯ä¸€ç³»åˆ—æ¡†æ¶çš„æœ‰åºé›†åˆã€‚å®ƒåˆ©ç”¨ spring boot çš„å¼€å‘ä¾¿åˆ©æ€§å·§å¦™åœ°ç®€åŒ–äº†åˆ†å¸ƒå¼ç³»ç»ŸåŸºç¡€è®¾æ–½çš„å¼€å‘ï¼Œå¦‚æœåŠ¡å‘ç°æ³¨å†Œã€é…ç½®ä¸­å¿ƒã€æ¶ˆæ¯æ€»çº¿ã€è´Ÿè½½å‡è¡¡ã€æ–­è·¯å™¨ã€æ•°æ®ç›‘æ§ç­‰ï¼Œéƒ½å¯ä»¥ç”¨ spring boot çš„å¼€å‘é£æ ¼åšåˆ°ä¸€é”®å¯åŠ¨å’Œéƒ¨ç½²ã€‚Spring Cloud å¹¶ä¸é‡å¤é€ è½®å­ï¼Œè€Œæ˜¯å°†å¸‚é¢ä¸Šå¼€å‘å¾—æ¯”è¾ƒå¥½çš„æ¨¡å—é›†æˆè¿›å»ï¼Œè¿›è¡Œå°è£…ï¼Œä»è€Œå‡å°‘äº†å„æ¨¡å—çš„å¼€å‘æˆæœ¬ã€‚æ¢å¥è¯è¯´ï¼šSpring Cloud æä¾›äº†æ„å»ºåˆ†å¸ƒå¼ç³»ç»Ÿæ‰€éœ€çš„â€œå…¨å®¶æ¡¶â€ã€‚é’ˆå¯¹æ¯ç±»åŸºç¡€æœåŠ¡ï¼Œæœ‰å¯¹åº”çš„è½åœ°æŠ€æœ¯æ¥å®ç°ï¼Œä¸‹é¢å°†å±•å¼€ä»‹ç»ã€‚</p></blockquote><h1 id="Consul-ğŸš€"><a href="#Consul-ğŸš€" class="headerlink" title="Consul ğŸš€"></a><strong>Consul ğŸš€</strong></h1><p><strong>Consul æ˜¯ä¸€å¥—å¼€æºçš„åˆ†å¸ƒå¼æœåŠ¡å‘ç°å’Œé…ç½®ç®¡ç†ç³»ç»Ÿã€‚</strong>æä¾›äº†å¾®æœåŠ¡ç³»ç»Ÿä¸­çš„æœåŠ¡æ²»ç†ã€é…ç½®ä¸­å¿ƒã€æ§åˆ¶æ€»çº¿ç­‰åŠŸèƒ½ã€‚è¿™äº›åŠŸèƒ½ä¸­çš„æ¯ä¸€ä¸ªéƒ½å¯ä»¥æ ¹æ®éœ€è¦å•ç‹¬ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ä¸€èµ·ä½¿ç”¨ä»¥æ„å»ºå…¨æ–¹ä½çš„æœåŠ¡ç½‘æ ¼ï¼Œæ€»ä¹‹Consulæä¾›äº†ä¸€ç§å®Œæ•´çš„æœåŠ¡ç½‘æ ¼è§£å†³æ–¹æ¡ˆã€‚<br>å®ƒæä¾›äº†æä¾›<strong>æœåŠ¡å‘ç°</strong>ã€<strong>KVå­˜å‚¨</strong>ã€<strong>å¯è§†åŒ–Webé¡µé¢</strong>ç­‰åŠŸèƒ½</p><h2 id="ä¸ºä»€ä¹ˆéœ€è¦æœåŠ¡æ³¨å†Œä¸å‘ç°"><a href="#ä¸ºä»€ä¹ˆéœ€è¦æœåŠ¡æ³¨å†Œä¸å‘ç°" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦æœåŠ¡æ³¨å†Œä¸å‘ç°"></a>ä¸ºä»€ä¹ˆéœ€è¦æœåŠ¡æ³¨å†Œä¸å‘ç°</h2><blockquote><p>å¦‚æœè®¢å•å¾®æœåŠ¡å’Œæ”¯ä»˜å¾®æœåŠ¡çš„IPåœ°å€æˆ–è€…ç«¯å£å·å‘ç”Ÿäº†å˜åŒ–ï¼Œåˆ™æ”¯ä»˜å¾®æœåŠ¡å°†å˜å¾—ä¸å¯ç”¨ï¼Œéœ€è¦åŒæ­¥ä¿®æ”¹è®¢å•å¾®æœåŠ¡ä¸­è°ƒç”¨æ”¯ä»˜å¾®æœåŠ¡çš„IPåœ°å€å’Œç«¯å£å·ã€‚</p><p>å¦‚æœç³»ç»Ÿä¸­æä¾›äº†å¤šä¸ªè®¢å•å¾®æœåŠ¡å’Œæ”¯ä»˜å¾®æœåŠ¡ï¼Œåˆ™æ— æ³•å®ç°å¾®æœåŠ¡çš„è´Ÿè½½å‡è¡¡åŠŸèƒ½ã€‚</p><p>å¦‚æœç³»ç»Ÿéœ€è¦æ”¯æŒæ›´é«˜çš„å¹¶å‘ï¼Œéœ€è¦éƒ¨ç½²æ›´å¤šçš„è®¢å•å¾®æœåŠ¡å’Œæ”¯ä»˜å¾®æœåŠ¡ï¼Œç¡¬ç¼–ç è®¢å•å¾®æœåŠ¡åˆ™åç»­çš„ç»´æŠ¤ä¼šå˜å¾—å¼‚å¸¸å¤æ‚ã€‚</p></blockquote><h2 id="ä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼é…ç½®ç®¡ç†"><a href="#ä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼é…ç½®ç®¡ç†" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼é…ç½®ç®¡ç†"></a>ä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼é…ç½®ç®¡ç†</h2><blockquote><p>å¾®æœåŠ¡æ„å‘³ç€è¦å°†å•ä½“åº”ç”¨ä¸­çš„ä¸šåŠ¡æ‹†åˆ†æˆä¸€ä¸ªä¸ªå­æœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡çš„ç²’åº¦ç›¸å¯¹è¾ƒå°ï¼Œå› æ­¤ç³»ç»Ÿä¸­ä¼šå‡ºç°å¤§é‡çš„æœåŠ¡ã€‚</p><p>ç”±äºæ¯ä¸ªæœåŠ¡éƒ½éœ€è¦å¿…è¦çš„é…ç½®ä¿¡æ¯æ‰èƒ½è¿è¡Œï¼Œæ‰€ä»¥ä¸€å¥—é›†ä¸­å¼çš„ã€åŠ¨æ€çš„é…ç½®ç®¡ç†è®¾æ–½æ˜¯å¿…ä¸å¯å°‘çš„ã€‚</p><p>æ¯”å¦‚æŸäº›é…ç½®æ–‡ä»¶ä¸­çš„å†…å®¹å¤§éƒ¨åˆ†éƒ½æ˜¯ç›¸åŒçš„ï¼Œåªæœ‰ä¸ªåˆ«çš„é…ç½®é¡¹ä¸åŒã€‚</p><p>å°±æ‹¿æ•°æ®åº“é…ç½®æ¥è¯´å§ï¼Œå¦‚æœæ¯ä¸ªå¾®æœåŠ¡ä½¿ç”¨çš„æŠ€æœ¯æ ˆéƒ½æ˜¯ç›¸åŒçš„ï¼Œåˆ™æ¯ä¸ªå¾®æœåŠ¡ä¸­å…³äºæ•°æ®åº“çš„é…ç½®å‡ ä¹éƒ½æ˜¯ç›¸åŒçš„ï¼Œæœ‰æ—¶å€™ä¸»æœºè¿ç§»äº†ï¼Œæˆ‘å¸Œæœ›ä¸€æ¬¡ä¿®æ”¹ï¼Œå¤„å¤„ç”Ÿæ•ˆã€‚</p></blockquote><p>ä½¿ç”¨ï¼š<br>å¯åŠ¨ä¹‹åï¼Œæ‰“å¼€<a href="http://localhost:8500/">http://localhost:8500/</a><br>æœåŠ¡æ³¨å†Œä¸å‘ç°-å¯ä»¥åœ¨Consulå‰å°é¡µé¢æŸ¥çœ‹åˆ°æ‰€æœ‰é…ç½®äº†Consulä¾èµ–çš„æœåŠ¡ï¼š</p><img src="/2024/08/25/Spring%20Cloud/consul1.png" class="" title="consul1"><p>Consulå‰å°é¡µé¢-åˆ†å¸ƒå¼é…ç½®ç®¡ç†ï¼Œé€šè¿‡è‡ªå»ºå¯¹åº”æ–‡ä»¶å¤¹å’Œæ–‡ä»¶å†…å®¹å®Œæˆé…ç½®ï¼Œè¿™æ ·ä¸ç”¨é‡å¯å¾®æœåŠ¡ï¼Œä¹Ÿèƒ½å¤ŸåŠ¨æ€å®æ—¶è·å–åˆ°dataæ–‡ä»¶ä¸­çš„ç›¸å…³å‚æ•°ã€‚</p><img src="/2024/08/25/Spring%20Cloud/consul2.png" class="" title="consul2"><h1 id="Nacos-ğŸš€"><a href="#Nacos-ğŸš€" class="headerlink" title="Nacos ğŸš€"></a><strong>Nacos ğŸš€</strong></h1><p><strong>ä¸€ä¸ªæ›´æ˜“äºæ„å»ºäº‘åŸç”Ÿåº”ç”¨çš„åŠ¨æ€æœåŠ¡å‘ç°ã€é…ç½®ç®¡ç†å’ŒæœåŠ¡ç®¡ç†å¹³å°</strong></p><h2 id="ä½¿ç”¨ï¼š"><a href="#ä½¿ç”¨ï¼š" class="headerlink" title="ä½¿ç”¨ï¼š"></a><strong>ä½¿ç”¨ï¼š</strong></h2><p>å¯åŠ¨ä¹‹åç™»å½•ï¼ˆé»˜è®¤ï¼‰<a href="http://localhost:8848/">http://localhost:8848/</a><br>æœåŠ¡æ³¨å†Œä¸å‘ç°-å…¥é©»Nacosçš„å¾®æœåŠ¡å¯ä»¥åœ¨æœåŠ¡ç®¡ç†é¡µé¢çœ‹åˆ°ï¼›åœ¨é…ç½®ç®¡ç†é¡µé¢å¯ä»¥å®Œæˆå„å¾®æœåŠ¡çš„é…ç½®ï¼š</p><img src="/2024/08/25/Spring%20Cloud/nacos1.png" class="" title="nacos1"><p>é…ç½®é¡µé¢-åˆ†å¸ƒå¼é…ç½®ç®¡ç†ï¼š</p><img src="/2024/08/25/Spring%20Cloud/nacos2.png" class="" title="nacos2"><h1 id="è´Ÿè½½å‡è¡¡LoadBalancer-ğŸš€"><a href="#è´Ÿè½½å‡è¡¡LoadBalancer-ğŸš€" class="headerlink" title="è´Ÿè½½å‡è¡¡LoadBalancer ğŸš€"></a><strong>è´Ÿè½½å‡è¡¡LoadBalancer ğŸš€</strong></h1><blockquote><p>è´Ÿè½½å‡è¡¡ç®€å•çš„è¯´å°±æ˜¯å°†ç”¨æˆ·çš„è¯·æ±‚å¹³æ‘Šçš„åˆ†é…åˆ°å¤šä¸ªæœåŠ¡ä¸Šï¼Œä»è€Œè¾¾åˆ°ç³»ç»Ÿçš„HAï¼ˆé«˜å¯ç”¨ï¼‰ï¼Œå¸¸è§çš„è´Ÿè½½å‡è¡¡æœ‰è½¯ä»¶Nginxï¼ŒLVSï¼Œç¡¬ä»¶ F5ç­‰ã€‚</p><p>Spring Cloud LoadBalanceræ˜¯ç”±SpringCloudå®˜æ–¹æä¾›çš„ä¸€ä¸ªå¼€æºçš„ã€ç®€å•æ˜“ç”¨çš„å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡å™¨ï¼Œå®ƒåŒ…å«åœ¨SpringCloud-commonsä¸­ç”¨å®ƒæ¥æ›¿æ¢äº†ä»¥å‰çš„Ribbonç»„ä»¶ã€‚</p></blockquote><h1 id="æœåŠ¡è°ƒç”¨ä¸è´Ÿè½½å‡è¡¡OpenFeign-ğŸš€"><a href="#æœåŠ¡è°ƒç”¨ä¸è´Ÿè½½å‡è¡¡OpenFeign-ğŸš€" class="headerlink" title="æœåŠ¡è°ƒç”¨ä¸è´Ÿè½½å‡è¡¡OpenFeign ğŸš€"></a><strong>æœåŠ¡è°ƒç”¨ä¸è´Ÿè½½å‡è¡¡OpenFeign ğŸš€</strong></h1><blockquote><p>OpenFeignæ˜¯ä¸€ä¸ªå£°æ˜å¼çš„WebæœåŠ¡å®¢æˆ·ç«¯ï¼Œæ˜¯å½“å‰å¾®æœåŠ¡ä¹‹é—´è°ƒç”¨çš„äº‹å®æ ‡å‡†ã€‚</p><p>åœ¨OpenFeignçš„å®ç°ä¸‹ï¼Œæˆ‘ä»¬åªéœ€åˆ›å»ºä¸€ä¸ªæ¥å£å¹¶ä½¿ç”¨æ³¨è§£çš„æ–¹å¼æ¥é…ç½®å®ƒ(åœ¨ä¸€ä¸ªå¾®æœåŠ¡æ¥å£ä¸Šé¢æ ‡æ³¨ä¸€ä¸ª@FeignClientæ³¨è§£å³å¯)ï¼Œå³å¯å®Œæˆå¯¹æœåŠ¡æä¾›æ–¹çš„æ¥å£ç»‘å®šï¼Œç»Ÿä¸€å¯¹å¤–æš´éœ²å¯ä»¥è¢«è°ƒç”¨çš„æ¥å£æ–¹æ³•ï¼Œå¤§å¤§ç®€åŒ–å’Œé™ä½äº†è°ƒç”¨å®¢æˆ·ç«¯çš„å¼€å‘é‡ï¼Œä¹Ÿå³ç”±æœåŠ¡æä¾›è€…ç»™å‡ºè°ƒç”¨æ¥å£æ¸…å•ï¼Œæ¶ˆè´¹è€…ç›´æ¥é€šè¿‡OpenFeignè°ƒç”¨å³å¯ã€‚</p><p>OpenFeignè¿˜é›†æˆSpringCloud LoadBalancerï¼Œå¯ä»¥å®ç°è´Ÿè½½å‡è¡¡ã€‚</p></blockquote><h2 id="æ¶‰åŠçš„æ³¨è§£"><a href="#æ¶‰åŠçš„æ³¨è§£" class="headerlink" title="æ¶‰åŠçš„æ³¨è§£"></a><strong>æ¶‰åŠçš„æ³¨è§£</strong></h2><p>@EnableFeignClients æ ‡æ³¨åœ¨ä¸»å¯åŠ¨ç±»ä¸Šï¼Œè¡¨ç¤ºå¼€å¯FeignåŠŸèƒ½å¹¶æ¿€æ´»ã€‚æ ‡æ³¨åœ¨æœåŠ¡å‘èµ·çš„ä¸€æ–¹-æ¶ˆè´¹è€…ã€‚<br>@FeignClient é…ç½®åœ¨commonå¾®æœåŠ¡çš„æœåŠ¡æ¥å£ä¸Šã€‚</p><h2 id="Feignå’ŒopenFeignçš„åŒºåˆ«"><a href="#Feignå’ŒopenFeignçš„åŒºåˆ«" class="headerlink" title="Feignå’ŒopenFeignçš„åŒºåˆ«"></a><strong>Feignå’ŒopenFeignçš„åŒºåˆ«</strong></h2><blockquote><p>Feignæ˜¯SpringCloudç»„ä»¶ä¸­ä¸€ä¸ªè½»é‡çº§RESTfulçš„HTTPæœåŠ¡å®¢æˆ·ç«¯ï¼ŒFeignå†…ç½®äº†Ribbonï¼Œç”¨æ¥åšå®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡ï¼Œå»è°ƒç”¨æœåŠ¡æ³¨å†Œä¸­å¿ƒçš„æœåŠ¡ã€‚Feignçš„ä½¿ç”¨æ–¹å¼æ˜¯ï¼šä½¿ç”¨Feignçš„æ³¨è§£å®šä¹‰æ¥å£ï¼Œè°ƒç”¨è¿™ä¸ªæ¥å£ï¼Œå°±å¯ä»¥è°ƒç”¨æœåŠ¡æ³¨å†Œä¸­å¿ƒçš„æœåŠ¡</p><p>OpenFeign æ˜¯SpringCloudåœ¨Feignçš„åŸºç¡€ä¸Šæ”¯æŒäº†SpringMVCçš„æ³¨è§£ï¼Œå¦‚@RequestMappingç­‰ã€‚OpenFeign çš„@FeignClientå¯ä»¥è§£æSpringMVCçš„@RequestMappingæ³¨è§£ä¸‹çš„æ¥å£ï¼Œå¹¶é€šè¿‡åŠ¨æ€ä»£ç†çš„æ–¹å¼äº§ç”Ÿå®ç°ç±»ï¼Œå®ç°ç±»ä¸­åšè´Ÿè½½å‡è¡¡å¹¶è°ƒç”¨å…¶ä»–æœåŠ¡ã€‚</p></blockquote><h2 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a><strong>ç¯å¢ƒå‡†å¤‡</strong></h2><p>ä½¿ç”¨Nacosä½œä¸ºæ³¨å†Œå’Œé…ç½®ä¸­å¿ƒï¼Œæ­å»ºçš„é¡¹ç›®ç»“æ„å¦‚ä¸‹å›¾ï¼š</p><img src="/2024/08/25/Spring%20Cloud/feign1.png" class="" title="feign1"><p>æ³¨å†Œä¸­å¿ƒä½¿ç”¨Nacosï¼Œåˆ›å»ºä¸ªå¾®æœåŠ¡ï¼Œåˆ†åˆ«ä¸ºæœåŠ¡æä¾›è€…Produceï¼ŒæœåŠ¡æ¶ˆè´¹è€…Consumerã€‚</p><h3 id="åˆ›å»ºæœåŠ¡æä¾›è€…"><a href="#åˆ›å»ºæœåŠ¡æä¾›è€…" class="headerlink" title="åˆ›å»ºæœåŠ¡æä¾›è€…"></a><strong>åˆ›å»ºæœåŠ¡æä¾›è€…</strong></h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9005</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="comment">## æŒ‡å®šæœåŠ¡åç§°ï¼Œåœ¨nacosä¸­çš„åå­—ï¼Œå°†ä¼šåœ¨openFeignæ¥å£è°ƒç”¨ä¸­ä½¿ç”¨ã€‚</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">openFeign-provider</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="comment"># nacosçš„æœåŠ¡åœ°å€ï¼Œnacos-serverä¸­IPåœ°å€:ç«¯å£å·</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">:8848</span></span><br><span class="line"><span class="attr">management:</span></span><br><span class="line">  <span class="attr">endpoints:</span></span><br><span class="line">    <span class="attr">web:</span></span><br><span class="line">      <span class="attr">exposure:</span></span><br><span class="line">        <span class="comment">## ymlæ–‡ä»¶ä¸­å­˜åœ¨ç‰¹æ®Šå­—ç¬¦ï¼Œå¿…é¡»ç”¨å•å¼•å·åŒ…å«ï¼Œå¦åˆ™å¯åŠ¨æŠ¥é”™</span></span><br><span class="line">        <span class="attr">include:</span> <span class="string">&#x27;*&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºæœåŠ¡æ¶ˆè´¹è€…"><a href="#åˆ›å»ºæœåŠ¡æ¶ˆè´¹è€…" class="headerlink" title="åˆ›å»ºæœåŠ¡æ¶ˆè´¹è€…"></a><strong>åˆ›å»ºæœåŠ¡æ¶ˆè´¹è€…</strong></h3><p>æ–°å»ºä¸€ä¸ªæ¨¡å—openFeign-consumer9006ä½œä¸ºæ¶ˆè´¹è€…æœåŠ¡ï¼Œæ­¥éª¤å¦‚ä¸‹ã€‚<br><strong>1ã€æ·»åŠ ä¾èµ–</strong><br>é™¤äº†Nacosçš„æ³¨å†Œä¸­å¿ƒçš„ä¾èµ–ï¼Œè¿˜è¦æ·»åŠ openFeignçš„ä¾èµ–ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-openfeign<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>2ã€æ·»åŠ æ³¨è§£@EnableFeignClientså¼€å¯openFeignåŠŸèƒ½</strong><br>åœ¨Spring boot ä¸»å¯åŠ¨ç±»ä¸Šæ·»åŠ ä¸€ä¸ªæ³¨è§£@EnableFeignClientsï¼Œå¼€å¯openFeignåŠŸèƒ½ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br><span class="line"><span class="meta">@EnableFeignClients</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OpenFeignConsumer9006Application</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(OpenFeignConsumer9006Application.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>3ã€æ–°å»ºopenFeignæ¥å£</strong><br>æ–°å»ºä¸€ä¸ªopenFeignæ¥å£ï¼Œä½¿ç”¨@FeignClientæ³¨è§£æ ‡æ³¨ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¯¥æ³¨è§£@FeignClientä¸­çš„valueå±æ€§æŒ‡å®šäº†æœåŠ¡æä¾›è€…åœ¨nacosæ³¨å†Œä¸­å¿ƒçš„æœåŠ¡åã€‚</span></span><br><span class="line"><span class="meta">@FeignClient(value = &quot;openFeign-provider&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">OpenFeignService</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="/2024/08/25/Spring%20Cloud/feign2.png" class="" title="feign2"><h1 id="æœåŠ¡ç†”æ–­å’Œé™çº§Resilience4j-ğŸš€"><a href="#æœåŠ¡ç†”æ–­å’Œé™çº§Resilience4j-ğŸš€" class="headerlink" title="æœåŠ¡ç†”æ–­å’Œé™çº§Resilience4j ğŸš€"></a><strong>æœåŠ¡ç†”æ–­å’Œé™çº§Resilience4j ğŸš€</strong></h1><p>ä»‹ç»Resilience4jå‰ï¼Œéœ€è¦å…ˆä»‹ç»CircuitBreakeræ–­è·¯å™¨ã€‚</p><p><strong>CircuitBreakerçš„ç›®çš„æ˜¯ä¿æŠ¤åˆ†å¸ƒå¼ç³»ç»Ÿå…å—æ•…éšœå’Œå¼‚å¸¸ï¼Œæé«˜ç³»ç»Ÿçš„å¯ç”¨æ€§å’Œå¥å£®æ€§ã€‚</strong></p><blockquote><p>å½“ä¸€ä¸ªç»„ä»¶æˆ–æœåŠ¡å‡ºç°æ•…éšœæ—¶ï¼ŒCircuitBreakerä¼šè¿…é€Ÿåˆ‡æ¢åˆ°å¼€æ”¾OPENçŠ¶æ€(ä¿é™©ä¸è·³é—¸æ–­ç”µ)ï¼Œé˜»æ­¢è¯·æ±‚å‘é€åˆ°è¯¥ç»„ä»¶æˆ–æœåŠ¡ä»è€Œé¿å…æ›´å¤šçš„è¯·æ±‚å‘é€åˆ°è¯¥ç»„ä»¶æˆ–æœåŠ¡ã€‚</p><p>è¿™å¯ä»¥å‡å°‘å¯¹è¯¥ç»„ä»¶æˆ–æœåŠ¡çš„è´Ÿè½½ï¼Œé˜²æ­¢è¯¥ç»„ä»¶æˆ–æœåŠ¡è¿›ä¸€æ­¥å´©æºƒï¼Œå¹¶ä½¿æ•´ä¸ªç³»ç»Ÿèƒ½å¤Ÿç»§ç»­æ­£å¸¸è¿è¡Œã€‚</p><p>åŒæ—¶ï¼ŒCircuitBreakerè¿˜å¯ä»¥æé«˜ç³»ç»Ÿçš„å¯ç”¨æ€§å’Œå¥å£®æ€§ï¼Œå› ä¸ºå®ƒå¯ä»¥åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿçš„å„ä¸ªç»„ä»¶ä¹‹é—´è‡ªåŠ¨åˆ‡æ¢ï¼Œä»è€Œé¿å…å•ç‚¹æ•…éšœçš„é—®é¢˜ã€‚</p></blockquote><p><strong>è€ŒResilience4jæ˜¯æ–­è·¯å™¨æ€æƒ³çš„è½åœ°å®ç°è€…ã€‚Resilience4jæ˜¯ä¸€ä¸ªè½»é‡çº§å®¹é”™æ¡†æ¶ï¼Œæä¾›äº†æ–­è·¯å™¨ï¼Œé™æµå™¨ï¼Œé‡è¯•ï¼Œéš”ç¦»ç­‰åŠŸèƒ½ã€‚</strong></p><h2 id="ç†”æ–­ï¼šæ–­è·¯"><a href="#ç†”æ–­ï¼šæ–­è·¯" class="headerlink" title="ç†”æ–­ï¼šæ–­è·¯"></a><strong>ç†”æ–­ï¼šæ–­è·¯</strong></h2><img src="/2024/08/25/Spring%20Cloud/%E6%96%AD%E8%B7%AF%E5%99%A81.png" class="" title="æ–­è·¯å™¨1"><p>ä½¿ç”¨æ–¹æ³•ï¼š<br>@CircuitBreaker åŠ åœ¨å¯¹åº”æ–¹æ³•ä¸Š</p><h2 id="éš”ç¦»ï¼šèˆ±å£"><a href="#éš”ç¦»ï¼šèˆ±å£" class="headerlink" title="éš”ç¦»ï¼šèˆ±å£"></a><strong>éš”ç¦»ï¼šèˆ±å£</strong></h2><p>å«ä¹‰ï¼šç”¨äºé™å¹¶å‘ï¼Œå®ç°ä¾èµ–éš”ç¦»å’Œè´Ÿè½½ä¿æŠ¤ï¼Œé™åˆ¶å¯¹äºä¸‹æ¸¸æœåŠ¡çš„æœ€å¤§å¹¶å‘æ•°é‡ã€‚<br>Resilience4jæä¾›äº†ä¸¤ç§éš”ç¦»çš„å®ç°æ–¹å¼ï¼Œå¯ä»¥é™åˆ¶å¹¶å‘æ‰§è¡Œçš„æ•°é‡ã€‚<br>SemaphoreBulkheadä½¿ç”¨äº†ä¿¡å·é‡<br>FixedThreadPoolBulkheadä½¿ç”¨äº†æœ‰ç•Œé˜Ÿåˆ—å’Œå›ºå®šå¤§å°çº¿ç¨‹æ± <br>ä½¿ç”¨æ–¹æ³•ï¼š<br>@Bulkhead åŠ åœ¨å¯¹åº”æ–¹æ³•ä¸Š</p><h2 id="é™æµï¼šé€Ÿç‡é™åˆ¶"><a href="#é™æµï¼šé€Ÿç‡é™åˆ¶" class="headerlink" title="é™æµï¼šé€Ÿç‡é™åˆ¶"></a><strong>é™æµï¼šé€Ÿç‡é™åˆ¶</strong></h2><p>é™æµï¼Œå°±æ˜¯é€šè¿‡å¯¹å¹¶å‘è®¿é—®&#x2F;è¯·æ±‚è¿›è¡Œé™é€Ÿï¼Œæˆ–è€…å¯¹ä¸€ä¸ªæ—¶é—´çª—å£å†…çš„è¯·æ±‚è¿›è¡Œé™é€Ÿï¼Œä»¥ä¿æŠ¤åº”ç”¨ç³»ç»Ÿï¼Œä¸€æ—¦è¾¾åˆ°é™åˆ¶é€Ÿç‡åˆ™å¯ä»¥æ‹’ç»æœåŠ¡ã€æ’é˜Ÿæˆ–ç­‰å¾…ã€é™çº§ç­‰å¤„ç†ã€‚<br>Resilience4jä½¿ç”¨ä»¤ç‰Œæ¡¶ç®—æ³•æ¥å®ç°é™æµã€‚<br>ä½¿ç”¨æ–¹æ³•ï¼š<br>@RateLimiter åŠ åœ¨å¯¹åº”æ–¹æ³•ä¸Š</p><h1 id="æœåŠ¡ç†”æ–­å’Œé™çº§Sentinel-ğŸš€"><a href="#æœåŠ¡ç†”æ–­å’Œé™çº§Sentinel-ğŸš€" class="headerlink" title="æœåŠ¡ç†”æ–­å’Œé™çº§Sentinel ğŸš€"></a><strong>æœåŠ¡ç†”æ–­å’Œé™çº§Sentinel ğŸš€</strong></h1><p>å±äº SpringCloud Alibaba<br>éšç€å¾®æœåŠ¡çš„æµè¡Œï¼ŒæœåŠ¡å’ŒæœåŠ¡ä¹‹é—´çš„ç¨³å®šæ€§å˜å¾—è¶Šæ¥è¶Šé‡è¦ã€‚<br>Sentinel æ˜¯é¢å‘åˆ†å¸ƒå¼ã€å¤šè¯­è¨€å¼‚æ„åŒ–æœåŠ¡æ¶æ„çš„æµé‡æ²»ç†ç»„ä»¶ï¼Œä¸»è¦<strong>ä»¥æµé‡ä¸ºåˆ‡å…¥ç‚¹</strong>ï¼Œä»æµé‡è·¯ç”±ã€æµé‡æ§åˆ¶ã€æµé‡æ•´å½¢ã€ç†”æ–­é™çº§ã€ç³»ç»Ÿè‡ªé€‚åº”è¿‡è½½ä¿æŠ¤ã€çƒ­ç‚¹æµé‡é˜²æŠ¤ç­‰å¤šä¸ªç»´åº¦æ¥å¸®åŠ©å¼€å‘è€…ä¿éšœ<strong>å¾®æœåŠ¡çš„ç¨³å®šæ€§</strong>ã€‚</p><h2 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a><strong>åŸºæœ¬æ¦‚å¿µ</strong></h2><p>1.èµ„æº<br>â€ƒâ€ƒèµ„æºæ˜¯ Sentinel çš„å…³é”®æ¦‚å¿µã€‚å®ƒå¯ä»¥æ˜¯ Java åº”ç”¨ç¨‹åºä¸­çš„ä»»ä½•å†…å®¹ï¼Œä¾‹å¦‚ï¼Œç”±åº”ç”¨ç¨‹åºæä¾›çš„æœåŠ¡ï¼Œæˆ–ç”±åº”ç”¨ç¨‹åºè°ƒç”¨çš„å…¶å®ƒåº”ç”¨æä¾›çš„æœåŠ¡ï¼Œç”šè‡³å¯ä»¥æ˜¯ä¸€æ®µä»£ç ã€‚<br>â€ƒâ€ƒåªè¦é€šè¿‡ Sentinel API å®šä¹‰çš„ä»£ç ï¼Œå°±æ˜¯èµ„æºï¼Œèƒ½å¤Ÿè¢« Sentinel ä¿æŠ¤èµ·æ¥ã€‚å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨æ–¹æ³•ç­¾åï¼ŒURLï¼Œç”šè‡³æœåŠ¡åç§°ä½œä¸ºèµ„æºåæ¥æ ‡ç¤ºèµ„æºã€‚<br>2.è§„åˆ™<br>â€ƒâ€ƒå›´ç»•èµ„æºçš„å®æ—¶çŠ¶æ€è®¾å®šçš„è§„åˆ™ï¼Œå¯ä»¥åŒ…æ‹¬æµé‡æ§åˆ¶è§„åˆ™ã€ç†”æ–­é™çº§è§„åˆ™ä»¥åŠç³»ç»Ÿä¿æŠ¤è§„åˆ™ã€‚æ‰€æœ‰è§„åˆ™å¯ä»¥åŠ¨æ€å®æ—¶è°ƒæ•´ã€‚<br>åŸç†ï¼š</p><img src="/2024/08/25/Spring%20Cloud/sentinel1.png" class="" title="sentinel1"><h2 id="æµé‡æ§åˆ¶"><a href="#æµé‡æ§åˆ¶" class="headerlink" title="æµé‡æ§åˆ¶"></a><strong>æµé‡æ§åˆ¶</strong></h2><img src="/2024/08/25/Spring%20Cloud/sentinel2.png" class="" title="sentinel2"><h2 id="ç†”æ–­"><a href="#ç†”æ–­" class="headerlink" title="ç†”æ–­"></a><strong>ç†”æ–­</strong></h2><img src="/2024/08/25/Spring%20Cloud/sentinel3.png" class="" title="sentinel3"><img src="/2024/08/25/Spring%20Cloud/sentinel4.png" class="" title="sentinel4"><h2 id="çƒ­ç‚¹"><a href="#çƒ­ç‚¹" class="headerlink" title="çƒ­ç‚¹"></a><strong>çƒ­ç‚¹</strong></h2><p>çƒ­ç‚¹å³ç»å¸¸è®¿é—®çš„æ•°æ®ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬å¸Œæœ›ç»Ÿè®¡æˆ–è€…é™åˆ¶æŸä¸ªçƒ­ç‚¹æ•°æ®ä¸­è®¿é—®é¢‘æ¬¡æœ€é«˜çš„TopNæ•°æ®ï¼Œå¹¶å¯¹å…¶è®¿é—®è¿›è¡Œé™æµæˆ–è€…å…¶å®ƒæ“ä½œ</p><h2 id="æˆæƒ"><a href="#æˆæƒ" class="headerlink" title="æˆæƒ"></a><strong>æˆæƒ</strong></h2><p>åœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œéœ€è¦æ ¹æ®è°ƒç”¨æ¥å£çš„æ¥æºåˆ¤æ–­æ˜¯å¦å…è®¸æ‰§è¡Œæœ¬æ¬¡è¯·æ±‚ã€‚æ­¤æ—¶å°±å¯ä»¥ä½¿ç”¨Sentinelæä¾›çš„æˆæƒè§„åˆ™æ¥å®ç°ï¼ŒSentinelçš„æˆæƒè§„åˆ™èƒ½å¤Ÿæ ¹æ®è¯·æ±‚çš„æ¥æºåˆ¤æ–­æ˜¯å¦å…è®¸æœ¬æ¬¡è¯·æ±‚é€šè¿‡ã€‚<br>åœ¨Sentinelçš„æˆæƒè§„åˆ™ä¸­ï¼Œæä¾›äº† sç™½åå•ä¸é»‘åå• ä¸¤ç§æˆæƒç±»å‹ã€‚ç™½æ”¾è¡Œã€é»‘ç¦æ­¢</p><h2 id="ä½¿ç”¨ç¤ºä¾‹"><a href="#ä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="ä½¿ç”¨ç¤ºä¾‹"></a><strong>ä½¿ç”¨ç¤ºä¾‹</strong></h2><p>Sentinelè½¯ä»¶åå°è¿è¡Œï¼š</p><img src="/2024/08/25/Spring%20Cloud/sentinel5.png" class="" title="sentinel5"><p>Sentinelè½¯ä»¶å‰å°é¡µé¢å±•ç¤º</p><img src="/2024/08/25/Spring%20Cloud/sentinel6.png" class="" title="sentinel6"><p>å„ç±»è§„åˆ™é…ç½®ç•Œé¢ï¼Œé…ç½®åçœ‹è¿›è¡Œç›¸åº”æµ‹è¯•</p><img src="/2024/08/25/Spring%20Cloud/sentinel6.png" class="" title="sentinel7"><h1 id="æœåŠ¡é“¾è·¯è¿½è¸ªMicrometer-Zipkin-ğŸš€"><a href="#æœåŠ¡é“¾è·¯è¿½è¸ªMicrometer-Zipkin-ğŸš€" class="headerlink" title="æœåŠ¡é“¾è·¯è¿½è¸ªMicrometer+Zipkin ğŸš€"></a><strong>æœåŠ¡é“¾è·¯è¿½è¸ªMicrometer+Zipkin ğŸš€</strong></h1><p>Micrometeræ˜¯ä¸€å¥—<strong>å®Œæ•´çš„åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ªè§£å†³æ–¹æ¡ˆ</strong>ã€‚èƒ½å°†ä¸€æ¬¡åˆ†å¸ƒå¼è¯·æ±‚è¿˜åŸæˆè°ƒç”¨é“¾è·¯ï¼Œè¿›è¡Œæ—¥è®°è®°å½•å’Œæ€§èƒ½ç›‘æ§ã€‚</p><p>Zipkinæ˜¯ä¸€ç§<strong>åˆ†å¸ƒå¼é“¾è·¯è·Ÿè¸ªç³»ç»Ÿå›¾å½¢åŒ–çš„å·¥å…·</strong>ï¼ŒZipkin æ˜¯ Twitter å¼€æºçš„åˆ†å¸ƒå¼è·Ÿè¸ªç³»ç»Ÿï¼Œèƒ½å¤Ÿæ”¶é›†å¾®æœåŠ¡è¿è¡Œè¿‡ç¨‹ä¸­çš„å®æ—¶è°ƒç”¨é“¾è·¯ä¿¡æ¯ï¼Œå¹¶èƒ½å¤Ÿå°†è¿™äº›è°ƒç”¨é“¾è·¯ä¿¡æ¯å±•ç¤ºåˆ°Webå›¾å½¢åŒ–ç•Œé¢ä¸Šä¾›å¼€å‘äººå‘˜åˆ†æï¼Œå¼€å‘äººå‘˜èƒ½å¤Ÿä»ZipKinä¸­åˆ†æå‡ºè°ƒç”¨é“¾è·¯ä¸­çš„æ€§èƒ½ç“¶é¢ˆï¼Œè¯†åˆ«å‡ºå­˜åœ¨é—®é¢˜çš„åº”ç”¨ç¨‹åºï¼Œè¿›è€Œå®šä½é—®é¢˜å’Œè§£å†³é—®é¢˜ã€‚</p><h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a><strong>åŸç†</strong></h2><p>ä¸€æ¡é“¾è·¯è¿½è¸ªä¼šåœ¨æ¯ä¸ªæœåŠ¡è°ƒç”¨çš„æ—¶å€™åŠ ä¸ŠTrace ID å’Œ Span IDã€‚<br>é“¾è·¯é€šè¿‡TraceIdå”¯ä¸€æ ‡è¯†ï¼ŒSpanæ ‡è¯†å‘èµ·çš„è¯·æ±‚ä¿¡æ¯ï¼Œå„spané€šè¿‡parent id å…³è”èµ·æ¥ (Span:è¡¨ç¤ºè°ƒç”¨é“¾è·¯æ¥æºï¼Œé€šä¿—çš„ç†è§£spanå°±æ˜¯ä¸€æ¬¡è¯·æ±‚ä¿¡æ¯)</p><img src="/2024/08/25/Spring%20Cloud/mz1.png" class="" title="mz1"><h2 id="ä½¿ç”¨ç¤ºä¾‹-1"><a href="#ä½¿ç”¨ç¤ºä¾‹-1" class="headerlink" title="ä½¿ç”¨ç¤ºä¾‹"></a><strong>ä½¿ç”¨ç¤ºä¾‹</strong></h2><p>é€šè¿‡80è®¢å•æœåŠ¡è°ƒç”¨8001æœåŠ¡æä¾›è€…ï¼Œé€šè¿‡Micrometeræ”¶é›†é“¾è·¯ä¿¡æ¯ï¼Œé€šè¿‡Zipkinå±•ç¤ºã€‚</p><img src="/2024/08/25/Spring%20Cloud/mz2.png" class="" title="mz2"><ol><li>å¯åŠ¨Zipkinåå°</li><li>ç™»å½•<a href="http://localhost:9411/">http://localhost:9411/</a>    è®¿é—®Zipkinå‰å°ï¼Œå¯ä»¥çœ‹åˆ°æ¯ä¸ªæ–¹æ³•çš„è°ƒç”¨æ—¶é•¿<img src="/2024/08/25/Spring%20Cloud/mz3.png" class="" title="mz3">Zipkinä¸­å¯ä»¥çœ‹åˆ°è¯·æ±‚é“¾è·¯<img src="/2024/08/25/Spring%20Cloud/mz4.png" class="" title="mz4"></li></ol><h1 id="æœåŠ¡ç½‘å…³Gateway-ğŸš€"><a href="#æœåŠ¡ç½‘å…³Gateway-ğŸš€" class="headerlink" title="æœåŠ¡ç½‘å…³Gateway ğŸš€"></a><strong>æœåŠ¡ç½‘å…³Gateway ğŸš€</strong></h1><p>Cloudå…¨å®¶æ¡¶ä¸­æœ‰ä¸ªå¾ˆé‡è¦çš„ç»„ä»¶å°±æ˜¯ç½‘å…³ï¼Œåœ¨1.xç‰ˆæœ¬ä¸­éƒ½æ˜¯é‡‡ç”¨çš„Zuulç½‘å…³ï¼›<br>ä½†åœ¨2.xç‰ˆæœ¬ä¸­ï¼Œzuulçš„å‡çº§ä¸€ç›´è·³ç¥¨ï¼ŒSpringCloudæœ€åè‡ªå·±ç ”å‘äº†ä¸€ä¸ªç½‘å…³SpringCloud Gatewayæ›¿ä»£Zuulï¼Œé‚£å°±æ˜¯SpringCloud Gatewayï¼Œä¸€å¥è¯ï¼šgatewayæ˜¯åŸzuul1.xç‰ˆçš„æ›¿ä»£ã€‚</p><p>Spring Cloud Gatewayç»„ä»¶çš„æ ¸å¿ƒæ˜¯ä¸€ç³»åˆ—çš„è¿‡æ»¤å™¨ï¼Œé€šè¿‡è¿™äº›è¿‡æ»¤å™¨å¯ä»¥å°†å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚è½¬å‘(è·¯ç”±)åˆ°å¯¹åº”çš„å¾®æœåŠ¡ã€‚ Spring Cloud Gatewayæ˜¯åŠ åœ¨æ•´ä¸ªå¾®æœåŠ¡æœ€å‰æ²¿çš„é˜²ç«å¢™å’Œä»£ç†å™¨ï¼Œéšè—å¾®æœåŠ¡ç»“ç‚¹IPç«¯å£ä¿¡æ¯ï¼Œä»è€ŒåŠ å¼ºå®‰å…¨ä¿æŠ¤ã€‚Spring Cloud Gatewayæœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªå¾®æœåŠ¡ï¼Œéœ€è¦æ³¨å†Œè¿›æœåŠ¡æ³¨å†Œä¸­å¿ƒã€‚</p><p>å®¢æˆ·ç«¯å‘ Spring Cloud Gateway å‘å‡ºè¯·æ±‚ã€‚ç„¶ååœ¨ Gateway Handler Mapping ä¸­æ‰¾åˆ°ä¸è¯·æ±‚ç›¸åŒ¹é…çš„è·¯ç”±ï¼Œå°†å…¶å‘é€åˆ° Gateway Web Handlerã€‚Handler å†é€šè¿‡æŒ‡å®šçš„è¿‡æ»¤å™¨é“¾æ¥å°†è¯·æ±‚å‘é€åˆ°æˆ‘ä»¬å®é™…çš„æœåŠ¡æ‰§è¡Œä¸šåŠ¡é€»è¾‘ï¼Œç„¶åè¿”å›ã€‚</p><img src="/2024/08/25/Spring%20Cloud/gateway1.png" class="" title="gateway1"><p><strong>ä½œç”¨</strong></p><ol><li><p>è·¯ç”±ï¼š<br>éšè—ç«¯å£ã€éšç§˜URIç­‰ï¼Œä¿æŠ¤åç«¯çœŸå®ç«¯å£å’Œåœ°å€ï¼›è·¯ç”±è½¬å‘ï¼›</p></li><li><p>æ–­è¨€ï¼š<br>åŒ¹é…HTTPä¸­æ‰€æœ‰çš„è¯·æ±‚å†…å®¹ï¼Œè¯·æ±‚ä¸æ–­è¨€ç›¸åŒ¹é…åˆ™è¿›è¡Œè·¯ç”±ã€‚<br>è‡ªå¸¦After&#x2F;Before&#x2F;Header&#x2F;Method Route Predicateç­‰ç»„ä»¶ã€‚å¯ä»¥å®ç°æŸä¸ªæ—¶é—´ç‚¹ä¹‹å‰æœ‰æ•ˆã€æŸä¸ªæ—¶é—´ç‚¹åæœ‰æ•ˆã€è¯·æ±‚å¤´ä¸­å‚æ•°æ˜¯å¦ç¬¦åˆé¢„æœŸã€è¯·æ±‚æ–¹æ³•æ˜¯å¦åŒ¹é…ã€‚</p></li><li><p>è¿‡æ»¤ï¼š<br>å¯ä»¥å†è¯·æ±‚è¢«è·¯ç”±å‰æˆ–è€…ä¹‹åå¯¹è¯·æ±‚è¿›è¡Œä¿®æ”¹ã€‚<br>è‡ªå¸¦Add&#x2F;RemoveRequestHeaderã€Add&#x2F;RemoveRequestParameterç­‰ç»„ä»¶ã€‚å¯ä»¥å®ç°åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ æˆ–åˆ é™¤å‚æ•°ã€åœ¨è¯·æ±‚è¿‡ç¨‹ä¸­å¢åŠ æˆ–è€…åˆ é™¤è¯·æ±‚å‚æ•°ç­‰ã€‚</p></li></ol><h1 id="åˆ†å¸ƒå¼äº‹åŠ¡Seata-ğŸš€"><a href="#åˆ†å¸ƒå¼äº‹åŠ¡Seata-ğŸš€" class="headerlink" title="åˆ†å¸ƒå¼äº‹åŠ¡Seata ğŸš€"></a><strong>åˆ†å¸ƒå¼äº‹åŠ¡Seata ğŸš€</strong></h1><p>Apache Seata(incubating) æ˜¯ä¸€æ¬¾å¼€æºçš„åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆï¼Œå±äº SpringCloud Alibabaï¼Œè‡´åŠ›äºåœ¨å¾®æœåŠ¡æ¶æ„ä¸‹æä¾›é«˜æ€§èƒ½å’Œç®€å•æ˜“ç”¨çš„åˆ†å¸ƒå¼äº‹åŠ¡æœåŠ¡ã€‚</p><p><strong>åŸç†</strong><br>â€ƒâ€ƒSeataå¯¹åˆ†å¸ƒå¼äº‹åŠ¡çš„åè°ƒå’Œæ§åˆ¶æ˜¯é€šè¿‡XIDåŠ ä¸ŠTC-TM-RMæ¥å®Œæˆçš„ã€‚XIDæ˜¯å…¨å±€äº‹åŠ¡çš„å”¯ä¸€æ ‡è¯†ã€‚TCå¯ä»¥ç®€å•ç†è§£ä¸ºSeataæœ¬èº«ï¼›TMç†è§£ä¸ºå¾®æœåŠ¡æ¨¡å—çš„å‘èµ·è€…ï¼›RMåˆ™æ˜¯mysqlæ•°æ®åº“æœ¬èº«ã€‚<br>â€ƒâ€ƒä¸‰ä¸ªç»„ä»¶ç›¸äº’åä½œï¼ŒTCä»¥Seata æœåŠ¡å™¨(Server)å½¢å¼ç‹¬ç«‹éƒ¨ç½²ï¼ŒTMå’ŒRMåˆ™æ˜¯ä»¥Seata Clientçš„å½¢å¼é›†æˆåœ¨å¾®æœåŠ¡ä¸­è¿è¡Œã€‚</p><img src="/2024/08/25/Spring%20Cloud/seata1.png" class="" title="seata1"><p><strong>æµç¨‹</strong></p><ol><li>TM å‘ TC ç”³è¯·å¼€å¯ä¸€ä¸ªå…¨å±€äº‹åŠ¡ï¼Œå…¨å±€äº‹åŠ¡åˆ›å»ºæˆåŠŸå¹¶ç”Ÿæˆä¸€ä¸ªå…¨å±€å”¯ä¸€çš„ XIDï¼›</li><li>XID åœ¨å¾®æœåŠ¡è°ƒç”¨é“¾è·¯çš„ä¸Šä¸‹æ–‡ä¸­ä¼ æ’­ï¼›</li><li>RM å‘ TC æ³¨å†Œåˆ†æ”¯äº‹åŠ¡ï¼Œå°†å…¶çº³å…¥ XID å¯¹åº”å…¨å±€äº‹åŠ¡çš„ç®¡è¾–ï¼›</li><li>TM å‘ TC å‘èµ·é’ˆå¯¹ XID çš„å…¨å±€æäº¤æˆ–å›æ»šå†³è®®ï¼›</li><li>TC è°ƒåº¦ XID ä¸‹ç®¡è¾–çš„å…¨éƒ¨åˆ†æ”¯äº‹åŠ¡å®Œæˆæäº¤æˆ–å›æ»šè¯·æ±‚ã€‚</li></ol><p><strong>ä½¿ç”¨ç¤ºä¾‹</strong><br>æ¨¡æ‹Ÿä¸€ä¸ªè´­ç‰©åœºæ™¯ï¼šæ€»å…±æ¶‰åŠè®¢å•ã€åº“å­˜ã€è´¦æˆ·æœåŠ¡ã€‚ç”¨æˆ·ä¸‹å•åï¼Œç”Ÿæˆä¸€ä¸ªè®¢å•ï¼Œå¹¶è¿œç¨‹è°ƒç”¨æ‰£å‡ç›¸åº”çš„åº“å­˜å’Œè´¦æˆ·ä½™é¢ã€‚è¿™é‡Œä¼šæ¶‰åŠä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡åœºæ™¯ï¼Œè¦æ±‚æ•´ä¸ªé“¾è·¯æ”¯æŒæ­£å¸¸ä¸šåŠ¡å’Œå¼‚å¸¸å›æ»šã€‚<br>æ¶‰åŠçš„å¾®æœåŠ¡ï¼š</p><img src="/2024/08/25/Spring%20Cloud/seata2.png" class="" title="seata2"><p>å¯åŠ¨seataåå°</p><img src="/2024/08/25/Spring%20Cloud/seata3.png" class="" title="seata3"><p>æµ‹è¯•æ—¶Seataå‰å°å±•ç¤ºï¼š<br>å¯ä»¥è§‚æµ‹åˆ°xid&#x2F;transactionId&#x2F;resourceIdä¹‹é—´çš„å…³ç³»</p><img src="/2024/08/25/Spring%20Cloud/seata4.png" class="" title="seata4">]]></content>
      
      
      
        <tags>
            
            <tag> Spring Cloud </tag>
            
            <tag> åˆ†å¸ƒå¼ </tag>
            
            <tag> å¾®æœåŠ¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼</title>
      <link href="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
      <url>/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="0-èƒŒæ™¯-ğŸš€"><a href="#0-èƒŒæ™¯-ğŸš€" class="headerlink" title="0. èƒŒæ™¯ ğŸš€"></a><strong>0. èƒŒæ™¯ ğŸš€</strong></h1><p>å½“Javaå¼€å‘å¿«ä¸€å¹´äº†ï¼Œè®¾è®¡æ¨¡å¼è¿™é—¨å¿…ä¿®å±…ç„¶å¿˜å¾—å·®ä¸å¤šäº†ï¼Œæœ‰ç‚¹ç¦»è°±ï¼Œæœ‰ç‚¹æƒ­æ„§ï¼Œæœ‰ç‚¹é—æ†¾ã€‚</p><p>ä»Šä¸‹å†³å¿ƒï¼Œå°†å…¶é‡æ–°æ‹¾èµ·ï¼Œæ•…ä½œæ­¤ç¬”è®°ä»¥è®°å½•å­¦ä¹ è¿‡ç¨‹ï¼Œä¾¿äºæ—¥åå†å†æ‹¾èµ·ï¼ˆæ‰‹åŠ¨ç‹—å¤´</p><h1 id="1-è®¾è®¡æ¨¡å¼å…¨å±€æ¦‚è§ˆ-ğŸš€"><a href="#1-è®¾è®¡æ¨¡å¼å…¨å±€æ¦‚è§ˆ-ğŸš€" class="headerlink" title="1. è®¾è®¡æ¨¡å¼å…¨å±€æ¦‚è§ˆ ğŸš€"></a><strong>1. è®¾è®¡æ¨¡å¼å…¨å±€æ¦‚è§ˆ ğŸš€</strong></h1><h2 id="1-1-çŸ¥è¯†æ¥æº"><a href="#1-1-çŸ¥è¯†æ¥æº" class="headerlink" title="1.1 çŸ¥è¯†æ¥æº"></a><em>1.1 çŸ¥è¯†æ¥æº</em></h2><hr><ol><li>ä½œä¸ºBiliBiliå¤§å­¦é»‘é©¬è€å¸ˆæ•™å‡ºæ¥çš„ç¨‹åºå‘˜ï¼Œè‡ªç„¶è¿˜æ˜¯é¦–é€‰é»‘é©¬ï¼š<a href="https://www.bilibili.com/video/BV1Np4y1z7BU">https://www.bilibili.com/video/BV1Np4y1z7BU</a></li><li>åŒäº‹åˆ†äº«çš„PDFï¼šã€Šæ‚¨çš„è®¾è®¡æ¨¡å¼ã€‹â€”â€” CBF4LIFE</li><li>ç½‘ç»œ</li></ol><h2 id="1-2-ä¸ºä»€ä¹ˆéœ€è¦å­¦"><a href="#1-2-ä¸ºä»€ä¹ˆéœ€è¦å­¦" class="headerlink" title="1.2 ä¸ºä»€ä¹ˆéœ€è¦å­¦"></a><em>1.2 ä¸ºä»€ä¹ˆéœ€è¦å­¦</em></h2><hr><ul><li>æé«˜ç¨‹åºå‘˜çš„æ€ç»´èƒ½åŠ›ï¼ˆå³è®©æˆ‘ä»¬çš„æ€ç»´æ›´åŠ å¼€é˜”ï¼Œå¦‚æœåæœŸæˆ‘ä»¬è¦å»è®¾è®¡å’±ä»¬çš„è½¯ä»¶çš„è¯ï¼Œé‚£ä¹ˆå°±èƒ½å¥—ç”¨è¿™äº›è®¾è®¡æ¨¡å¼å»è®¾è®¡å’±ä»¬çš„è½¯ä»¶äº†ï¼‰ã€ç¼–ç¨‹èƒ½åŠ›å’Œè®¾è®¡èƒ½åŠ›ã€‚å½“ç„¶ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬æ›´å¼ºè°ƒçš„æ˜¯è®¾è®¡èƒ½åŠ›</li><li>ä½¿ç¨‹åºè®¾è®¡æ›´åŠ æ ‡å‡†åŒ–ã€ä»£ç ç¼–åˆ¶æ›´åŠ å·¥ç¨‹åŒ–ï¼Œä½¿è½¯ä»¶å¼€å‘æ•ˆç‡å¤§å¤§æé«˜ï¼Œä»è€Œç¼©çŸ­è½¯ä»¶çš„å¼€å‘å‘¨æœŸ</li><li>ä½¿è®¾è®¡çš„ä»£ç å¯é‡ç”¨æ€§é«˜ã€å¯è¯»æ€§å¼ºã€å¯é æ€§é«˜ã€çµæ´»æ€§å¥½ã€å¯ç»´æŠ¤æ€§å¼º</li></ul><h2 id="1-3-è®¾è®¡æ¨¡å¼çš„åˆ†ç±»"><a href="#1-3-è®¾è®¡æ¨¡å¼çš„åˆ†ç±»" class="headerlink" title="1.3 è®¾è®¡æ¨¡å¼çš„åˆ†ç±»"></a><em>1.3 è®¾è®¡æ¨¡å¼çš„åˆ†ç±»</em></h2><hr><p>23ç§è®¾è®¡æ¨¡å¼åˆ†ä¸ºä¸‰å¤§ç±»å‹ï¼š</p><ul><li>åˆ›å»ºå‹æ¨¡å¼</li><li>ç»“æ„å‹æ¨¡å¼</li><li>è¡Œä¸ºå‹æ¨¡å¼</li></ul><h3 id="1-3-1-åˆ›å»ºå‹æ¨¡å¼"><a href="#1-3-1-åˆ›å»ºå‹æ¨¡å¼" class="headerlink" title="1.3.1 åˆ›å»ºå‹æ¨¡å¼"></a>1.3.1 åˆ›å»ºå‹æ¨¡å¼</h3><p>åˆ›å»ºå‹æ¨¡å¼æä¾›äº†ä¸€ç§åœ¨åˆ›å»ºå¯¹è±¡çš„åŒæ—¶éšè—åˆ›å»ºé€»è¾‘çš„æ–¹å¼ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ new è¿ç®—ç¬¦ç›´æ¥å®ä¾‹åŒ–å¯¹è±¡ã€‚è¿™ä½¿å¾—ç¨‹åºåœ¨åˆ¤æ–­é’ˆå¯¹æŸä¸ªç»™å®šå®ä¾‹éœ€è¦åˆ›å»ºå“ªäº›å¯¹è±¡æ—¶æ›´åŠ çµæ´»ã€‚<strong>ç®€å•åœ°è¯´å°±æ˜¯ç”¨äºæè¿°â€æ€æ ·åˆ›å»ºå¯¹è±¡â€ï¼Œå®ƒçš„ä¸»è¦ç‰¹ç‚¹æ˜¯â€å°†å¯¹è±¡çš„åˆ›å»ºä¸ä½¿ç”¨åˆ†ç¦»â€ï¼Œå°†åˆ›å»ºå’Œä½¿ç”¨è§£è€¦ã€‚</strong></p><p>åˆ›å»ºå‹æ¨¡å¼åŒ…å«äº†ï¼š</p><div style="list-style-type: decimal;padding-left: 20px;border: 1px solid #ddd;background-color: #f9f9f9;border-radius: 5px;margin: 0;">    <li style="margin-bottom: 10px;">å·¥å‚æ¨¡å¼</li>    <li style="margin-bottom: 10px;">æŠ½è±¡å·¥å‚æ¨¡å¼</li>    <li style="margin-bottom: 10px;">å•ä¾‹æ¨¡å¼</li>    <li style="margin-bottom: 10px;">å»ºé€ è€…æ¨¡å¼</li>    <li style="margin-bottom: 10px;">åŸå‹æ¨¡å¼</li></div><h3 id="1-3-2-ç»“æ„å‹æ¨¡å¼"><a href="#1-3-2-ç»“æ„å‹æ¨¡å¼" class="headerlink" title="1.3.2 ç»“æ„å‹æ¨¡å¼"></a>1.3.2 ç»“æ„å‹æ¨¡å¼</h3><p>ç»“æ„å‹æ¨¡å¼ç”¨äºæè¿°å¦‚ä½•å°†ç±»å’Œå¯¹è±¡æŒ‰ç…§æŸç§å¸ƒå±€ç»„æˆæ›´å¤§çš„ç»“æ„ã€‚ç»“æ„å‹æ¨¡å¼å…³æ³¨ç±»å’Œå¯¹è±¡çš„ç»„åˆï¼Œç»§æ‰¿çš„æ¦‚å¿µè¢«ç”¨æ¥ç»„åˆæ¥å£å’Œå®šä¹‰ç»„åˆå¯¹è±¡è·å¾—æ–°åŠŸèƒ½çš„æ–¹å¼ã€‚<br>ä¾‹å­ï¼šæ¯”å¦‚è¯´ï¼Œä½ ç°åœ¨è¦ç›–æˆ¿ï¼Œé‚£ä¹ˆ<strong>åˆ›å»ºå‹æ¨¡å¼å°±å¥½æ¯”ä½ å»è´­ä¹°ç›–æˆ¿æ‰€éœ€è¦çš„ææ–™ï¼Œå¦‚é’¢ç­‹ã€æ°´æ³¥ç­‰ç­‰ï¼Œç„¶åç”¨è¿™äº›ææ–™ä½ å°±èƒ½æ­èµ·æ¥æ•´ä¸ªæˆ¿å±‹çš„æ¶æ„äº†ï¼Œè¿™ä¸ªå°±æ˜¯æ‰€è°“çš„ç»“æ„å‹æ¨¡å¼ã€‚</strong></p><p>ç»“æ„å‹æ¨¡å¼åŒ…å«äº†ï¼š</p><div style="list-style-type: decimal;padding-left: 20px;border: 1px solid #ddd;background-color: #f9f9f9;border-radius: 5px;margin: 0;">    <li style="margin-bottom: 10px;">é€‚é…å™¨æ¨¡å¼</li>    <li style="margin-bottom: 10px;">è£…é¥°å™¨æ¨¡å¼</li>    <li style="margin-bottom: 10px;">ä»£ç†æ¨¡å¼</li>    <li style="margin-bottom: 10px;">å¤–è§‚æ¨¡å¼</li>    <li style="margin-bottom: 10px;">æ¡¥æ¥æ¨¡å¼</li>    <li style="margin-bottom: 10px;">ç»„åˆæ¨¡å¼</li>    <li style="margin-bottom: 10px;">äº«å…ƒæ¨¡å¼</li></div><h3 id="1-3-3-è¡Œä¸ºå‹æ¨¡å¼"><a href="#1-3-3-è¡Œä¸ºå‹æ¨¡å¼" class="headerlink" title="1.3.3 è¡Œä¸ºå‹æ¨¡å¼"></a>1.3.3 è¡Œä¸ºå‹æ¨¡å¼</h3><p>ç”¨äºæè¿°ç±»æˆ–å¯¹è±¡ä¹‹é—´æ€æ ·ç›¸äº’åä½œå…±åŒå®Œæˆå•ä¸ªå¯¹è±¡æ— æ³•å•ç‹¬å®Œæˆçš„ä»»åŠ¡ï¼Œä»¥åŠæ€æ ·åˆ†é…èŒè´£ï¼Œ<strong>å®ƒä»¬ç‰¹åˆ«å…³æ³¨å¯¹è±¡ä¹‹é—´çš„é€šä¿¡ï¼Œä¹Ÿå°±æ˜¯è¯´å¤šä¸ªå¯¹è±¡åˆä½œå»å®ŒæˆæŸä¸€ä»¶äº‹ã€‚</strong></p><p>è¡Œä¸ºå‹æ¨¡å¼åŒ…å«äº†ï¼š</p><div style="list-style-type: decimal;padding-left: 20px;border: 1px solid #ddd;background-color: #f9f9f9;border-radius: 5px;margin: 0;">    <li style="margin-bottom: 10px;">ç­–ç•¥æ¨¡å¼</li>    <li style="margin-bottom: 10px;">æ¨¡æ¿æ–¹æ³•æ¨¡å¼</li>    <li style="margin-bottom: 10px;">è§‚å¯Ÿè€…æ¨¡å¼</li>    <li style="margin-bottom: 10px;">è¿­ä»£å­æ¨¡å¼</li>    <li style="margin-bottom: 10px;">è´£ä»»é“¾æ¨¡å¼</li>    <li style="margin-bottom: 10px;">å‘½ä»¤æ¨¡å¼</li>    <li style="margin-bottom: 10px;">å¤‡å¿˜å½•æ¨¡å¼</li>    <li style="margin-bottom: 10px;">çŠ¶æ€æ¨¡å¼</li>    <li style="margin-bottom: 10px;">è®¿é—®è€…æ¨¡å¼</li>    <li style="margin-bottom: 10px;">ä¸­ä»‹è€…æ¨¡å¼</li>    <li style="margin-bottom: 10px;">è§£é‡Šå™¨æ¨¡å¼</li></div><h2 id="1-4-å…­å¤§è®¾è®¡åŸåˆ™"><a href="#1-4-å…­å¤§è®¾è®¡åŸåˆ™" class="headerlink" title="1.4 å…­å¤§è®¾è®¡åŸåˆ™"></a><em>1.4 å…­å¤§è®¾è®¡åŸåˆ™</em></h2><hr><p>åœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œ<strong>ä¸ºäº†æé«˜è½¯ä»¶ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§å’Œå¯å¤ç”¨æ€§ï¼Œå¢åŠ è½¯ä»¶çš„å¯æ‰©å±•æ€§å’Œçµæ´»æ€§ï¼Œ</strong>ç¨‹åºå‘˜è¦å°½é‡æ ¹æ®6æ¡åŸåˆ™æ¥å¼€å‘ç¨‹åºï¼Œ<strong>ä»è€Œæé«˜è½¯ä»¶å¼€å‘æ•ˆç‡ã€èŠ‚çº¦è½¯ä»¶å¼€å‘æˆæœ¬å’Œç»´æŠ¤æˆæœ¬ã€‚</strong><br>å…­å¤§åŸåˆ™åˆ†åˆ«æ˜¯ï¼š</p><div style="list-style-type: decimal;padding-left: 20px;border: 1px solid #ddd;background-color: #f9f9f9;border-radius: 5px;margin: 0;">    <li style="margin-bottom: 10px;">å•ä¸€èŒè´£åŸåˆ™</li>    <li style="margin-bottom: 10px;">é‡Œæ°ä»£æ¢åŸåˆ™</li>    <li style="margin-bottom: 10px;">ä¾èµ–å€’è½¬åŸåˆ™</li>    <li style="margin-bottom: 10px;">æ¥å£éš”ç¦»åŸåˆ™</li>    <li style="margin-bottom: 10px;">è¿ªç±³æ³•ç‰¹åŸåˆ™</li>    <li style="margin-bottom: 10px;">å¼€é—­åŸåˆ™</li></div><h1 id="2-è®¾è®¡åŸåˆ™-ğŸš€"><a href="#2-è®¾è®¡åŸåˆ™-ğŸš€" class="headerlink" title="2.è®¾è®¡åŸåˆ™ ğŸš€"></a><strong>2.è®¾è®¡åŸåˆ™ ğŸš€</strong></h1><h2 id="2-1-å•ä¸€èŒè´£åŸåˆ™"><a href="#2-1-å•ä¸€èŒè´£åŸåˆ™" class="headerlink" title="2.1 å•ä¸€èŒè´£åŸåˆ™"></a><em>2.1 å•ä¸€èŒè´£åŸåˆ™</em></h2><hr><p><strong>é¦–å…ˆæ¥ä¸€ä¸ªè‡ªæˆ‘æ€»ç»“ï¼š</strong></p><p>ä¸€ä¸ªç±»åº”è¯¥åªè´Ÿè´£ä¸€é¡¹èŒè´£ï¼Œè¿™æ ·å¯ä»¥é™ä½ç±»çš„å¤æ‚åº¦ï¼Œç±»çš„åŠŸèƒ½å°±æ¯”è¾ƒå•ä¸€ï¼Œå®¹æ˜“ç†è§£ï¼Œå®¹æ˜“ç»´æŠ¤ã€‚<br>åœ¨ä¸€å¼€å§‹å¼€å‘çš„æ—¶å€™å°±åšå¥½å•ä¸€èŒè´£ï¼Œåœ¨ä»¥åéœ€è¦æ›´æ”¹ç±»å½“ä¸­æŸä¸ªåŠŸèƒ½çš„æ—¶å€™åªéœ€è¦ä¿®æ”¹å¯¹åº”èŒè´£çš„æ¥å£ï¼Œä¸ä¼šå½±å“åˆ°åˆ«çš„åŠŸèƒ½ã€‚</p><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li><strong>ç±»çš„å¤æ‚æ€§é™ä½</strong>ï¼Œå®ç°ä»€ä¹ˆèŒè´£éƒ½æœ‰æ¸…æ™°æ˜ç¡®çš„å®šä¹‰ï¼› </li><li><strong>å¯è¯»æ€§æé«˜</strong>ï¼Œå¤æ‚æ€§é™ä½ï¼Œé‚£å½“ç„¶å¯è¯»æ€§æé«˜äº†ï¼› </li><li><strong>å¯ç»´æŠ¤æ€§æé«˜</strong>ï¼Œé‚£å½“ç„¶äº†ï¼Œå¯è¯»æ€§æé«˜ï¼Œé‚£å½“ç„¶æ›´å®¹æ˜“ç»´æŠ¤äº†ï¼›</li><li><strong>å˜æ›´å¼•èµ·çš„é£é™©é™ä½</strong>ï¼Œå˜æ›´æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œæ¥å£çš„å•ä¸€èŒè´£åšçš„å¥½çš„è¯ï¼Œä¸€ä¸ªæ¥å£ä¿®æ”¹åªå¯¹ç›¸åº”çš„å®ç°ç±»æœ‰å½±å“ï¼Œä¸å…¶ä»–çš„æ¥å£æ— å½±å“ï¼Œè¿™ä¸ªæ˜¯å¯¹é¡¹ç›®æœ‰éå¸¸å¤§çš„å¸®åŠ©</li></ul><h2 id="2-2-é‡Œæ°æ›¿æ¢åŸåˆ™"><a href="#2-2-é‡Œæ°æ›¿æ¢åŸåˆ™" class="headerlink" title="2.2 é‡Œæ°æ›¿æ¢åŸåˆ™"></a><em>2.2 é‡Œæ°æ›¿æ¢åŸåˆ™</em></h2><hr><p>è¯·çœ‹ï¼š<a href="https://blog.csdn.net/weixin_39327556/article/details/125268590">https://blog.csdn.net/weixin_39327556&#x2F;article&#x2F;details&#x2F;125268590</a></p><p><strong>è‡ªæˆ‘æ€»ç»“ï¼š</strong><br>é‡Œæ°ä»£æ¢åŸåˆ™æ˜¯æŒ‡ä»»ä½•åŸºç±»å¯ä»¥å‡ºç°çš„åœ°æ–¹ï¼Œå­ç±»ä¸€å®šå¯ä»¥å‡ºç°ï¼Œä¸ä¼šå‘ç”Ÿå¼‚å¸¸ã€‚<strong>å¯ä»¥é€šä¿—ç†è§£æˆå­ç±»å¯ä»¥æ‰©å±•çˆ¶ç±»çš„åŠŸèƒ½ï¼Œä½†ä¸èƒ½æ”¹å˜çˆ¶ç±»åŸæœ‰çš„åŠŸèƒ½ã€‚</strong></p><p><strong>ä¼˜ç‚¹ï¼š</strong><br>é‡Œæ°æ›¿æ¢æ³•åˆ™è¯ç”Ÿçš„ç›®çš„å°±æ˜¯<strong>åŠ å¼ºç¨‹åºçš„å¥å£®æ€§</strong>ï¼ŒåŒæ—¶<em>ç‰ˆæœ¬å‡çº§</em>ä¹Ÿå¯ä»¥åšåˆ°éå¸¸å¥½çš„<strong>å…¼å®¹æ€§</strong>ï¼Œå¢åŠ å­ç±»ï¼ŒåŸæœ‰çš„å­ç±»è¿˜å¯ä»¥ç»§ç»­è¿è¡Œã€‚åœ¨æˆ‘ä»¬é¡¹ç›®å®æ–½ä¸­å°±æ˜¯æ¯ä¸ªå­ç±»å¯¹åº”äº†ä¸åŒçš„ä¸šåŠ¡å«ä¹‰ï¼Œä½¿ç”¨çˆ¶ç±»ä½œä¸ºå‚æ•°ï¼Œä¼ é€’ä¸åŒçš„å­ç±»å®Œæˆä¸åŒçš„ä¸šåŠ¡é€»è¾‘ï¼Œéå¸¸å®Œç¾ï¼</p><h2 id="2-3-ä¾èµ–å€’è½¬åŸåˆ™"><a href="#2-3-ä¾èµ–å€’è½¬åŸåˆ™" class="headerlink" title="2.3 ä¾èµ–å€’è½¬åŸåˆ™"></a><em>2.3 ä¾èµ–å€’è½¬åŸåˆ™</em></h2><hr><div style="list-style-type: decimal;padding-left: 20px;border: 1px solid #ddd;background-color: #f9f9f9;border-radius: 5px;margin: 0;">é«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–ä½å±‚æ¨¡å—ï¼Œä¸¤è€…éƒ½åº”è¯¥ä¾èµ–å…¶æŠ½è±¡ï¼›æŠ½è±¡ä¸åº”è¯¥ä¾èµ–ç»†èŠ‚ï¼Œç»†èŠ‚åº”è¯¥ä¾èµ–æŠ½è±¡ã€‚ç®€å•çš„è¯´å°±æ˜¯è¦æ±‚å¯¹æŠ½è±¡è¿›è¡Œç¼–ç¨‹ï¼Œä¸è¦å¯¹å®ç°è¿›è¡Œç¼–ç¨‹ï¼Œè¿™æ ·å°±é™ä½äº†å®¢æˆ·ä¸å®ç°æ¨¡å—é—´çš„è€¦åˆã€‚</div><p>ä¾‹å­ï¼š</p><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E4%BE%9D%E8%B5%96%E5%80%92%E7%BD%AE1.png" class="" title="ç”µè„‘åŠå…¶ç¡¬ä»¶"><p>å¦‚æœåƒè¿™æ ·è®¾è®¡ç±»çš„è¯ï¼Œå¾€åå¦‚æœæƒ³è¦æ¢ç¡¬ä»¶è¿˜å¾—ä¿®æ”¹computerç±»ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†ç¡¬ä»¶çš„åŸºæœ¬åŠŸèƒ½å†™è¿›æ¥å£é‡Œé¢ï¼Œè®©å…·ä½“çš„ç¡¬ä»¶ç±»å»å®ç°è¿™ç§æ–¹æ³•ï¼Œç„¶ååœ¨ä½¿ç”¨computerç±»çš„æ—¶å€™åœ¨å»åˆ›å»ºå…·ä½“çš„ç¡¬ä»¶ç±»ï¼Œè¿™æ ·computerç±»å°±åªè´Ÿè´£æ˜¾ç¤ºï¼Œè€Œä¸ç®¡å…·ä½“æ˜¯ä»€ä¹ˆç¡¬ä»¶ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E4%BE%9D%E8%B5%96%E5%80%92%E7%BD%AE2.png" class="" title="ç”µè„‘åŠå…¶ç¡¬ä»¶2"><h2 id="2-4-æ¥å£éš”ç¦»åŸåˆ™"><a href="#2-4-æ¥å£éš”ç¦»åŸåˆ™" class="headerlink" title="2.4 æ¥å£éš”ç¦»åŸåˆ™"></a><em>2.4 æ¥å£éš”ç¦»åŸåˆ™</em></h2><hr><p>æ¥å£éš”ç¦»åŸåˆ™æ˜¯æŒ‡å®¢æˆ·ç«¯ä¸åº”è¯¥è¢«è¿«ä¾èµ–äºå®ƒä¸ä½¿ç”¨çš„æ–¹æ³•ï¼Œä¸€ä¸ªç±»å¯¹å¦ä¸€ä¸ªç±»çš„ä¾èµ–åº”è¯¥å»ºç«‹åœ¨æœ€å°çš„æ¥å£ä¸Šé¢ã€‚</p><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%8E%A5%E5%8F%A3%E9%9A%94%E7%A6%BB%E5%8E%9F%E5%88%991.png" class="" title="æ¥å£éš”ç¦»åŸåˆ™1"><p>æˆ‘ä»¬æ”¹é€ ä¸€ä¸‹ï¼š</p><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%8E%A5%E5%8F%A3%E9%9A%94%E7%A6%BB%E5%8E%9F%E5%88%992.png" class="" title="æ¥å£éš”ç¦»åŸåˆ™2"><h2 id="2-5-è¿ªç±³ç‰¹æ³•åˆ™"><a href="#2-5-è¿ªç±³ç‰¹æ³•åˆ™" class="headerlink" title="2.5 è¿ªç±³ç‰¹æ³•åˆ™"></a><em>2.5 è¿ªç±³ç‰¹æ³•åˆ™</em></h2><hr><p>ä¹Ÿå«æœ€å°‘çŸ¥è¯†åŸåˆ™<br>è§£é‡Šèµ·æ¥ä¹Ÿå¾ˆç®€å•ï¼šæ˜¯è‡ªå·±çš„å°±æ˜¯è‡ªå·±çš„ã€‚åœ¨é¡¹ç›®ä¸­æœ‰ä¸€äº›æ–¹æ³•ï¼Œ<strong>æ”¾åœ¨æœ¬ç±»ä¸­ä¹Ÿå¯ä»¥</strong>ï¼Œæ”¾åœ¨<strong>å…¶ä»–ç±»ä¸­ä¹Ÿæ²¡æœ‰é”™è¯¯</strong>ï¼Œé‚£æ€ä¹ˆå»è¡¡é‡å‘¢ï¼Ÿä½ å¯ä»¥åšæŒè¿™æ ·ä¸€ä¸ªåŸåˆ™ï¼š<strong>å¦‚æœä¸€ä¸ªæ–¹æ³•æ”¾åœ¨æœ¬ç±»ä¸­ï¼Œå³ä¸å¢åŠ ç±»é—´å…³ç³»ï¼Œä¹Ÿå¯¹æœ¬ç±»ä¸äº§ç”Ÿè´Ÿé¢å½±å“ï¼Œå°±æ”¾ç½®åœ¨æœ¬ç±»ä¸­ã€‚</strong></p><h2 id="2-6-å¼€é—­åŸåˆ™"><a href="#2-6-å¼€é—­åŸåˆ™" class="headerlink" title="2.6 å¼€é—­åŸåˆ™"></a><em>2.6 å¼€é—­åŸåˆ™</em></h2><hr><p>è½¯ä»¶å®ä½“ï¼ˆæ¨¡å—ã€ç±»ã€æ–¹æ³•ç­‰ï¼‰åº”è¯¥å¯¹æ‰©å±•å¼€æ”¾ã€å¯¹ä¿®æ”¹å…³é—­ï¼šæ·»åŠ ä¸€ä¸ªæ–°çš„åŠŸèƒ½åº”è¯¥æ˜¯ï¼Œåœ¨å·²æœ‰ä»£ç åŸºç¡€ä¸Šæ‰©å±•ä»£ç ï¼ˆæ–°å¢æ¨¡å—ã€ç±»ã€æ–¹æ³•ç­‰ï¼‰ï¼Œè€Œéä¿®æ”¹å·²æœ‰ä»£ç ï¼ˆä¿®æ”¹æ¨¡å—ã€ç±»ã€æ–¹æ³•ç­‰ï¼‰</p><p>è¿™é‡Œæœ‰å‡ ä¸ªå¥½ä¾‹å­ï¼š<a href="https://zhuanlan.zhihu.com/p/641331256">https://zhuanlan.zhihu.com/p/641331256</a></p><h1 id="3-è®¾è®¡æ¨¡å¼-ğŸš€"><a href="#3-è®¾è®¡æ¨¡å¼-ğŸš€" class="headerlink" title="3.è®¾è®¡æ¨¡å¼ ğŸš€"></a><strong>3.è®¾è®¡æ¨¡å¼ ğŸš€</strong></h1><h2 id="3-1-åˆ›å»ºå‹æ¨¡å¼"><a href="#3-1-åˆ›å»ºå‹æ¨¡å¼" class="headerlink" title="3.1 åˆ›å»ºå‹æ¨¡å¼"></a><em>3.1 åˆ›å»ºå‹æ¨¡å¼</em></h2><hr><h3 id="3-1-1-å·¥å‚æ¨¡å¼"><a href="#3-1-1-å·¥å‚æ¨¡å¼" class="headerlink" title="3.1.1 å·¥å‚æ¨¡å¼"></a>3.1.1 å·¥å‚æ¨¡å¼</h3><ul><li>åœ¨javaä¸­ï¼Œä¸‡ç‰©çš†å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡éƒ½éœ€è¦åˆ›å»ºï¼Œ<strong>å¦‚æœåˆ›å»ºçš„æ—¶å€™ç›´æ¥newè¯¥å¯¹è±¡</strong>ï¼Œå°±ä¼šå¯¹è¯¥å¯¹è±¡è€¦åˆä¸¥é‡ï¼Œå‡å¦‚æˆ‘ä»¬è¦æ›´æ¢å¯¹è±¡ï¼Œæ‰€æœ‰newå¯¹è±¡çš„åœ°æ–¹éƒ½éœ€è¦ä¿®æ”¹ä¸€éï¼Œ<strong>è¿™æ˜¾ç„¶è¿èƒŒäº†è½¯ä»¶è®¾è®¡çš„å¼€é—­åŸåˆ™</strong>ã€‚</li><li>å¦‚æœæˆ‘ä»¬ä½¿ç”¨å·¥å‚æ¥ç”Ÿäº§å¯¹è±¡ï¼Œæˆ‘ä»¬å°±<strong>åªå’Œå·¥å‚æ‰“äº¤é“å°±å¯ä»¥äº†</strong>ï¼Œå½»åº•å’Œå¯¹è±¡è§£è€¦ï¼Œå¦‚æœè¦æ›´æ¢å¯¹è±¡ï¼Œç›´æ¥åœ¨å·¥å‚é‡Œæ›´æ¢è¯¥å¯¹è±¡å³å¯ï¼Œè¾¾åˆ°äº†ä¸å¯¹è±¡è§£è€¦çš„ç›®çš„ã€‚</li><li>æ‰€ä»¥è¯´ï¼Œå·¥å‚æ¨¡å¼æœ€å¤§çš„ä¼˜ç‚¹å°±æ˜¯ï¼š<strong>è§£è€¦</strong>ã€‚</li></ul><h4 id="3-1-1-1-ç®€å•å·¥å‚æ¨¡å¼"><a href="#3-1-1-1-ç®€å•å·¥å‚æ¨¡å¼" class="headerlink" title="3.1.1.1 ç®€å•å·¥å‚æ¨¡å¼"></a>3.1.1.1 ç®€å•å·¥å‚æ¨¡å¼</h4><p>åŸå§‹ä¾‹å­çœ‹ä¸‹å›¾ï¼š</p><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82-%E5%8E%9F%E5%A7%8B.png" class="" title="ç®€å•å·¥å‚-åŸå§‹"><p><strong>æ¥ä¸‹æ¥æˆ‘ä»¬è¦å°†å…¶æ”¹é€ ä¸ºç®€å•å·¥å‚æ¨¡å¼</strong><br>ç®€å•å·¥å‚åŒ…å«å¦‚ä¸‹è§’è‰²ï¼š<br><strong>æŠ½è±¡äº§å“</strong> ï¼šå®šä¹‰äº†äº§å“çš„è§„èŒƒï¼Œæè¿°äº†äº§å“çš„ä¸»è¦ç‰¹æ€§å’ŒåŠŸèƒ½ã€‚<br><strong>å…·ä½“äº§å“</strong> ï¼šå®ç°æˆ–è€…ç»§æ‰¿æŠ½è±¡äº§å“çš„å­ç±»<br><strong>å…·ä½“å·¥å‚</strong> ï¼šæä¾›äº†åˆ›å»ºäº§å“çš„æ–¹æ³•ï¼Œè°ƒç”¨è€…é€šè¿‡è¯¥æ–¹æ³•æ¥è·å–äº§å“ã€‚</p><p>æ”¹é€ åï¼š</p><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82-%E6%94%B9%E9%80%A0%E5%90%8E.png" class="" title="ç®€å•å·¥å‚-æ”¹é€ å"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lxg.pattern.factory.factory_simple;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç®€å•å’–å•¡å·¥å‚ç±»ï¼Œç”¨æ¥ç”Ÿäº§å’–å•¡</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * ç®€å•å·¥å‚å¤„ç†åˆ›å»ºå¯¹è±¡çš„ç»†èŠ‚ï¼Œæœ‰äº†æ­¤ç®€å•å·¥å‚å¯¹è±¡ï¼Œåœ¨CoffeeStoreå¯¹è±¡ä¸­å¦‚æœéœ€è¦Coffeeå¯¹è±¡ï¼Œåªéœ€è¦åœ¨å·¥å‚ç±»</span></span><br><span class="line"><span class="comment"> * ä¸­è·å–å°±è¡Œã€‚è¿™æ ·è§£é™¤äº†Coffeeç±»å’ŒCoffeeStoreç±»çš„è€¦åˆï¼Œä½†æ˜¯è¿™æ ·ä¹Ÿäº§ç”Ÿäº†æ–°çš„è€¦åˆï¼Œå³å·¥å‚å¯¹è±¡å’ŒCoffeeStore</span></span><br><span class="line"><span class="comment"> * çš„è€¦åˆä»¥åŠå·¥å‚å¯¹è±¡è·ŸCoffeeç±»çš„è€¦åˆã€‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * æœ‰äº†å·¥å‚å¯¹è±¡ï¼Œå¦‚æœåæœŸå¢åŠ äº†æ›´å¤šçš„å’–å•¡ï¼Œåˆ™åŠ¿å¿…å¯¹å·¥å‚å¯¹è±¡è¿›è¡Œæ”¹é€ ï¼Œè¿åäº†å¼€é—­åŸåˆ™ã€‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * ç®€å•å·¥å‚ï¼š</span></span><br><span class="line"><span class="comment"> * ä¼˜ç‚¹ï¼š</span></span><br><span class="line"><span class="comment"> * å°è£…äº†åˆ›å»ºå¯¹è±¡çš„ç»†èŠ‚ï¼Œå¯ä»¥é€šè¿‡å‚æ•°ç›´æ¥è·å–å¯¹è±¡ï¼ŒæŠŠå¯¹è±¡çš„åˆ›å»ºå’Œä¸šåŠ¡é€»è¾‘å±‚åˆ†å¼€ï¼Œè¿™æ ·é¿å…ä»¥åä¿®æ”¹å®¢æˆ·ç«¯ä»£ç ï¼Œ</span></span><br><span class="line"><span class="comment"> * å¦‚æœè¦å®ç°æ–°çš„äº§å“ï¼Œç›´æ¥ä¿®æ”¹å·¥å‚ç±»å°±è¡Œäº†ï¼Œè€Œä¸éœ€è¦åœ¨ä¸šåŠ¡ä»£ç ä¸­ä¿®æ”¹ï¼Œè¿™æ ·å°±é™ä½äº†å®¢æˆ·ä»£ç ä¿®æ”¹çš„å¯èƒ½æ€§ï¼Œæ›´åŠ </span></span><br><span class="line"><span class="comment"> * å®¹æ˜“æ‰©å±•ã€‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * ç¼ºç‚¹ï¼š</span></span><br><span class="line"><span class="comment"> * å¢åŠ æ–°çš„äº§å“çš„æ—¶å€™ï¼Œè¿˜æ˜¯éœ€è¦ä¿®æ”¹å·¥å‚ç±»ï¼Œè¿èƒŒäº†è®¾è®¡åŸåˆ™çš„å¼€é—­åŸåˆ™ã€‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SimpleCoffeeFactory</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Coffee <span class="title function_">createCoffee</span><span class="params">(String type)</span>&#123;</span><br><span class="line">        <span class="comment">//å£°æ˜Coffeeç±»å‹çš„å˜é‡ï¼Œæ ¹æ®ä¸åŒçš„ç±»å‹åˆ›å»ºä¸åŒçš„coffeeå­ç±»å¯¹è±¡</span></span><br><span class="line">        <span class="type">Coffee</span> <span class="variable">coffee</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;american&quot;</span>.equals(type))&#123;</span><br><span class="line">            coffee = <span class="keyword">new</span> <span class="title class_">AmericanCoffee</span>();</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">&quot;latte&quot;</span>.equals(type))&#123;</span><br><span class="line">            coffee = <span class="keyword">new</span> <span class="title class_">LatteCoffee</span>();</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;å¯¹ä¸èµ·ï¼Œæ‚¨ç‚¹çš„å’–å•¡æ²¡æœ‰&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> coffee;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœå°†åˆ›å»ºæ–¹æ³•å®šä¹‰ä¸ºé™æ€æ–¹æ³•ï¼Œå°±æ˜¯æ‰€è°“çš„é™æ€å·¥å‚æ¨¡å¼ï¼Œä½†æ˜¯å…¶å®ä¸å±äº23ç§è®¾è®¡æ¨¡å¼ã€‚</p><h4 id="3-1-1-2-å·¥å‚æ–¹æ³•æ¨¡å¼"><a href="#3-1-1-2-å·¥å‚æ–¹æ³•æ¨¡å¼" class="headerlink" title="3.1.1.2 å·¥å‚æ–¹æ³•æ¨¡å¼"></a>3.1.1.2 å·¥å‚æ–¹æ³•æ¨¡å¼</h4><p>çœ‹è¿‡äº†ç®€å•å·¥å‚æ¨¡å¼ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹å·¥å‚æ–¹æ³•æ¨¡å¼ã€‚<br>åŸç†ï¼š<strong>å°†åˆ›å»ºå®ä¾‹çš„è¿‡ç¨‹å»¶è¿Ÿåˆ°å­ç±»ä¸­ï¼Œä»è€Œå®ç°å¯¹åˆ›å»ºå®ä¾‹çš„è§£è€¦</strong>ã€‚</p><p>å·¥å‚æ–¹æ³•æ¨¡å¼çš„ä¸»è¦è§’è‰²ï¼š<br><strong>æŠ½è±¡å·¥å‚ï¼ˆAbstract Factoryï¼‰</strong>ï¼šæä¾›äº†åˆ›å»ºäº§å“çš„æ¥å£ï¼Œè°ƒç”¨è€…é€šè¿‡å®ƒè®¿é—®å…·ä½“å·¥å‚çš„å·¥å‚æ–¹æ³•æ¥åˆ›å»ºäº§å“ã€‚<br><strong>å…·ä½“å·¥å‚ï¼ˆConcreteFactoryï¼‰</strong>ï¼šä¸»è¦æ˜¯å®ç°æŠ½è±¡å·¥å‚ä¸­çš„æŠ½è±¡æ–¹æ³•ï¼Œå®Œæˆå…·ä½“äº§å“çš„åˆ›å»ºã€‚<br><strong>æŠ½è±¡äº§å“ï¼ˆProductï¼‰</strong>ï¼šå®šä¹‰äº†äº§å“çš„è§„èŒƒï¼Œæè¿°äº†äº§å“çš„ä¸»è¦ç‰¹æ€§å’ŒåŠŸèƒ½ã€‚<br><strong>å…·ä½“äº§å“ï¼ˆConcreteProductï¼‰</strong>ï¼šå®ç°äº†æŠ½è±¡äº§å“è§’è‰²æ‰€å®šä¹‰çš„æ¥å£ï¼Œç”±å…·ä½“å·¥å‚æ¥åˆ›å»ºï¼Œå®ƒåŒå…·ä½“å·¥å‚ä¹‹é—´ä¸€ä¸€å¯¹åº”ã€‚</p><p>å¦‚å›¾æ‰€ç¤ºï¼š</p><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F.png" class="" title="å·¥å‚æ¨¡å¼"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lxg.pattern.factory.factory_method;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å·¥å‚ï¼šå¦‚æœå¢åŠ æ–°çš„ç§ç±»å’–å•¡ï¼Œåªéœ€è¦å¢åŠ ä¸€ä¸ªCoffeeFactoryæ¥å£çš„å®ç°ç±»å°±è¡Œã€‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * ä¼˜ç‚¹ï¼š</span></span><br><span class="line"><span class="comment"> * - ç”¨æˆ·åªéœ€è¦çŸ¥é“å…·ä½“çš„å·¥å‚åå­—å°±èƒ½å¾—åˆ°æ‰€éœ€è¦çš„äº§å“ï¼Œæ— éœ€çŸ¥é“äº§å“çš„å…·ä½“åˆ›å»ºè¿‡ç¨‹</span></span><br><span class="line"><span class="comment"> * - åœ¨ç³»ç»Ÿå¢åŠ æ–°çš„äº§å“æ—¶åªéœ€è¦æ·»åŠ å…·ä½“äº§å“ç±»å¯¹åº”çš„å…·ä½“å·¥å‚ç±»ï¼Œæ— éœ€å¯¹åŸå·¥å‚ç±»è¿›è¡Œä»»ä½•ä¿®æ”¹ï¼Œæ»¡è¶³å¼€é—­åŸåˆ™</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * ç¼ºç‚¹ï¼š</span></span><br><span class="line"><span class="comment"> * - æ¯å¢åŠ ä¸€ä¸ªäº§å“å°±è¦å¢åŠ ä¸€ä¸ªå…·ä½“äº§å“ç±»å’Œä¸€ä¸ªå¯¹åº”çš„å…·ä½“å·¥å‚ç±»ï¼Œè¿™å¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚æ€§</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CoffeeStore</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> CoffeeFactory factory;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setFactory</span><span class="params">(CoffeeFactory factory)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">this</span>.factory = factory;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Coffee <span class="title function_">orderCoffee</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">Coffee</span> <span class="variable">coffee</span> <span class="operator">=</span> factory.createCoffee();</span><br><span class="line">        coffee.addMilk();</span><br><span class="line">        coffee.addSugar();</span><br><span class="line">        <span class="keyword">return</span> coffee;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-1-2-æŠ½è±¡å·¥å‚æ¨¡å¼"><a href="#3-1-2-æŠ½è±¡å·¥å‚æ¨¡å¼" class="headerlink" title="3.1.2 æŠ½è±¡å·¥å‚æ¨¡å¼"></a>3.1.2 æŠ½è±¡å·¥å‚æ¨¡å¼</h3><p>å’Œå·¥å‚æ¨¡å¼ä¸€æ ·ï¼Œä½†æ˜¯æŠ½è±¡å·¥å‚æ¨¡å¼å¯ä»¥ç”Ÿäº§å¤šä¸ªäº§å“æ—ï¼Œå°±å¥½åƒæ¯”äºšè¿ªå¯ä»¥é€ è½¦ä¹Ÿå¯ä»¥ç”Ÿäº§å£ç½©ä¸€æ ·ã€‚<br>å¦‚å›¾æ‰€ç¤ºï¼š</p><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82-%E4%BA%A7%E5%93%81%E6%97%8F.png" class="" title="æŠ½è±¡å·¥å‚-äº§å“æ—"><p>æŠ½è±¡å·¥å‚æ¨¡å¼çš„ä¸»è¦è§’è‰²å¦‚ä¸‹ï¼š<br><strong>æŠ½è±¡å·¥å‚ï¼ˆAbstract Factoryï¼‰</strong>ï¼šæä¾›äº†åˆ›å»ºäº§å“çš„æ¥å£ï¼Œå®ƒåŒ…å«å¤šä¸ªåˆ›å»ºäº§å“çš„æ–¹æ³•ï¼Œå¯ä»¥åˆ›å»ºå¤šä¸ªä¸åŒç­‰çº§çš„äº§å“ã€‚<br><strong>å…·ä½“å·¥å‚ï¼ˆConcrete Factoryï¼‰</strong>ï¼šä¸»è¦æ˜¯å®ç°æŠ½è±¡å·¥å‚ä¸­çš„å¤šä¸ªæŠ½è±¡æ–¹æ³•ï¼Œå®Œæˆå…·ä½“äº§å“çš„åˆ›å»ºã€‚<br><strong>æŠ½è±¡äº§å“ï¼ˆProductï¼‰</strong>ï¼šå®šä¹‰äº†äº§å“çš„è§„èŒƒï¼Œæè¿°äº†äº§å“çš„ä¸»è¦ç‰¹æ€§å’ŒåŠŸèƒ½ï¼ŒæŠ½è±¡å·¥å‚æ¨¡å¼æœ‰å¤šä¸ªæŠ½è±¡äº§å“ã€‚<br><strong>å…·ä½“äº§å“ï¼ˆConcreteProductï¼‰</strong>ï¼šå®ç°äº†æŠ½è±¡äº§å“è§’è‰²æ‰€å®šä¹‰çš„æ¥å£ï¼Œç”±å…·ä½“å·¥å‚æ¥åˆ›å»ºï¼Œå®ƒ åŒå…·ä½“å·¥å‚ä¹‹é—´æ˜¯å¤šå¯¹ä¸€çš„å…³ç³»ã€‚</p><p>å°†ä¸Šé¢çš„å·¥å‚æ¨¡å¼æ”¹é€ æˆå¦‚ä¸‹å›¾å°±æˆäº†æŠ½è±¡å·¥å‚æ¨¡å¼ï¼š</p><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82.png" class="" title="æŠ½è±¡å·¥å‚"><div style="list-style-type: decimal;padding-left: 20px;border: 1px solid #ddd;background-color: #f9f9f9;border-radius: 5px;margin: 0;">ä¼˜ç‚¹ï¼šå½“ä¸€ä¸ªäº§å“æ—ä¸­çš„å¤šä¸ªå¯¹è±¡è¢«è®¾è®¡æˆä¸€èµ·å·¥ä½œæ—¶ï¼Œå®ƒèƒ½ä¿è¯å®¢æˆ·ç«¯å§‹ç»ˆåªä½¿ç”¨åŒä¸€ä¸ªäº§å“æ—ä¸­çš„å¯¹è±¡ã€‚<p>ç¼ºç‚¹ï¼šå½“äº§å“æ—ä¸­éœ€è¦å¢åŠ ä¸€ä¸ªæ–°çš„äº§å“æ—¶ï¼Œæ‰€æœ‰çš„å·¥å‚ç±»éƒ½éœ€è¦è¿›è¡Œä¿®æ”¹ã€‚</p></div><h3 id="3-1-3-å•ä¾‹æ¨¡å¼"><a href="#3-1-3-å•ä¾‹æ¨¡å¼" class="headerlink" title="3.1.3 å•ä¾‹æ¨¡å¼"></a>3.1.3 å•ä¾‹æ¨¡å¼</h3><p>å•ä¾‹æ¨¡å¼ï¼š<strong>ä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹</strong>ã€‚</p><h4 id="3-1-3-1-é¥¿æ±‰å¼"><a href="#3-1-3-1-é¥¿æ±‰å¼" class="headerlink" title="3.1.3.1 é¥¿æ±‰å¼"></a>3.1.3.1 é¥¿æ±‰å¼</h4><p><strong>é¥¿å¾—ä¸è¡Œï¼Œä¸ç­‰ä½ äº†ï¼Œå…ˆåƒé¥±å†è¯´</strong></p><p><strong>ç¬¬ä¸€ç§æ–¹å¼</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é¥¿æ±‰å¼ï¼šé¢„åŠ è½½</span></span><br><span class="line"><span class="comment"> * é™æ€æˆå‘˜å˜é‡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Singleton1</span> &#123;</span><br><span class="line">    <span class="comment">//å®šä¹‰é™æ€æˆå‘˜å˜é‡è·å–æœ¬ç±»çš„å®ä¾‹</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Singleton1</span> <span class="variable">INSTANCE</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Singleton1</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç§æœ‰æ„é€ æ–¹æ³•ï¼Œé¿å…é€šè¿‡newå…³é”®å­—æ¥å®ä¾‹åŒ–å¯¹è±¡ï¼Œä¿è¯åªå­˜åœ¨ä¸€ä¸ªå®ä¾‹</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Singleton1</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æä¾›ä¸€ä¸ªå…¬å…±çš„è®¿é—®ç±»ï¼Œè®©å¤–ç•Œè·å–è¯¥å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Singleton1 <span class="title function_">getINSTANCE</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> INSTANCE;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç¬¬äºŒç§æ–¹å¼</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é¥¿æ±‰å¼çš„ç¬¬äºŒç§å®ç°æ–¹å¼ï¼š</span></span><br><span class="line"><span class="comment"> * ä½¿ç”¨é™æ€ä»£ç å—çš„æ–¹å¼</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Singleton2</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å£°æ˜Singleton2ç±»å‹çš„é™æ€å¸¸é‡æˆå‘˜å˜é‡ï¼Œä½†æ˜¯æ²¡æœ‰åˆå§‹åŒ–ï¼Œåœ¨é™æ€ä»£ç å—ä¸­å¯¹å…¶è¿›è¡Œåˆå§‹åŒ–</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Singleton2 INSTANCE;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åœ¨é™æ€ä»£ç å—ä¸­å¯¹æˆå‘˜å¸¸é‡åˆå§‹åŒ–</span></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        INSTANCE = <span class="keyword">new</span> <span class="title class_">Singleton2</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//ç§æœ‰åŒ–æ„é€ æ–¹æ³•ï¼Œé¿å…å¤–éƒ¨ä½¿ç”¨newå…³é”®å­—åˆ›å»ºå®ä¾‹</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Singleton2</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å®šä¹‰å…¬å…±æ–¹æ³•ï¼Œå¯¹å¤–æä¾›è·å–å•ä¾‹å®ä¾‹çš„æ¥å£</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Singleton2 <span class="title function_">getINSTANCE</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> INSTANCE;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œä¸ç®¡æˆ‘ä»¬ä½¿ä¸ä½¿ç”¨ï¼Œè¿™ä¸ªå•ä¾‹å¯¹è±¡éƒ½ä¼šåœ¨ç±»åŠ è½½çš„æ—¶å€™å°±åˆ›å»ºå‡ºæ¥ï¼Œå¯èƒ½ä¼šæµªè´¹å†…å­˜ç©ºé—´ã€‚</p><h4 id="3-1-3-2-æ‡’æ±‰å¼"><a href="#3-1-3-2-æ‡’æ±‰å¼" class="headerlink" title="3.1.3.2 æ‡’æ±‰å¼"></a>3.1.3.2 æ‡’æ±‰å¼</h4><p><strong>ä¸å‚¬æˆ‘æˆ‘éƒ½æ‡’å¾—èµ·åºŠåƒé¥­ï¼ˆç¬¬ä¸€æ¬¡è¢«çœŸæ­£ä½¿ç”¨æ—¶æ‰åŠ è½½ï¼‰</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Singleton</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton singleton;</span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Singleton</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŸºç¡€</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title function_">getInstanceL</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (singleton == <span class="literal">null</span>) &#123;</span><br><span class="line">            singleton = <span class="keyword">new</span> <span class="title class_">Singleton</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> singleton;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿›é˜¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> Singleton <span class="title function_">getInstanceM1</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (singleton == <span class="literal">null</span>) &#123;</span><br><span class="line">            singleton = <span class="keyword">new</span> <span class="title class_">Singleton</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> singleton;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æˆ–è€…</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title function_">getInstanceM2</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (Singleton.class) &#123;</span><br><span class="line">            <span class="keyword">if</span> (singleton == <span class="literal">null</span>) &#123;</span><br><span class="line">                singleton = <span class="keyword">new</span> <span class="title class_">Singleton</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> singleton;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é«˜æ‰‹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title function_">getInstanceH</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// çº¿ç¨‹Aå’Œçº¿ç¨‹BåŒæ—¶çœ‹åˆ°singleton = nullï¼Œå¦‚æœä¸ä¸ºnullï¼Œåˆ™ç›´æ¥è¿”å›singleton</span></span><br><span class="line">        <span class="keyword">if</span> (singleton == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">// çº¿ç¨‹Aæˆ–çº¿ç¨‹Bè·å¾—è¯¥é”è¿›è¡Œåˆå§‹åŒ–</span></span><br><span class="line">            <span class="keyword">synchronized</span> (Singleton.class) &#123;</span><br><span class="line">                <span class="comment">// å…¶ä¸­ä¸€ä¸ªçº¿ç¨‹è¿›å…¥è¯¥åˆ†æ”¯ï¼Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹åˆ™ä¸ä¼šè¿›å…¥è¯¥åˆ†æ”¯</span></span><br><span class="line">                <span class="keyword">if</span> (singleton == <span class="literal">null</span>) &#123;</span><br><span class="line">                    singleton = <span class="keyword">new</span> <span class="title class_">Singleton</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> singleton;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯ç”±äºå­˜åœ¨ä»£ç é‡æ’çš„é—®é¢˜ï¼Œè¯¦è§ï¼š<a href="https://blog.csdn.net/t13220621385/article/details/134375665">https://blog.csdn.net/t13220621385/article/details/134375665</a><br>æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨violatileå…³é”®å­—æ¥é˜²æ­¢é‡æ’åºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Singleton</span> &#123;</span><br><span class="line">    <span class="comment">//è¿™é‡ŒåŠ ä¸Šäº†volatileå…³é”®å­—</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> Singleton singleton;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Singleton</span><span class="params">()</span>&#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * ä½¿ç”¨åŒé‡æ£€æŸ¥è§£å†³äº†å•ä¾‹ã€æ€§èƒ½ã€çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œä½†æ˜¯åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ç”±äºJVMåœ¨å®ä¾‹åŒ–å¯¹è±¡çš„æ—¶å€™ä¼šè¿›è¡Œ</span></span><br><span class="line"><span class="comment">         * ä¼˜åŒ–å’ŒæŒ‡ä»¤çš„é‡æ’åºæ“ä½œï¼Œå¯èƒ½ä¼šå¯¼è‡´ç©ºæŒ‡é’ˆå¼‚å¸¸é—®é¢˜ï¼Œè¿™æ—¶å€™éœ€è¦ä½¿ç”¨volatileå…³é”®å­—ï¼Œå¯ä»¥ä¿è¯å¯è§æ€§</span></span><br><span class="line"><span class="comment">         * å’Œæœ‰åºæ€§</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="comment">// çº¿ç¨‹Aå’Œçº¿ç¨‹BåŒæ—¶çœ‹åˆ°singleton = nullï¼Œå¦‚æœä¸ä¸ºnullï¼Œåˆ™ç›´æ¥è¿”å›singleton</span></span><br><span class="line">        <span class="keyword">if</span> (singleton == <span class="literal">null</span>) &#123;  </span><br><span class="line">            <span class="comment">// çº¿ç¨‹Aæˆ–çº¿ç¨‹Bè·å¾—è¯¥é”è¿›è¡Œåˆå§‹åŒ–</span></span><br><span class="line">            <span class="keyword">synchronized</span>(Singleton.class) &#123; </span><br><span class="line">                <span class="comment">// å…¶ä¸­ä¸€ä¸ªçº¿ç¨‹è¿›å…¥è¯¥åˆ†æ”¯ï¼Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹åˆ™ä¸ä¼šè¿›å…¥è¯¥åˆ†æ”¯</span></span><br><span class="line">                <span class="keyword">if</span> (singleton == <span class="literal">null</span>) &#123; </span><br><span class="line">                    singleton = <span class="keyword">new</span> <span class="title class_">Singleton</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> singleton;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é™¤äº†ä»¥ä¸Šçš„æ‡’æ±‰ï¼Œè¿˜æœ‰ä¸€ç§é™æ€å†…éƒ¨ç±»å®ç°æ‡’æ±‰çš„æ–¹å¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ‡’æ±‰å¼æ–¹å¼4ï¼Œé™æ€å†…éƒ¨ç±»æ–¹å¼</span></span><br><span class="line"><span class="comment"> * é™æ€å†…éƒ¨ç±»å•ä¾‹æ¨¡å¼ä¸­å®ä¾‹ç”±å†…éƒ¨ç±»åˆ›å»ºï¼Œç”±äºJVMåœ¨åŠ è½½å¤–éƒ¨å†…çš„è¿‡ç¨‹ä¸­ï¼Œæ˜¯ä¸ä¼šåŠ è½½é™æ€å†…éƒ¨ç±»çš„ï¼Œåªæœ‰å†…éƒ¨ç±» çš„å±æ€§æˆ–è€…æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œæ‰ä¼šè¢«åŠ è½½ï¼Œå¹¶åˆå§‹åŒ–å…¶é™æ€å±æ€§ã€‚é™æ€å±æ€§ç”±äºè¢«staticä¿®é¥°ï¼Œæ‰€ä»¥åªä¼šè¢«å®ä¾‹åŒ–ä¸€æ¬¡ï¼Œ å¹¶ä¸”ä¸¥æ ¼ä¿è¯å®ä¾‹åŒ–é¡ºåº</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Singleton5</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç§æœ‰åŒ–æ„é€ å™¨</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Singleton5</span><span class="params">()</span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®šä¹‰é™æ€å†…éƒ¨ç±»ï¼Œç§æœ‰åŒ–å±æ€§</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">SingletonHolder</span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Singleton5</span> <span class="variable">INSTANCE</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Singleton5</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Singleton5 <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> SingletonHolder.INSTANCE;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-1-3-3-æšä¸¾å¼"><a href="#3-1-3-3-æšä¸¾å¼" class="headerlink" title="3.1.3.3 æšä¸¾å¼"></a>3.1.3.3 æšä¸¾å¼</h4><p>æ‡’æ±‰å’Œé¥¿æ±‰çš„å•ä¾‹æ˜¯å¯ä»¥è¢«ç ´åçš„ï¼š</p><ol><li>åˆ©ç”¨åå°„<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="comment">// è·å–ç±»çš„æ˜¾å¼æ„é€ å™¨</span></span><br><span class="line">    Constructor&lt;Singleton&gt; construct = Singleton.class.getDeclaredConstructor();</span><br><span class="line">    <span class="comment">// å¯è®¿é—®ç§æœ‰æ„é€ å™¨</span></span><br><span class="line">    construct.setAccessible(<span class="literal">true</span>); </span><br><span class="line">    <span class="comment">// åˆ©ç”¨åå°„æ„é€ æ–°å¯¹è±¡</span></span><br><span class="line">    <span class="type">Singleton</span> <span class="variable">obj1</span> <span class="operator">=</span> construct.newInstance(); </span><br><span class="line">    <span class="comment">// é€šè¿‡æ­£å¸¸æ–¹å¼è·å–å•ä¾‹å¯¹è±¡</span></span><br><span class="line">    <span class="type">Singleton</span> <span class="variable">obj2</span> <span class="operator">=</span> Singleton.getInstance(); </span><br><span class="line">    System.out.println(obj1 == obj2); <span class="comment">// false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>åˆ©ç”¨åºåˆ—åŒ–ä¸ååºåˆ—åŒ–<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="comment">// åˆ›å»ºè¾“å‡ºæµ</span></span><br><span class="line">    <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;Singleton.file&quot;</span>));</span><br><span class="line">    <span class="comment">// å°†å•ä¾‹å¯¹è±¡å†™åˆ°æ–‡ä»¶ä¸­</span></span><br><span class="line">    oos.writeObject(Singleton.getInstance());</span><br><span class="line">    <span class="comment">// ä»æ–‡ä»¶ä¸­è¯»å–å•ä¾‹å¯¹è±¡</span></span><br><span class="line">    <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;Singleton.file&quot;</span>);</span><br><span class="line">    <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span>  <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(file));</span><br><span class="line">    <span class="type">Singleton</span> <span class="variable">newInstance</span> <span class="operator">=</span> (Singleton) ois.readObject();</span><br><span class="line">    <span class="comment">// åˆ¤æ–­æ˜¯å¦æ˜¯åŒä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">    System.out.println(newInstance == Singleton.getInstance()); <span class="comment">// false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p>ä¸ºäº†è§£å†³ä¸Šé¢ä¸¤ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä¸¤ä¸ªæ–¹æ³•ï¼š</p><ol><li><p>æ„é€ æ–¹æ³•ä¸­å¢åŠ åˆ¤æ–­ï¼Œè§£å†³åå°„ç ´åå•ä¾‹çš„æƒ…å†µ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Singleton5</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç§æœ‰åŒ–æ„é€ å™¨</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åœ¨æ„é€ æ–¹æ³•ä¸­å¢åŠ åˆ¤æ–­ï¼Œè§£å†³åå°„ç ´åå•ä¾‹çš„æƒ…å†µ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Singleton5</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">synchronized</span>(Singleton5.class)&#123;</span><br><span class="line">            <span class="keyword">if</span>(flag)&#123;</span><br><span class="line">                <span class="comment">//åˆ¤æ–­flagçš„å€¼ï¼Œå¦‚æœæ˜¯trueï¼Œè¯´æ˜æ˜¯ç¬¬ä¸€æ¬¡è®¿é—®ï¼Œå¦‚æœä¸æ˜¯ï¼Œè¯´æ˜æ˜¯ç¬¬ä¸€æ¬¡è®¿é—®ã€‚</span></span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;ä¸èƒ½åˆ›å»ºä¸¤ä¸ªå¯¹è±¡&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//å°†flagçš„å€¼è®¾ç½®ä¸ºtrue</span></span><br><span class="line">            flag = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">SingletonHolder</span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Singleton5</span> <span class="variable">INSTANCE</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Singleton5</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Singleton5 <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> SingletonHolder.INSTANCE;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æšä¸¾ç±»å®ç°å•ä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ï¼ˆ1ï¼‰Enum ç±»å†…éƒ¨ä½¿ç”¨Enum ç±»å‹åˆ¤å®šé˜²æ­¢é€šè¿‡åå°„åˆ›å»ºå¤šä¸ªå¯¹è±¡</span></span><br><span class="line"><span class="comment"> * ï¼ˆ2ï¼‰Enum ç±»é€šè¿‡å†™å‡ºï¼ˆè¯»å…¥ï¼‰å¯¹è±¡ç±»å‹å’Œæšä¸¾åå­—å°†å¯¹è±¡åºåˆ—åŒ–ï¼ˆååºåˆ—åŒ–ï¼‰ï¼Œé€šè¿‡ valueOf() æ–¹æ³•åŒ¹é…æšä¸¾åæ‰¾åˆ°å†…å­˜ä¸­çš„å”¯ä¸€çš„å¯¹è±¡å®ä¾‹ï¼Œé˜²æ­¢é€šè¿‡ååºåˆ—åŒ–æ„é€ å¤šä¸ªå¯¹è±¡</span></span><br><span class="line"><span class="comment"> * ï¼ˆ3ï¼‰æšä¸¾ç±»ä¸éœ€è¦å…³æ³¨çº¿ç¨‹å®‰å…¨ã€ç ´åå•ä¾‹å’Œæ€§èƒ½é—®é¢˜ï¼Œå› ä¸ºå…¶åˆ›å»ºå¯¹è±¡çš„æ—¶æœºä¸é¥¿æ±‰å¼å•ä¾‹æœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">Singleton</span> &#123;</span><br><span class="line">    INSTANCE(<span class="number">123</span>, <span class="string">&quot;ABC&quot;</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"> </span><br><span class="line">    Singleton(Integer id, String name) &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(Integer id)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">Singleton</span> <span class="variable">t1</span> <span class="operator">=</span> Singleton.INSTANCE;</span><br><span class="line">    t1.setName(<span class="string">&quot;DEF&quot;</span>);</span><br><span class="line">    <span class="type">Singleton</span> <span class="variable">t2</span> <span class="operator">=</span> Singleton.INSTANCE;</span><br><span class="line">    t2.setName(<span class="string">&quot;XYZ&quot;</span>);</span><br><span class="line">    System.out.println(t1);</span><br><span class="line">    System.out.println(t2);</span><br><span class="line">    System.out.print(t1 == t2);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    ç»“æœï¼š</span></span><br><span class="line"><span class="comment">        Singleton&#123;id=123,name=&#x27;XYZ&#x27;&#125;</span></span><br><span class="line"><span class="comment">        Singleton&#123;id=123,name=&#x27;XYZ&#x27;&#125;</span></span><br><span class="line"><span class="comment">        true</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h3 id="3-1-4-å»ºé€ è€…æ¨¡å¼"><a href="#3-1-4-å»ºé€ è€…æ¨¡å¼" class="headerlink" title="3.1.4 å»ºé€ è€…æ¨¡å¼"></a>3.1.4 å»ºé€ è€…æ¨¡å¼</h3><p><strong>å°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„å»ºä¸è¡¨ç¤ºåˆ†ç¦»ï¼Œä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤ºã€‚</strong></p><p><strong>å»ºé€ è€…æ¨¡å¼çš„å„ä¸ªè§’è‰²ï¼š</strong></p><ul><li><strong>æŠ½è±¡å»ºé€ è€…ç±»ï¼ˆBuilderï¼‰</strong>ï¼šè¿™ä¸ªæ¥å£è§„å®šè¦å®ç°å¤æ‚å¯¹è±¡çš„é‚£äº›éƒ¨åˆ†çš„åˆ›å»ºï¼Œå¹¶ä¸æ¶‰åŠå…·ä½“çš„éƒ¨ä»¶å¯¹è±¡çš„åˆ›å»ºã€‚</li><li><strong>å…·ä½“å»ºé€ è€…ç±»ï¼ˆConcreteBuilderï¼‰</strong>ï¼šå®ç° Builder æ¥å£ï¼Œå®Œæˆå¤æ‚äº§å“çš„å„ä¸ªéƒ¨ä»¶çš„å…·ä½“åˆ›å»ºæ–¹æ³•ã€‚åœ¨æ„é€ è¿‡ç¨‹å®Œæˆåï¼Œæä¾›äº§å“çš„å®ä¾‹ã€‚</li><li><strong>äº§å“ç±»ï¼ˆProductï¼‰</strong>ï¼šè¦åˆ›å»ºçš„å¤æ‚å¯¹è±¡ã€‚</li><li><strong>æŒ‡æŒ¥è€…ç±»ï¼ˆDirectorï¼‰</strong>ï¼šè°ƒç”¨å…·ä½“å»ºé€ è€…æ¥åˆ›å»ºå¤æ‚å¯¹è±¡çš„å„ä¸ªéƒ¨åˆ†ï¼Œåœ¨æŒ‡å¯¼è€…ä¸­ä¸æ¶‰åŠå…·ä½“äº§å“çš„ä¿¡æ¯ï¼Œåªè´Ÿè´£ä¿è¯å¯¹è±¡å„éƒ¨åˆ†å®Œæ•´åˆ›å»ºæˆ–æŒ‰æŸç§é¡ºåºåˆ›å»ºã€‚</li></ul><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F.png" class="" title="å»ºé€ è€…æ¨¡å¼"><p><strong>åº”ç”¨åœºæ™¯ï¼š</strong><br>å»ºé€ è€…ï¼ˆBuilderï¼‰æ¨¡å¼åˆ›å»ºçš„æ˜¯å¤æ‚å¯¹è±¡ï¼Œå…¶äº§å“çš„å„ä¸ªéƒ¨åˆ†ç»å¸¸é¢ä¸´ç€å‰§çƒˆçš„å˜åŒ–ï¼Œä½†å°†å®ƒä»¬ç»„åˆåœ¨ä¸€èµ·çš„ç®—æ³•å´ç›¸å¯¹ç¨³å®šï¼Œæ‰€ä»¥å®ƒé€šå¸¸åœ¨ä»¥ä¸‹åœºåˆä½¿ç”¨ã€‚</p><ul><li>åˆ›å»ºçš„å¯¹è±¡è¾ƒå¤æ‚ï¼Œç”±å¤šä¸ªéƒ¨ä»¶æ„æˆï¼Œå„éƒ¨ä»¶é¢ä¸´ç€å¤æ‚çš„å˜åŒ–ï¼Œä½†æ„ä»¶é—´çš„å»ºé€ é¡ºåºæ˜¯ç¨³å®šçš„ã€‚</li><li>åˆ›å»ºå¤æ‚å¯¹è±¡çš„ç®—æ³•ç‹¬ç«‹äºè¯¥å¯¹è±¡çš„ç»„æˆéƒ¨åˆ†ä»¥åŠå®ƒä»¬çš„è£…é…æ–¹å¼ï¼Œå³äº§å“çš„æ„å»ºè¿‡ç¨‹å’Œæœ€ç»ˆçš„è¡¨ç¤ºæ˜¯ç‹¬ç«‹çš„ã€‚</li></ul><p><strong>ä¾‹å­ï¼š</strong></p><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F-%E4%BE%8B%E5%AD%90.png" class="" title="å»ºé€ è€…æ¨¡å¼-ä¾‹å­"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è‡ªè¡Œè½¦ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Bike</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String frame;</span><br><span class="line">    <span class="keyword">private</span> String seat;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getFrame</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> frame;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setFrame</span><span class="params">(String frame)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.frame = frame;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getSeat</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> seat;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSeat</span><span class="params">(String seat)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.seat = seat;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠ½è±¡ builder ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Builder</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">Bike</span> <span class="variable">mBike</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Bike</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">buildFrame</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">buildSeat</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> Bike <span class="title function_">createBike</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ‘©æ‹œå•è½¦Builderç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MobikeBuilder</span> <span class="keyword">extends</span> <span class="title class_">Builder</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">buildFrame</span><span class="params">()</span> &#123;</span><br><span class="line">        mBike.setFrame(<span class="string">&quot;é“åˆé‡‘è½¦æ¶&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">buildSeat</span><span class="params">()</span> &#123;</span><br><span class="line">        mBike.setSeat(<span class="string">&quot;çœŸçš®è½¦åº§&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Bike <span class="title function_">createBike</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> mBike;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ofoå•è½¦Builderç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OfoBuilder</span> <span class="keyword">extends</span> <span class="title class_">Builder</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">buildFrame</span><span class="params">()</span> &#123;</span><br><span class="line">        mBike.setFrame(<span class="string">&quot;ç¢³çº¤ç»´è½¦æ¶&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">buildSeat</span><span class="params">()</span> &#123;</span><br><span class="line">        mBike.setSeat(<span class="string">&quot;æ©¡èƒ¶è½¦åº§&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Bike <span class="title function_">createBike</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> mBike;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŒ‡æŒ¥è€…ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Director</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Builder mBuilder;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Director</span><span class="params">(Builder builder)</span> &#123;</span><br><span class="line">        mBuilder = builder;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Bike <span class="title function_">construct</span><span class="params">()</span> &#123;</span><br><span class="line">        mBuilder.buildFrame();</span><br><span class="line">        mBuilder.buildSeat();</span><br><span class="line">        <span class="keyword">return</span> mBuilder.createBike();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        showBike(<span class="keyword">new</span> <span class="title class_">OfoBuilder</span>());</span><br><span class="line">        showBike(<span class="keyword">new</span> <span class="title class_">MobikeBuilder</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">showBike</span><span class="params">(Builder builder)</span> &#123;</span><br><span class="line">        <span class="type">Director</span> <span class="variable">director</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Director</span>(builder);</span><br><span class="line">        <span class="type">Bike</span> <span class="variable">bike</span> <span class="operator">=</span> director.construct();</span><br><span class="line">        System.out.println(bike.getFrame());</span><br><span class="line">        System.out.println(bike.getSeat());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>ä¼˜ç¼ºç‚¹ï¼š</strong></p><blockquote><p><strong>ä¼˜ï¼š</strong></p></blockquote><ul><li>å»ºé€ è€…æ¨¡å¼çš„å°è£…æ€§å¾ˆå¥½ã€‚ä½¿ç”¨å»ºé€ è€…æ¨¡å¼å¯ä»¥æœ‰æ•ˆçš„å°è£…å˜åŒ–ï¼Œåœ¨ä½¿ç”¨å»ºé€ è€…æ¨¡å¼çš„åœºæ™¯ä¸­ï¼Œä¸€èˆ¬äº§å“ç±»å’Œå»ºé€ è€…ç±»æ˜¯æ¯”è¾ƒç¨³å®šçš„ï¼Œå› æ­¤ï¼Œå°†ä¸»è¦çš„ä¸šåŠ¡é€»è¾‘å°è£…åœ¨æŒ‡æŒ¥è€…ç±»ä¸­å¯¹æ•´ä½“è€Œè¨€å¯ä»¥å–å¾—æ¯”è¾ƒå¥½çš„ç¨³å®šæ€§ã€‚</li><li>åœ¨å»ºé€ è€…æ¨¡å¼ä¸­ï¼Œå®¢æˆ·ç«¯ä¸å¿…çŸ¥é“äº§å“å†…éƒ¨ç»„æˆçš„ç»†èŠ‚ï¼Œå°†äº§å“æœ¬èº«ä¸äº§å“çš„åˆ›å»ºè¿‡ç¨‹è§£è€¦ï¼Œä½¿å¾—ç›¸åŒçš„åˆ›å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„äº§å“å¯¹è±¡ã€‚</li><li>å¯ä»¥æ›´åŠ ç²¾ç»†åœ°æ§åˆ¶äº§å“çš„åˆ›å»ºè¿‡ç¨‹ ã€‚å°†å¤æ‚äº§å“çš„åˆ›å»ºæ­¥éª¤åˆ†è§£åœ¨ä¸åŒçš„æ–¹æ³•ä¸­ï¼Œä½¿å¾—åˆ›å»ºè¿‡ç¨‹æ›´åŠ æ¸…æ™°ï¼Œä¹Ÿæ›´æ–¹ä¾¿ä½¿ç”¨ç¨‹åºæ¥æ§åˆ¶åˆ›å»ºè¿‡ç¨‹ã€‚</li><li>å»ºé€ è€…æ¨¡å¼å¾ˆå®¹æ˜“è¿›è¡Œæ‰©å±•ã€‚å¦‚æœæœ‰æ–°çš„éœ€æ±‚ï¼Œé€šè¿‡å®ç°ä¸€ä¸ªæ–°çš„å»ºé€ è€…ç±»å°±å¯ä»¥å®Œæˆï¼ŒåŸºæœ¬ä¸Šä¸ç”¨ä¿®æ”¹ä¹‹å‰å·²ç»æµ‹è¯•é€šè¿‡çš„ä»£ç ï¼Œå› æ­¤ä¹Ÿå°±ä¸ä¼šå¯¹åŸæœ‰åŠŸèƒ½å¼•å…¥é£é™©ã€‚ç¬¦åˆå¼€é—­åŸåˆ™ã€‚</li></ul><blockquote><p><strong>ç¼ºï¼š</strong></p></blockquote><ul><li>å»ºé€ è€…æ¨¡å¼æ‰€åˆ›å»ºçš„äº§å“ä¸€èˆ¬å…·æœ‰è¾ƒå¤šçš„å…±åŒç‚¹ï¼Œå…¶ç»„æˆéƒ¨åˆ†ç›¸ä¼¼ï¼Œå¦‚æœäº§å“ä¹‹é—´çš„å·®å¼‚æ€§å¾ˆå¤§ï¼Œåˆ™ä¸é€‚åˆä½¿ç”¨å»ºé€ è€…æ¨¡å¼ï¼Œå› æ­¤å…¶ä½¿ç”¨èŒƒå›´å—åˆ°ä¸€å®šçš„é™åˆ¶ã€‚</li></ul><h3 id="3-1-5-åŸå‹æ¨¡å¼"><a href="#3-1-5-åŸå‹æ¨¡å¼" class="headerlink" title="3.1.5 åŸå‹æ¨¡å¼"></a>3.1.5 åŸå‹æ¨¡å¼</h3><blockquote><p>é€šè¿‡å¤åˆ¶ç°æœ‰å®ä¾‹æ¥åˆ›å»ºæ–°çš„å®ä¾‹ï¼Œæ— éœ€çŸ¥é“ç›¸åº”ç±»çš„ä¿¡æ¯ã€‚ç”¨ä¸€ä¸ªå·²ç»åˆ›å»ºçš„å®ä¾‹ä½œä¸ºåŸå‹ï¼Œé€šè¿‡å¤åˆ¶è¯¥åŸå‹å¯¹è±¡æ¥åˆ›å»ºä¸€ä¸ªå’ŒåŸå‹å¯¹è±¡ç›¸åŒçš„æ–°å¯¹è±¡ã€‚ï¼ˆå¤åˆ¶ä¸€ä¸ªä¸€æ¨¡ä¸€æ ·ä½†æ˜¯æ˜¯ä¸€ä¸ªæ–°å¯¹è±¡ï¼‰</p></blockquote><p><strong>è§’è‰²ï¼š</strong></p><ul><li>æŠ½è±¡åŸå‹ç±»ï¼šè§„å®šäº†å…·ä½“åŸå‹å¯¹è±¡å¿…é¡»å®ç°çš„çš„ clone() æ–¹æ³•ã€‚</li><li>å…·ä½“åŸå‹ç±»ï¼šå®ç°æŠ½è±¡åŸå‹ç±»çš„ clone() æ–¹æ³•ï¼Œå®ƒæ˜¯å¯è¢«å¤åˆ¶çš„å¯¹è±¡ã€‚</li><li>è®¿é—®ç±»ï¼šä½¿ç”¨å…·ä½“åŸå‹ç±»ä¸­çš„ clone() æ–¹æ³•æ¥å¤åˆ¶æ–°çš„å¯¹è±¡ã€‚</li></ul><p><strong>æ‹·è´ç±»å‹ï¼š</strong></p><ul><li><p>æµ…å…‹éš†ï¼šåˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œæ–°å¯¹è±¡çš„å±æ€§å’ŒåŸæ¥å¯¹è±¡å®Œå…¨ç›¸åŒï¼Œå¯¹äºéåŸºæœ¬ç±»å‹å±æ€§ï¼Œä»æŒ‡å‘åŸæœ‰å±æ€§æ‰€æŒ‡å‘çš„å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚</p><blockquote><p>Javaä¸­çš„Objectç±»ä¸­æä¾›äº† clone() æ–¹æ³•æ¥å®ç°æµ…å…‹éš†ã€‚ Cloneable æ¥å£æ˜¯ä¸Šé¢çš„ç±»å›¾ä¸­çš„æŠ½è±¡åŸå‹ç±»ï¼Œè€Œå®ç°äº†Cloneableæ¥å£çš„å­å®ç°ç±»å°±æ˜¯å…·ä½“çš„åŸå‹ç±»ã€‚ä»£ç å¦‚ä¸‹ï¼š</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lxg.pattern.prototype.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Realizetype</span> <span class="keyword">implements</span> <span class="title class_">Cloneable</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Realizetype</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å…·ä½“çš„åŸå‹å¯¹è±¡åˆ›å»ºå®Œæˆï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é‡å†™è¶…çº§çˆ¶ç±»Objectæä¾›çš„clone()æ–¹æ³•ï¼Œå®ç°æµ…å…‹éš†</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> CloneNotSupportedException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Realizetype <span class="title function_">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å…·ä½“åŸå‹å¤åˆ¶æˆåŠŸï¼&quot;</span>);</span><br><span class="line">        <span class="comment">// å¯¹è±¡ä¸æ˜¯åŒä¸€ä¸ªï¼Œä½†æ˜¯å¯¹è±¡ä¸­çš„å±æ€§å€¼æ˜¯åŒä¸€ä¸ª</span></span><br><span class="line">        <span class="keyword">return</span> (Realizetype) <span class="built_in">super</span>.clone();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ä½¿ç”¨åœºæ™¯ï¼š</p><ul><li>å¯¹è±¡çš„åˆ›å»ºéå¸¸å¤æ‚ï¼Œå¯ä»¥ä½¿ç”¨åŸå‹æ¨¡å¼å¿«æ·çš„åˆ›å»ºå¯¹è±¡ã€‚</li><li>æ€§èƒ½å’Œå®‰å…¨è¦æ±‚æ¯”è¾ƒé«˜ã€‚</li></ul></blockquote></li><li><p>æ·±å…‹éš†ï¼šåˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå±æ€§ä¸­å¼•ç”¨çš„å…¶ä»–å¯¹è±¡ä¹Ÿä¼šè¢«å…‹éš†ï¼Œä¸å†æŒ‡å‘åŸæœ‰å¯¹è±¡åœ°å€ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">(String name, String address)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.address = address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getAddress</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAddress</span><span class="params">(String address)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.address = address;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Citation</span> <span class="keyword">implements</span> <span class="title class_">Cloneable</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">show</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(name + <span class="string">&quot;åŒå­¦ï¼šåœ¨2020å­¦å¹´ç¬¬ä¸€å­¦æœŸä¸­è¡¨ç°ä¼˜ç§€ï¼Œè¢«è¯„ä¸ºä¸‰å¥½å­¦ç”Ÿã€‚ç‰¹å‘æ­¤çŠ¶ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Citation <span class="title function_">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException &#123;</span><br><span class="line">        <span class="keyword">return</span> (Citation) <span class="built_in">super</span>.clone();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CitationTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> CloneNotSupportedException &#123;</span><br><span class="line">        <span class="type">Citation</span> <span class="variable">c1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Citation</span>();</span><br><span class="line">        <span class="type">Student</span> <span class="variable">stu</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å¼ ä¸‰&quot;</span>, <span class="string">&quot;è¥¿å®‰&quot;</span>);</span><br><span class="line">        c1.setStu(stu);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¤åˆ¶å¥–çŠ¶</span></span><br><span class="line">        <span class="type">Citation</span> <span class="variable">c2</span> <span class="operator">=</span> c1.clone();</span><br><span class="line">        <span class="comment">//è·å–c2å¥–çŠ¶æ‰€å±å­¦ç”Ÿå¯¹è±¡</span></span><br><span class="line">        <span class="type">Student</span> <span class="variable">stu1</span> <span class="operator">=</span> c2.getStu();</span><br><span class="line">        stu1.setName(<span class="string">&quot;æå››&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ¤æ–­stuå¯¹è±¡å’Œstu1å¯¹è±¡æ˜¯å¦æ˜¯åŒä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">        System.out.println(<span class="string">&quot;stuå’Œstu1æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Ÿ&quot;</span> + (stu == stu1));</span><br><span class="line"></span><br><span class="line">        c1.show();</span><br><span class="line">        c2.show();</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            stuå’Œstu1æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Ÿtrue</span></span><br><span class="line"><span class="comment">            æå››åŒå­¦ï¼šåœ¨2020å­¦å¹´ç¬¬ä¸€å­¦æœŸä¸­è¡¨ç°ä¼˜ç§€ï¼Œè¢«è¯„ä¸ºä¸‰å¥½å­¦ç”Ÿã€‚ç‰¹å‘æ­¤çŠ¶ï¼</span></span><br><span class="line"><span class="comment">            æå››åŒå­¦ï¼šåœ¨2020å­¦å¹´ç¬¬ä¸€å­¦æœŸä¸­è¡¨ç°ä¼˜ç§€ï¼Œè¢«è¯„ä¸ºä¸‰å¥½å­¦ç”Ÿã€‚ç‰¹å‘æ­¤çŠ¶ï¼</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">/*</span></span><br><span class="line"><span class="comment">       è¿è¡Œç»“æœè¡¨æ˜ï¼Œä½¿ç”¨Objectæä¾›çš„clone()æ–¹æ³•å®ç°çš„æ˜¯å¯¹è±¡çš„æµ…å…‹éš†</span></span><br><span class="line"><span class="comment">        stuå¯¹è±¡å’Œstu1å¯¹è±¡æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œå°±ä¼šäº§ç”Ÿå°†stu1å¯¹è±¡ä¸­nameå±æ€§å€¼æ”¹ä¸ºâ€œæå››â€ï¼Œä¸¤ä¸ªCitationï¼ˆå¥–çŠ¶ï¼‰å¯¹è±¡ä¸­æ˜¾ç¤ºçš„éƒ½æ˜¯æå››ã€‚è¿™å°±æ˜¯æµ…å…‹éš†çš„æ•ˆæœï¼Œå¯¹å…·ä½“åŸå‹ç±»ï¼ˆCitationï¼‰ä¸­çš„å¼•ç”¨ç±»å‹çš„å±æ€§è¿›è¡Œå¼•ç”¨çš„å¤åˆ¶ã€‚è¿™ç§æƒ…å†µéœ€è¦ä½¿ç”¨æ·±å…‹éš†ï¼Œè€Œè¿›è¡Œæ·±å…‹éš†éœ€è¦ä½¿ç”¨å¯¹è±¡æµã€‚ä»£ç å¦‚ä¸‹é¢çš„main</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Citationç±»å’ŒStudentç±»å¿…é¡»å®ç°Serializableæ¥å£ï¼Œå¦åˆ™ä¼šæŠ›NotSerializableExceptionå¼‚å¸¸ã€‚</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException &#123;</span><br><span class="line">        <span class="type">Citation</span> <span class="variable">c1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Citation</span>();</span><br><span class="line">        <span class="type">Student</span> <span class="variable">stu1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å¼ ä¸‰&quot;</span>,<span class="string">&quot;åŒ—äº¬&quot;</span>);</span><br><span class="line">        c1.setStu(stu1);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºå¯¹è±¡è¾“å‡ºæµå¯¹è±¡</span></span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;a.txt&quot;</span>));</span><br><span class="line">        <span class="comment">//å°†c1å¯¹è±¡å†™å‡ºåˆ°æ–‡ä»¶ä¸­</span></span><br><span class="line">        oos.writeObject(c1);</span><br><span class="line">        oos.close();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºå¯¹è±¡å‡ºå…¥æµå¯¹è±¡</span></span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;a.txt&quot;</span>));</span><br><span class="line">        <span class="comment">//è¯»å–å¯¹è±¡</span></span><br><span class="line">        <span class="type">Citation</span> <span class="variable">c2</span> <span class="operator">=</span> (Citation) ois.readObject();</span><br><span class="line">        <span class="comment">//ä»c2è·å–studentå¯¹è±¡</span></span><br><span class="line">        <span class="type">Student</span> <span class="variable">stu2</span> <span class="operator">=</span> c2.getStu();</span><br><span class="line">        stu2.setName(<span class="string">&quot;æå››&quot;</span>);</span><br><span class="line">        ois.close();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ¤æ–­stuå¯¹è±¡å’Œstu1å¯¹è±¡æ˜¯å¦æ˜¯åŒä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">        System.out.println(<span class="string">&quot;stu1å’Œstu2æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Ÿ&quot;</span>+(stu1==stu2));</span><br><span class="line">        </span><br><span class="line">        c1.show();</span><br><span class="line">        c2.show();</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            stu1å’Œstu2æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Ÿfalse</span></span><br><span class="line"><span class="comment">            å¼ ä¸‰åŒå­¦ï¼šåœ¨2020å­¦å¹´ç¬¬ä¸€å­¦æœŸä¸­è¡¨ç°ä¼˜ç§€ï¼Œè¢«è¯„ä¸ºä¸‰å¥½å­¦ç”Ÿã€‚ç‰¹å‘æ­¤çŠ¶ï¼</span></span><br><span class="line"><span class="comment">            æå››åŒå­¦ï¼šåœ¨2020å­¦å¹´ç¬¬ä¸€å­¦æœŸä¸­è¡¨ç°ä¼˜ç§€ï¼Œè¢«è¯„ä¸ºä¸‰å¥½å­¦ç”Ÿã€‚ç‰¹å‘æ­¤çŠ¶ï¼</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ä½¿ç”¨åœºæ™¯ï¼š</p><ul><li>å¯¹è±¡çš„åˆ›å»ºéå¸¸å¤æ‚ï¼Œå¯ä»¥ä½¿ç”¨åŸå‹æ¨¡å¼å¿«æ·çš„åˆ›å»ºå¯¹è±¡ã€‚</li><li>æ€§èƒ½å’Œå®‰å…¨è¦æ±‚æ¯”è¾ƒé«˜ã€‚</li></ul></blockquote></li></ul><h2 id="3-2-ç»“æ„å‹æ¨¡å¼"><a href="#3-2-ç»“æ„å‹æ¨¡å¼" class="headerlink" title="3.2 ç»“æ„å‹æ¨¡å¼"></a><em>3.2 ç»“æ„å‹æ¨¡å¼</em></h2><hr><h3 id="3-2-1-é€‚é…å™¨æ¨¡å¼"><a href="#3-2-1-é€‚é…å™¨æ¨¡å¼" class="headerlink" title="3.2.1 é€‚é…å™¨æ¨¡å¼"></a>3.2.1 é€‚é…å™¨æ¨¡å¼</h3><blockquote><p>é€‚é…å™¨ï¼Œå¹³å¸¸ç”Ÿæ´»ä¸­æœ€å¸¸è§çš„å°±æ˜¯è½¬æ¥å£<br><strong>å®šä¹‰ï¼š</strong><br>å°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆ<strong>å®¢æˆ·å¸Œæœ›çš„å¦å¤–ä¸€ä¸ªæ¥å£</strong>ï¼Œä½¿å¾—åŸæœ¬ç”±äºæ¥å£<strong>ä¸å…¼å®¹è€Œä¸èƒ½ä¸€èµ·å·¥ä½œ</strong>çš„é‚£äº›ç±»<strong>èƒ½ä¸€èµ·å·¥ä½œ</strong>ã€‚</p></blockquote><blockquote><p><strong>è§’è‰²ï¼š</strong></p><ul><li><strong>ç›®æ ‡ï¼ˆTargetï¼‰æ¥å£ï¼š</strong>å½“å‰ç³»ç»Ÿä¸šåŠ¡æ‰€æœŸå¾…çš„æ¥å£ï¼Œå®ƒå¯ä»¥æ˜¯æŠ½è±¡ç±»æˆ–æ¥å£ã€‚</li><li><strong>é€‚é…è€…ï¼ˆAdapteeï¼‰ç±»ï¼š</strong>å®ƒæ˜¯è¢«è®¿é—®å’Œé€‚é…çš„ç°å­˜ç»„ä»¶åº“ä¸­çš„ç»„ä»¶æ¥å£ã€‚</li><li><strong>é€‚é…å™¨ï¼ˆAdapterï¼‰ç±»ï¼š</strong>å®ƒæ˜¯ä¸€ä¸ªè½¬æ¢å™¨ï¼Œé€šè¿‡ç»§æ‰¿æˆ–å¼•ç”¨é€‚é…è€…çš„å¯¹è±¡ï¼ŒæŠŠé€‚é…è€…æ¥å£è½¬æ¢æˆç›®æ ‡æ¥å£ï¼Œè®©å®¢æˆ·æŒ‰ç›®æ ‡æ¥å£çš„æ ¼å¼è®¿é—®é€‚é…è€…ã€‚</li></ul></blockquote><p><strong>ç±»é€‚é…å™¨ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//SDå¡çš„æ¥å£</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SDCard</span> &#123;</span><br><span class="line">    <span class="comment">//è¯»å–SDå¡æ–¹æ³•</span></span><br><span class="line">    String <span class="title function_">readSD</span><span class="params">()</span>;</span><br><span class="line">    <span class="comment">//å†™å…¥SDå¡åŠŸèƒ½</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">writeSD</span><span class="params">(String msg)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//SDå¡å®ç°ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SDCardImpl</span> <span class="keyword">implements</span> <span class="title class_">SDCard</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">readSD</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">msg</span> <span class="operator">=</span> <span class="string">&quot;sd card read a msg :hello word SD&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> msg;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">writeSD</span><span class="params">(String msg)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;sd card write msg : &quot;</span> + msg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç”µè„‘ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Computer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">readSD</span><span class="params">(SDCard sdCard)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(sdCard == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NullPointerException</span>(<span class="string">&quot;sd card null&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sdCard.readSD();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//TFå¡æ¥å£</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">TFCard</span> &#123;</span><br><span class="line">    <span class="comment">//è¯»å–TFå¡æ–¹æ³•</span></span><br><span class="line">    String <span class="title function_">readTF</span><span class="params">()</span>;</span><br><span class="line">    <span class="comment">//å†™å…¥TFå¡åŠŸèƒ½</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">writeTF</span><span class="params">(String msg)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//TFå¡å®ç°ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TFCardImpl</span> <span class="keyword">implements</span> <span class="title class_">TFCard</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">readTF</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">msg</span> <span class="operator">=</span><span class="string">&quot;tf card read msg : hello word tf card&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> msg;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">writeTF</span><span class="params">(String msg)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;tf card write a msg : &quot;</span> + msg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰é€‚é…å™¨ç±»ï¼ˆSDå…¼å®¹TFï¼‰</span></span><br><span class="line"><span class="comment">// å®ç°æ–¹å¼ï¼šå®šä¹‰ä¸€ä¸ªé€‚é…å™¨ç±»æ¥å®ç°å½“å‰ç³»ç»Ÿçš„ä¸šåŠ¡æ¥å£ï¼ŒåŒæ—¶åˆç»§æ‰¿ç°æœ‰ç»„ä»¶åº“ä¸­å·²ç»å­˜åœ¨çš„ç»„ä»¶ã€‚</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SDAdapterTF</span> <span class="keyword">extends</span> <span class="title class_">TFCardImpl</span> <span class="keyword">implements</span> <span class="title class_">SDCard</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">readSD</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;adapter read tf card &quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> readTF();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">writeSD</span><span class="params">(String msg)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;adapter write tf card&quot;</span>);</span><br><span class="line">        writeTF(msg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Computer</span> <span class="variable">computer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Computer</span>();</span><br><span class="line">        <span class="type">SDCard</span> <span class="variable">sdCard</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SDCardImpl</span>();</span><br><span class="line">        System.out.println(computer.readSD(sdCard));</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">SDAdapterTF</span> <span class="variable">adapter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SDAdapterTF</span>();</span><br><span class="line">        System.out.println(computer.readSD(adapter));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ç±»é€‚é…å™¨æ¨¡å¼è¿èƒŒäº†åˆæˆå¤ç”¨åŸåˆ™ã€‚ç±»é€‚é…å™¨æ˜¯å®¢æˆ·ç±»æœ‰ä¸€ä¸ªæ¥å£è§„èŒƒçš„æƒ…å†µä¸‹å¯ç”¨ï¼Œåä¹‹ä¸å¯ç”¨ã€‚</span></span><br></pre></td></tr></table></figure><p><strong>å¯¹è±¡é€‚é…å™¨æ¨¡å¼</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨ç±»é€‚é…å™¨çš„åŸºç¡€ä¸Šä¿®æ”¹é€‚é…å™¨ç±»å’Œæµ‹è¯•ç±»ã€‚</span></span><br><span class="line"><span class="comment">// åˆ›å»ºé€‚é…å™¨å¯¹è±¡ï¼ˆSDå…¼å®¹TFï¼‰</span></span><br><span class="line"><span class="comment">// å¯¹è±¡é€‚é…å™¨æ¨¡å¼å¯é‡†ç”¨å°†ç°æœ‰ç»„ä»¶åº“ä¸­å·²ç»å®ç°çš„ç»„ä»¶å¼•å…¥é€‚é…å™¨ç±»ä¸­ï¼Œè¯¥ç±»åŒæ—¶å®ç°å½“å‰ç³»ç»Ÿçš„ä¸šåŠ¡æ¥å£ã€‚</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SDAdapterTF</span>  <span class="keyword">implements</span> <span class="title class_">SDCard</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> TFCard tfCard;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">SDAdapterTF</span><span class="params">(TFCard tfCard)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.tfCard = tfCard;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">readSD</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;adapter read tf card &quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> tfCard.readTF();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">writeSD</span><span class="params">(String msg)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;adapter write tf card&quot;</span>);</span><br><span class="line">        tfCard.writeTF(msg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Computer</span> <span class="variable">computer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Computer</span>();</span><br><span class="line">        <span class="type">SDCard</span> <span class="variable">sdCard</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SDCardImpl</span>();</span><br><span class="line">        System.out.println(computer.readSD(sdCard));</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">TFCard</span> <span class="variable">tfCard</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TFCardImpl</span>();</span><br><span class="line">        <span class="type">SDAdapterTF</span> <span class="variable">adapter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SDAdapterTF</span>(tfCard);</span><br><span class="line">        System.out.println(computer.readSD(adapter));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><strong>é€‚ç”¨æƒ…å†µï¼š</strong></p><ul><li>ä»¥å‰å¼€å‘çš„ç³»ç»Ÿå­˜åœ¨æ»¡è¶³æ–°ç³»ç»ŸåŠŸèƒ½éœ€æ±‚çš„ç±»ï¼Œä½†å…¶æ¥å£åŒæ–°ç³»ç»Ÿçš„æ¥å£ä¸ä¸€è‡´ã€‚</li><li>ä½¿ç”¨ç¬¬ä¸‰æ–¹æä¾›çš„ç»„ä»¶ï¼Œä½†ç»„ä»¶æ¥å£å®šä¹‰å’Œè‡ªå·±è¦æ±‚çš„æ¥å£å®šä¹‰ä¸åŒã€‚</li></ul></blockquote><h3 id="3-3-2-è£…é¥°å™¨æ¨¡å¼"><a href="#3-3-2-è£…é¥°å™¨æ¨¡å¼" class="headerlink" title="3.3.2 è£…é¥°å™¨æ¨¡å¼"></a>3.3.2 è£…é¥°å™¨æ¨¡å¼</h3><p><strong>ç»“æ„ï¼š</strong></p><blockquote><p><strong>æŠ½è±¡æ„ä»¶ï¼ˆComponentï¼‰è§’è‰²ï¼š</strong>å®šä¹‰ä¸€ä¸ªæŠ½è±¡æ¥å£ä»¥è§„èŒƒå‡†å¤‡æ¥æ”¶é™„åŠ è´£ä»»çš„å¯¹è±¡ã€‚<br><strong>å…·ä½“æ„ä»¶ï¼ˆConcrete Componentï¼‰è§’è‰²ï¼š</strong>å®ç°æŠ½è±¡æ„ä»¶ï¼Œé€šè¿‡è£…é¥°è§’è‰²ä¸ºå…¶æ·»åŠ ä¸€äº›èŒè´£ã€‚<br><strong>æŠ½è±¡è£…é¥°ï¼ˆDecoratorï¼‰è§’è‰²ï¼š</strong>ç»§æ‰¿æˆ–å®ç°æŠ½è±¡æ„ä»¶ï¼Œå¹¶åŒ…å«å…·ä½“æ„ä»¶çš„å®ä¾‹ï¼Œå¯ä»¥é€šè¿‡å…¶å­ç±»æ‰©å±•å…·ä½“æ„ä»¶çš„åŠŸèƒ½ã€‚<br><strong>å…·ä½“è£…é¥°ï¼ˆConcreteDecoratorï¼‰è§’è‰²ï¼š</strong>å®ç°æŠ½è±¡è£…é¥°çš„ç›¸å…³æ–¹æ³•ï¼Œå¹¶ç»™å…·ä½“æ„ä»¶å¯¹è±¡æ·»åŠ é™„åŠ çš„è´£ä»»ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å¿«é¤æ¥å£</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">FastFood</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">float</span> price;</span><br><span class="line">    <span class="keyword">private</span> String desc;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">FastFood</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">FastFood</span><span class="params">(<span class="type">float</span> price, String desc)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.price = price;</span><br><span class="line">        <span class="built_in">this</span>.desc = desc;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPrice</span><span class="params">(<span class="type">float</span> price)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">float</span> <span class="title function_">getPrice</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getDesc</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> desc;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDesc</span><span class="params">(String desc)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.desc = desc;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="type">float</span> <span class="title function_">cost</span><span class="params">()</span>;  <span class="comment">//è·å–ä»·æ ¼</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç‚’é¥­</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FriedRice</span> <span class="keyword">extends</span> <span class="title class_">FastFood</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">FriedRice</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(<span class="number">10</span>, <span class="string">&quot;ç‚’é¥­&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">float</span> <span class="title function_">cost</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> getPrice();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç‚’é¢</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FriedNoodles</span> <span class="keyword">extends</span> <span class="title class_">FastFood</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">FriedNoodles</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(<span class="number">12</span>, <span class="string">&quot;ç‚’é¢&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">float</span> <span class="title function_">cost</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> getPrice();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//é…æ–™ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Garnish</span> <span class="keyword">extends</span> <span class="title class_">FastFood</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> FastFood fastFood;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> FastFood <span class="title function_">getFastFood</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> fastFood;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setFastFood</span><span class="params">(FastFood fastFood)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.fastFood = fastFood;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Garnish</span><span class="params">(FastFood fastFood, <span class="type">float</span> price, String desc)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(price,desc);</span><br><span class="line">        <span class="built_in">this</span>.fastFood = fastFood;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//é¸¡è›‹é…æ–™</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Egg</span> <span class="keyword">extends</span> <span class="title class_">Garnish</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Egg</span><span class="params">(FastFood fastFood)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(fastFood,<span class="number">1</span>,<span class="string">&quot;é¸¡è›‹&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">float</span> <span class="title function_">cost</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> getPrice() + getFastFood().getPrice();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getDesc</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.getDesc() + getFastFood().getDesc();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åŸ¹æ ¹é…æ–™</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Bacon</span> <span class="keyword">extends</span> <span class="title class_">Garnish</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Bacon</span><span class="params">(FastFood fastFood)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">super</span>(fastFood,<span class="number">2</span>,<span class="string">&quot;åŸ¹æ ¹&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">float</span> <span class="title function_">cost</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> getPrice() + getFastFood().getPrice();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getDesc</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.getDesc() + getFastFood().getDesc();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//ç‚¹ä¸€ä»½ç‚’é¥­</span></span><br><span class="line">        <span class="type">FastFood</span> <span class="variable">food</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FriedRice</span>();</span><br><span class="line">        <span class="comment">//èŠ±è´¹çš„ä»·æ ¼</span></span><br><span class="line">        System.out.println(food.getDesc() + <span class="string">&quot; &quot;</span> + food.cost() + <span class="string">&quot;å…ƒ&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;========&quot;</span>);</span><br><span class="line">        <span class="comment">//ç‚¹ä¸€ä»½åŠ é¸¡è›‹çš„ç‚’é¥­</span></span><br><span class="line">        <span class="type">FastFood</span> <span class="variable">food1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FriedRice</span>();</span><br><span class="line"></span><br><span class="line">        food1 = <span class="keyword">new</span> <span class="title class_">Egg</span>(food1);</span><br><span class="line">        <span class="comment">//èŠ±è´¹çš„ä»·æ ¼</span></span><br><span class="line">        System.out.println(food1.getDesc() + <span class="string">&quot; &quot;</span> + food1.cost() + <span class="string">&quot;å…ƒ&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;========&quot;</span>);</span><br><span class="line">        <span class="comment">//ç‚¹ä¸€ä»½åŠ åŸ¹æ ¹çš„ç‚’é¢</span></span><br><span class="line">        <span class="type">FastFood</span> <span class="variable">food2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FriedNoodles</span>();</span><br><span class="line">        food2 = <span class="keyword">new</span> <span class="title class_">Bacon</span>(food2);</span><br><span class="line">        <span class="comment">//èŠ±è´¹çš„ä»·æ ¼</span></span><br><span class="line">        System.out.println(food2.getDesc() + <span class="string">&quot; &quot;</span> + food2.cost() + <span class="string">&quot;å…ƒ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p><blockquote><ul><li>å½“ä¸èƒ½é‡‡ç”¨ç»§æ‰¿çš„æ–¹å¼å¯¹ç³»ç»Ÿè¿›è¡Œæ‰©å……æˆ–è€…é‡‡ç”¨ç»§æ‰¿ä¸åˆ©äºç³»ç»Ÿæ‰©å±•å’Œç»´æŠ¤æ—¶ã€‚<br>  ä¸èƒ½é‡‡ç”¨ç»§æ‰¿çš„æƒ…å†µä¸»è¦æœ‰ä¸¤ç±»ï¼š<br>  ç¬¬ä¸€ç±» æ˜¯ç³»ç»Ÿä¸­å­˜åœ¨å¤§é‡ç‹¬ç«‹çš„æ‰©å±•ï¼Œä¸ºæ”¯æŒæ¯ä¸€ç§ç»„åˆå°†äº§ç”Ÿå¤§é‡çš„å­ç±»ï¼Œä½¿å¾—å­ç±»æ•°ç›®å‘ˆçˆ†ç‚¸æ€§å¢é•¿<br>  ç¬¬äºŒç±» æ˜¯å› ä¸ºç±»å®šä¹‰ä¸èƒ½ç»§æ‰¿ï¼ˆå¦‚finalç±»ï¼‰</li><li>åœ¨ä¸å½±å“å…¶ä»–å¯¹è±¡çš„æƒ…å†µä¸‹ï¼Œä»¥åŠ¨æ€ã€é€æ˜çš„æ–¹å¼ç»™å•ä¸ªå¯¹è±¡æ·»åŠ èŒè´£ã€‚</li><li>å½“å¯¹è±¡çš„åŠŸèƒ½è¦æ±‚å¯ä»¥åŠ¨æ€åœ°æ·»åŠ ï¼Œä¹Ÿå¯ä»¥å†åŠ¨æ€åœ°æ’¤é”€æ—¶ã€‚</li></ul></blockquote><p><strong>ä¼˜ç‚¹ï¼š</strong></p><blockquote><ul><li>é¥°è€…æ¨¡å¼å¯ä»¥å¸¦æ¥æ¯”ç»§æ‰¿æ›´åŠ çµæ´»æ€§çš„æ‰©å±•åŠŸèƒ½ï¼Œä½¿ç”¨æ›´åŠ æ–¹ä¾¿ï¼Œå¯ä»¥é€šè¿‡ç»„åˆä¸åŒçš„è£…é¥°è€…å¯¹è±¡æ¥è·å–å…·æœ‰ä¸åŒè¡Œä¸ºçŠ¶æ€çš„å¤šæ ·åŒ–çš„ç»“æœã€‚è£…é¥°è€…æ¨¡å¼æ¯”ç»§æ‰¿æ›´å…·è‰¯å¥½çš„æ‰©å±•æ€§ï¼Œå®Œç¾çš„éµå¾ªå¼€é—­åŸåˆ™ï¼Œç»§æ‰¿æ˜¯é™æ€çš„é™„åŠ è´£ä»»ï¼Œè£…é¥°è€…åˆ™æ˜¯åŠ¨æ€çš„é™„åŠ è´£ä»»ã€‚</li><li>è£…é¥°ç±»å’Œè¢«è£…é¥°ç±»å¯ä»¥ç‹¬ç«‹å‘å±•ï¼Œä¸ä¼šç›¸äº’è€¦åˆï¼Œè£…é¥°æ¨¡å¼æ˜¯ç»§æ‰¿çš„ä¸€ä¸ªæ›¿ä»£æ¨¡å¼ï¼Œè£…é¥°æ¨¡å¼å¯ä»¥åŠ¨æ€æ‰©å±•ä¸€ä¸ªå®ç°ç±»çš„åŠŸèƒ½ã€‚</li></ul></blockquote><p><strong>ç¼ºç‚¹ï¼š</strong></p><blockquote><ul><li>æ‰©å±•æ€§ä¸å¥½</li><li>å¦‚æœè¦å†åŠ ä¸€ç§é…æ–™ï¼ˆç«è…¿è‚ ï¼‰ï¼Œæˆ‘ä»¬å°±ä¼šå‘ç°éœ€è¦ç»™FriedRiceå’ŒFriedNoodlesåˆ†åˆ«å®šä¹‰ä¸€ä¸ªå­ç±»ã€‚å¦‚æœè¦æ–°å¢ä¸€ä¸ªå¿«é¤å“ç±»ï¼ˆç‚’æ²³ç²‰ï¼‰çš„è¯ï¼Œå°±éœ€è¦å®šä¹‰æ›´å¤šçš„å­ç±»ã€‚</li></ul></blockquote><h3 id="3-3-3-ä»£ç†æ¨¡å¼"><a href="#3-3-3-ä»£ç†æ¨¡å¼" class="headerlink" title="3.3.3 ä»£ç†æ¨¡å¼"></a>3.3.3 ä»£ç†æ¨¡å¼</h3><p>ä»£ç†æ¨¡å¼ï¼šä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚ï¼ˆç›´è§‚çš„è¯´ï¼Œä»£ç†å°±æ˜¯ç”Ÿäº§å‚å•†å’Œæ¶ˆè´¹è€…ä¹‹é—´çš„ä¸­ä»‹ï¼Œæ¶ˆè´¹è€…æƒ³ä¹°éƒ½æ˜¯å»æ‰¾ä¸­ä»‹ï¼‰ï¼ˆ1688è­¦å‘Šï¼‰</p><blockquote><p>Javaä¸­çš„ä»£ç†æŒ‰ç…§ä»£ç†ç±»ç”Ÿæˆæ—¶æœºä¸åŒåˆåˆ†ä¸º<strong>é™æ€ä»£ç†</strong>å’Œ<strong>åŠ¨æ€ä»£ç†</strong><br>  <strong>é™æ€ä»£ç†ä»£ç†ç±»</strong>åœ¨ç¼–è¯‘æœŸå°±ç”Ÿæˆï¼Œ<br>  <strong>åŠ¨æ€ä»£ç†ä»£ç†ç±»</strong>åˆ™æ˜¯åœ¨Javaè¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆï¼ŒåŠ¨æ€ä»£ç†åˆæœ‰JDKä»£ç†å’ŒCGLibä»£ç†ä¸¤ç§ã€‚</p></blockquote><p><strong>ç»“æ„ï¼š</strong></p><ul><li><strong>æŠ½è±¡ä¸»é¢˜ï¼ˆSubjectï¼‰ç±»</strong>ï¼š é€šè¿‡æ¥å£æˆ–æŠ½è±¡ç±»å£°æ˜çœŸå®ä¸»é¢˜å’Œä»£ç†å¯¹è±¡å®ç°çš„ä¸šåŠ¡æ–¹æ³•ã€‚</li><li><strong>çœŸå®ä¸»é¢˜ï¼ˆReal Subjectï¼‰ç±»</strong>ï¼š å®ç°äº†æŠ½è±¡ä¸»é¢˜ä¸­çš„å…·ä½“ä¸šåŠ¡ï¼Œæ˜¯ä»£ç†å¯¹è±¡æ‰€ä»£è¡¨çš„çœŸå®å¯¹è±¡ï¼Œæ˜¯æœ€ç»ˆè¦å¼•ç”¨çš„å¯¹è±¡ã€‚</li><li><strong>ä»£ç†ï¼ˆProxyï¼‰ç±»</strong> ï¼š æä¾›äº†ä¸çœŸå®ä¸»é¢˜ç›¸åŒçš„æ¥å£ï¼Œå…¶å†…éƒ¨å«æœ‰å¯¹çœŸå®ä¸»é¢˜çš„å¼•ç”¨ï¼Œå®ƒå¯ä»¥è®¿é—®ã€æ§åˆ¶æˆ–æ‰©å±•çœŸå®ä¸»é¢˜çš„åŠŸèƒ½ã€‚</li></ul><p>ä¾‹å­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å–ç¥¨æ¥å£ï¼Œå®šä¹‰å–ç¥¨è§„åˆ™</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SellTickets</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Sell.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sell</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç«è½¦ç«™ç±»ï¼Œå…·æœ‰å–ç¥¨åŠŸèƒ½ï¼Œæ‰€ä»¥éœ€è¦å®ç°æ¥å£SellTickets</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TrainStation</span> <span class="keyword">implements</span> <span class="title class_">SellTickets</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sell</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç«è½¦ç«™å–ç¥¨&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä»£å”®ç‚¹ï¼Œå°†ç«è½¦ç«™å–ç¥¨çš„åŠŸèƒ½æ‹¿åˆ°ä»£å”®ç‚¹æ¥ï¼Œå³ä»£å”®ç‚¹å¯ä»¥å–å‡ºç«è½¦ç¥¨ï¼Œå…·æœ‰</span></span><br><span class="line"><span class="comment"> * å–ç¥¨åŠŸèƒ½ï¼Œæ‰€ä»¥éœ€è¦å®ç°SellTicketsæ¥å£ï¼ŒåŒæ—¶æ˜¯ä»£ç†ç«è½¦ç«™å–ç¥¨ï¼Œå³è½¦ç¥¨</span></span><br><span class="line"><span class="comment"> * ä¸ç«è½¦ç«™æœ‰å…³è”ï¼Œè¡¨ç°ä¸ºå…·æœ‰å±æ€§ â€œç«è½¦ç«™â€</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProxyPoint</span> <span class="keyword">implements</span> <span class="title class_">SellTickets</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> TrainStation station;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sell</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä»£ç†ç‚¹ä»£å”®ç«è½¦ç¥¨ï¼Œæ”¶å–ä¸€å®šçš„ä»£ç†è´¹&quot;</span>);</span><br><span class="line">        station.sell();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æµ‹è¯•ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ProxyPoint</span> <span class="variable">proxyPoint</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ProxyPoint</span>();</span><br><span class="line">        proxyPoint.sell();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»ä¸Šé¢ä»£ç ä¸­å¯ä»¥çœ‹å‡ºæµ‹è¯•ç±»ç›´æ¥è®¿é—®çš„æ˜¯ProxyPointç±»å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´ProxyPointä½œä¸ºè®¿é—®å¯¹è±¡å’Œç›®æ ‡å¯¹è±¡çš„ä¸­ä»‹ã€‚åŒæ—¶ä¹Ÿå¯¹sellæ–¹æ³•è¿›è¡Œäº†å¢å¼ºï¼ˆä»£ç†ç‚¹æ”¶å–ä¸€äº›æœåŠ¡è´¹ç”¨ï¼‰ã€‚</span></span><br></pre></td></tr></table></figure><h4 id="3-3-3-1-JDKåŠ¨æ€ä»£ç†"><a href="#3-3-3-1-JDKåŠ¨æ€ä»£ç†" class="headerlink" title="3.3.3.1 JDKåŠ¨æ€ä»£ç†"></a>3.3.3.1 JDKåŠ¨æ€ä»£ç†</h4><blockquote><p>Javaä¸­æä¾›äº†ä¸€ä¸ªåŠ¨æ€ä»£ç†ç±»Proxyï¼ŒProxyå¹¶ä¸æ˜¯æˆ‘ä»¬ä¸Šè¿°æ‰€è¯´çš„ä»£ç†å¯¹è±¡çš„ç±»ï¼Œè€Œæ˜¯æä¾›äº†ä¸€ä¸ªåˆ›å»ºä»£ç†å¯¹è±¡çš„é™æ€æ–¹æ³•ï¼ˆnewProxyInstanceæ–¹æ³•ï¼‰æ¥è·å–ä»£ç†å¯¹è±¡ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å–ç¥¨æ¥å£ï¼Œå®šä¹‰å–ç¥¨è§„åˆ™</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SellTickets</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Sell.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sell</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç«è½¦ç«™ç±»ï¼Œå…·æœ‰å–ç¥¨åŠŸèƒ½ï¼Œæ‰€ä»¥éœ€è¦å®ç°æ¥å£SellTickets</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TrainStation</span> <span class="keyword">implements</span> <span class="title class_">SellTickets</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sell</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç«è½¦ç«™å–ç¥¨&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä»£ç†å·¥å‚ï¼Œç”¨æ¥åˆ›å»ºä»£ç†å¯¹è±¡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProxyFactory</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">TrainStation</span> <span class="variable">station</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TrainStation</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä»£ç†å·¥å‚ï¼ŒåŠ¨æ€è·å–ä»£ç†å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> SellTickets <span class="title function_">getProxyObject</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * è°ƒç”¨Proxyä»£ç†ç±»ä¸­çš„newProxyInstanceæ–¹æ³•æ¥åŠ¨æ€è·å–ä»£ç†å¯¹è±¡</span></span><br><span class="line"><span class="comment">         * newProxyInstance()æ–¹æ³•å‚æ•°è¯´æ˜ï¼š</span></span><br><span class="line"><span class="comment">         *  ClassLoader loader ï¼š ç±»åŠ è½½å™¨ï¼Œç”¨äºåŠ è½½ä»£ç†ç±»ï¼Œä½¿ç”¨çœŸå®å¯¹è±¡çš„ç±»åŠ è½½å™¨å³å¯</span></span><br><span class="line"><span class="comment">         *  Class&lt;?&gt;[] interfaces ï¼š çœŸå®å¯¹è±¡æ‰€å®ç°çš„æ¥å£ï¼Œä»£ç†æ¨¡å¼çœŸå®å¯¹è±¡å’Œä»£ç†å¯¹è±¡å®ç°ç›¸åŒçš„æ¥å£</span></span><br><span class="line"><span class="comment">         *  InvocationHandler h ï¼š ä»£ç†å¯¹è±¡çš„è°ƒç”¨å¤„ç†ç¨‹åº</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="type">SellTickets</span> <span class="variable">sellTickets</span> <span class="operator">=</span> (SellTickets) Proxy.newProxyInstance(</span><br><span class="line">                station.getClass().getClassLoader(), <span class="comment">//ç±»åŠ è½½å™¨ï¼Œç”¨æ¥åŠ è½½ä»£ç†ç±»</span></span><br><span class="line">                station.getClass().getInterfaces(),<span class="comment">//çœŸå®å¯¹è±¡å®ç°çš„æ¥å£ï¼Œä»£ç†å¯¹è±¡è·ŸçœŸå®å¯¹è±¡å®ç°åŒæ ·çš„æ¥å£</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvocationHandler</span>() &#123;<span class="comment">//åŒ¿åå†…éƒ¨ç±»ä¸­å®šä¹‰ä»£ç†å¯¹è±¡è¦å¤„ç†çš„ä¸šåŠ¡é€»è¾‘</span></span><br><span class="line">                    <span class="comment">/**</span></span><br><span class="line"><span class="comment">                     *</span></span><br><span class="line"><span class="comment">                     * <span class="doctag">@param</span> proxy ä»£ç†å¯¹è±¡</span></span><br><span class="line"><span class="comment">                     * <span class="doctag">@param</span> method å¯¹åº”äºåœ¨ä»£ç†å¯¹è±¡ä¸Šè°ƒç”¨çš„æ¥å£æ–¹æ³•çš„ Method å®ä¾‹</span></span><br><span class="line"><span class="comment">                     * <span class="doctag">@param</span> args ä»£ç†å¯¹è±¡è°ƒç”¨æ¥å£æ–¹æ³•æ—¶ä¼ é€’çš„å®é™…å‚æ•°</span></span><br><span class="line"><span class="comment">                     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">                     * <span class="doctag">@throws</span> Throwable</span></span><br><span class="line"><span class="comment">                     */</span></span><br><span class="line">                    <span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">                        System.out.println(<span class="string">&quot;ä»£ç†ç‚¹æ”¶å–ä¸€äº›æœåŠ¡è´¹ç”¨(JDKåŠ¨æ€ä»£ç†æ–¹å¼)&quot;</span>);</span><br><span class="line">                        <span class="comment">//æ‰§è¡ŒçœŸå®å¯¹è±¡</span></span><br><span class="line">                        <span class="type">Object</span> <span class="variable">result</span> <span class="operator">=</span> method.invoke(station, args);</span><br><span class="line">                        <span class="keyword">return</span> result;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">        <span class="keyword">return</span> sellTickets;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æµ‹è¯•ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//å£°æ˜è·å–ä»£ç†å¯¹è±¡çš„å·¥å‚</span></span><br><span class="line">        <span class="type">ProxyFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ProxyFactory</span>();</span><br><span class="line">        <span class="comment">//é€šè¿‡å·¥å‚è·å–ä»£ç†å¯¹è±¡</span></span><br><span class="line">        <span class="type">SellTickets</span> <span class="variable">proxyObject</span> <span class="operator">=</span> factory.getProxyObject();</span><br><span class="line">        <span class="comment">//ä»£ç†å¯¹è±¡æ‰§è¡Œä¸šåŠ¡é€»è¾‘</span></span><br><span class="line">        proxyObject.sell();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>JDKå®ç°åŠ¨æ€ä»£ç†çš„æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li>åœ¨æµ‹è¯•ç±»ä¸­é€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨sell()æ–¹æ³•</li><li>æ ¹æ®å¤šæ€çš„ç‰¹æ€§ï¼Œæ‰§è¡Œçš„æ˜¯ä»£ç†ç±»ï¼ˆ$Proxy0ï¼‰ä¸­çš„sell()æ–¹æ³•</li><li>ä»£ç†ç±»ï¼ˆ$Proxy0ï¼‰ä¸­çš„sell()æ–¹æ³•ä¸­åˆè°ƒç”¨äº†InvocationHandleræ¥å£çš„å­å®ç°ç±»å¯¹è±¡çš„invokeæ–¹æ³•</li><li>invokeæ–¹æ³•é€šè¿‡åå°„æ‰§è¡Œäº†çœŸå®å¯¹è±¡æ‰€å±ç±»(TrainStation)ä¸­çš„sell()æ–¹æ³•</li></ol></blockquote><h4 id="3-3-3-2-CGLIBåŠ¨æ€ä»£ç†"><a href="#3-3-3-2-CGLIBåŠ¨æ€ä»£ç†" class="headerlink" title="3.3.3.2 CGLIBåŠ¨æ€ä»£ç†"></a>3.3.3.2 CGLIBåŠ¨æ€ä»£ç†</h4><p>å¦‚æœæ²¡æœ‰å®šä¹‰SellTicketsæ¥å£ï¼Œåªå®šä¹‰äº†TrainStation(ç«è½¦ç«™ç±»)ã€‚å¾ˆæ˜¾ç„¶JDKä»£ç†æ˜¯æ— æ³•ä½¿ç”¨äº†ï¼Œ<strong>å› ä¸ºJDKåŠ¨æ€ä»£ç†è¦æ±‚å¿…é¡»å®šä¹‰æ¥å£</strong>ï¼Œå¯¹æ¥å£è¿›è¡Œä»£ç†ã€‚<br>CGLIBæ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ï¼Œé«˜æ€§èƒ½çš„ä»£ç ç”ŸæˆåŒ…ã€‚<strong>å®ƒä¸ºæ²¡æœ‰å®ç°æ¥å£çš„ç±»æä¾›ä»£ç†ï¼Œ</strong>ä¸ºJDKçš„åŠ¨æ€ä»£ç†æä¾›äº†å¾ˆå¥½çš„è¡¥å……ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cglib<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cglib<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç«è½¦ç«™ç±»ï¼Œæ²¡æœ‰å®ç°ä»»ä½•æ¥å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TrainStation</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sell</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;ç«è½¦ç«™å–ç¥¨&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * CGLIBä»£ç†å·¥å‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProxyFactory</span> <span class="keyword">implements</span> <span class="title class_">MethodInterceptor</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">TrainStation</span> <span class="variable">target</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TrainStation</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> TrainStation <span class="title function_">getProxyObject</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºEnhancerå¯¹è±¡ï¼Œç±»ä¼¼äºJDKåŠ¨æ€ä»£ç†çš„Proxyç±»ï¼Œä¸‹ä¸€æ­¥å°±æ˜¯è®¾ç½®å‡ ä¸ªå‚æ•°</span></span><br><span class="line">        <span class="type">Enhancer</span> <span class="variable">enhancer</span> <span class="operator">=</span><span class="keyword">new</span> <span class="title class_">Enhancer</span>();</span><br><span class="line">        <span class="comment">//è®¾ç½®çˆ¶ç±»çš„å­—èŠ‚ç å¯¹è±¡</span></span><br><span class="line">        enhancer.setSuperclass(target.getClass());</span><br><span class="line">        <span class="comment">//è®¾ç½®å›è°ƒå‡½æ•°</span></span><br><span class="line">        enhancer.setCallback(<span class="built_in">this</span>);</span><br><span class="line">        <span class="comment">//åˆ›å»ºä»£ç†å¯¹è±¡</span></span><br><span class="line">        <span class="type">TrainStation</span> <span class="variable">obj</span> <span class="operator">=</span> (TrainStation) enhancer.create();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">intercept</span><span class="params">(Object o, Method method, Object[] objects, MethodProxy methodProxy)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä»£ç†ç‚¹æ”¶å–ä¸€äº›æœåŠ¡è´¹ç”¨(CGLIBåŠ¨æ€ä»£ç†æ–¹å¼)&quot;</span>);</span><br><span class="line">        <span class="type">TrainStation</span> <span class="variable">result</span> <span class="operator">=</span> (TrainStation) methodProxy.invokeSuper(o, objects);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.lxg.pattern.proxy.cglib_proxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºä»£ç†å·¥å‚å¯¹è±¡</span></span><br><span class="line">        <span class="type">ProxyFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ProxyFactory</span>();</span><br><span class="line">        <span class="comment">//è·å–ä»£ç†å¯¹è±¡</span></span><br><span class="line">        <span class="type">TrainStation</span> <span class="variable">proxyObject</span> <span class="operator">=</span> factory.getProxyObject();</span><br><span class="line"></span><br><span class="line">        proxyObject.sell();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä¸‰ç§ä»£ç†çš„å¯¹æ¯”ï¼š</strong></p><blockquote><p>ä½¿ç”¨CGLibå®ç°åŠ¨æ€ä»£ç†ï¼ŒCGLibåº•å±‚é‡‡ç”¨ASMå­—èŠ‚ç ç”Ÿæˆæ¡†æ¶ï¼Œä½¿ç”¨å­—èŠ‚ç æŠ€æœ¯ç”Ÿæˆä»£ç†ç±»ï¼Œåœ¨JDK1.6ä¹‹å‰æ¯”ä½¿ç”¨Javaåå°„æ•ˆç‡è¦é«˜ã€‚å”¯ä¸€éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒCGLibä¸èƒ½å¯¹å£°æ˜ä¸ºfinalçš„ç±»æˆ–è€…æ–¹æ³•è¿›è¡Œä»£ç†ï¼Œå› ä¸ºCGLibåŸç†æ˜¯åŠ¨æ€ç”Ÿæˆè¢«ä»£ç†ç±»çš„å­ç±»ã€‚</p></blockquote><blockquote><p>åœ¨JDK1.6ã€JDK1.7ã€JDK1.8é€æ­¥å¯¹JDKåŠ¨æ€ä»£ç†ä¼˜åŒ–ä¹‹åï¼Œåœ¨è°ƒç”¨æ¬¡æ•°è¾ƒå°‘çš„æƒ…å†µä¸‹ï¼ŒJDKä»£ç†æ•ˆç‡é«˜äºCGLibä»£ç†æ•ˆç‡ï¼Œåªæœ‰å½“è¿›è¡Œå¤§é‡è°ƒç”¨çš„æ—¶å€™ï¼ŒJDK1.6å’ŒJDK1.7æ¯”CGLibä»£ç†æ•ˆç‡ä½ä¸€ç‚¹ï¼Œä½†æ˜¯åˆ°JDK1.8çš„æ—¶å€™ï¼ŒJDKä»£ç†æ•ˆç‡é«˜äºCGLibä»£ç†ã€‚</p></blockquote><blockquote><p><strong>æ‰€ä»¥å¦‚æœæœ‰æ¥å£ä½¿ç”¨JDKåŠ¨æ€ä»£ç†ï¼Œå¦‚æœæ²¡æœ‰æ¥å£ä½¿ç”¨CGLIBä»£ç†ã€‚</strong></p></blockquote><p><strong>ä¸¤ç§ä»£ç†æ–¹å¼çš„å¯¹æ¯”ï¼š</strong></p><blockquote><p>åŠ¨æ€ä»£ç†ä¸é™æ€ä»£ç†ç›¸æ¯”è¾ƒï¼Œæœ€å¤§çš„å¥½å¤„æ˜¯æ¥å£ä¸­å£°æ˜çš„æ‰€æœ‰æ–¹æ³•éƒ½è¢«è½¬ç§»åˆ°è°ƒç”¨å¤„ç†å™¨ä¸€ä¸ªé›†ä¸­çš„æ–¹æ³•ä¸­å¤„ç†ï¼ˆInvocationHandler.invokeï¼‰ã€‚è¿™æ ·ï¼Œåœ¨æ¥å£æ–¹æ³•æ•°é‡æ¯”è¾ƒå¤šçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œçµæ´»å¤„ç†ï¼Œè€Œä¸éœ€è¦åƒé™æ€ä»£ç†é‚£æ ·æ¯ä¸€ä¸ªæ–¹æ³•è¿›è¡Œä¸­è½¬ã€‚</p></blockquote><blockquote><p>å¦‚æœæ¥å£å¢åŠ ä¸€ä¸ªæ–¹æ³•ï¼Œé™æ€ä»£ç†æ¨¡å¼é™¤äº†æ‰€æœ‰å®ç°ç±»éœ€è¦å®ç°è¿™ä¸ªæ–¹æ³•å¤–ï¼Œæ‰€æœ‰ä»£ç†ç±»ä¹Ÿéœ€è¦å®ç°æ­¤æ–¹æ³•ã€‚å¢åŠ äº†ä»£ç ç»´æŠ¤çš„å¤æ‚åº¦ã€‚è€ŒåŠ¨æ€ä»£ç†ä¸ä¼šå‡ºç°è¯¥é—®é¢˜</p></blockquote><p><strong>ä¼˜ç‚¹ï¼š</strong></p><blockquote><ul><li>ä»£ç†æ¨¡å¼åœ¨å®¢æˆ·ç«¯ä¸ç›®æ ‡å¯¹è±¡ä¹‹é—´èµ·åˆ°ä¸€ä¸ªä¸­ä»‹ä½œç”¨å’Œä¿æŠ¤ç›®æ ‡å¯¹è±¡çš„ä½œç”¨ï¼›</li><li>ä»£ç†å¯¹è±¡å¯ä»¥æ‰©å±•ç›®æ ‡å¯¹è±¡çš„åŠŸèƒ½ï¼›</li><li>ä»£ç†æ¨¡å¼èƒ½å°†å®¢æˆ·ç«¯ä¸ç›®æ ‡å¯¹è±¡åˆ†ç¦»ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šé™ä½äº†ç³»ç»Ÿçš„è€¦åˆåº¦ï¼›</li></ul></blockquote><h3 id="3-2-4-å¤–è§‚æ¨¡å¼"><a href="#3-2-4-å¤–è§‚æ¨¡å¼" class="headerlink" title="3.2.4 å¤–è§‚æ¨¡å¼"></a>3.2.4 å¤–è§‚æ¨¡å¼</h3><p>åŠŸèƒ½éƒ½ç»™ä½ åŒ…è£…èµ·æ¥äº†ï¼Œä½ ä¸éœ€è¦çŸ¥é“å¥¹æ˜¯æ€ä¹ˆå®ç°çš„ï¼Œä½ åªéœ€è¦çŸ¥é“å¥¹å¯ä»¥åšä½ æƒ³åšçš„äº‹ã€‚</p><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F.png" class="" title="å¤–è§‚æ¨¡å¼"><p><strong>ç»“æ„</strong></p><blockquote><p><strong>å¤–è§‚ï¼ˆFacadeï¼‰è§’è‰²ï¼š</strong>ä¸ºå¤šä¸ªå­ç³»ç»Ÿå¯¹å¤–æä¾›ä¸€ä¸ªå…±åŒçš„æ¥å£ã€‚<br><strong>å­ç³»ç»Ÿï¼ˆSub Systemï¼‰è§’è‰²ï¼š</strong>å®ç°ç³»ç»Ÿçš„éƒ¨åˆ†åŠŸèƒ½ï¼Œå®¢æˆ·å¯ä»¥é€šè¿‡å¤–è§‚è§’è‰²è®¿é—®å®ƒã€‚</p></blockquote><p><strong>ä¾‹å­ï¼š</strong></p><blockquote><p>å°æ˜çš„çˆ·çˆ·å·²ç»60å²äº†ï¼Œä¸€ä¸ªäººåœ¨å®¶ç”Ÿæ´»ï¼šæ¯æ¬¡éƒ½éœ€è¦æ‰“å¼€ç¯ã€æ‰“å¼€ç”µè§†ã€æ‰“å¼€ç©ºè°ƒï¼›ç¡è§‰æ—¶å…³é—­ç¯ã€å…³é—­ç”µè§†ã€å…³é—­ç©ºè°ƒï¼›æ“ä½œèµ·æ¥éƒ½æ¯”è¾ƒéº»çƒ¦ã€‚æ‰€ä»¥å°æ˜ç»™çˆ·çˆ·ä¹°äº†æ™ºèƒ½éŸ³ç®±ï¼Œå¯ä»¥é€šè¿‡è¯­éŸ³ç›´æ¥æ§åˆ¶è¿™äº›æ™ºèƒ½å®¶ç”µçš„å¼€å¯å’Œå…³é—­ã€‚ç±»å›¾å¦‚ä¸‹ï¼š</p></blockquote><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F-%E4%BE%8B%E5%AD%90.png" class="" title="å¤–è§‚æ¨¡å¼-ä¾‹å­"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç¯ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Light</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">on</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ‰“å¼€äº†ç¯....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">off</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å…³é—­äº†ç¯....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç”µè§†ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TV</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">on</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ‰“å¼€äº†ç”µè§†....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">off</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å…³é—­äº†ç”µè§†....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ§åˆ¶ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AirCondition</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">on</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ‰“å¼€äº†ç©ºè°ƒ....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">off</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å…³é—­äº†ç©ºè°ƒ....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ™ºèƒ½éŸ³ç®±</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SmartAppliancesFacade</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Light light;</span><br><span class="line">    <span class="keyword">private</span> TV tv;</span><br><span class="line">    <span class="keyword">private</span> AirCondition airCondition;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">SmartAppliancesFacade</span><span class="params">()</span> &#123;</span><br><span class="line">        light = <span class="keyword">new</span> <span class="title class_">Light</span>();</span><br><span class="line">        tv = <span class="keyword">new</span> <span class="title class_">TV</span>();</span><br><span class="line">        airCondition = <span class="keyword">new</span> <span class="title class_">AirCondition</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">say</span><span class="params">(String message)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(message.contains(<span class="string">&quot;æ‰“å¼€&quot;</span>)) &#123;</span><br><span class="line">            on();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(message.contains(<span class="string">&quot;å…³é—­&quot;</span>)) &#123;</span><br><span class="line">            off();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æˆ‘è¿˜å¬ä¸æ‡‚ä½ è¯´çš„ï¼ï¼ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//èµ·åºŠåä¸€é”®å¼€ç”µå™¨</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">on</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;èµ·åºŠäº†&quot;</span>);</span><br><span class="line">        light.on();</span><br><span class="line">        tv.on();</span><br><span class="line">        airCondition.on();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç¡è§‰ä¸€é”®å…³ç”µå™¨</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">off</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç¡è§‰äº†&quot;</span>);</span><br><span class="line">        light.off();</span><br><span class="line">        tv.off();</span><br><span class="line">        airCondition.off();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºå¤–è§‚å¯¹è±¡</span></span><br><span class="line">        <span class="type">SmartAppliancesFacade</span> <span class="variable">facade</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SmartAppliancesFacade</span>();</span><br><span class="line">        <span class="comment">//å®¢æˆ·ç«¯ç›´æ¥ä¸å¤–è§‚å¯¹è±¡è¿›è¡Œäº¤äº’</span></span><br><span class="line">        facade.say(<span class="string">&quot;æ‰“å¼€å®¶ç”µ&quot;</span>);</span><br><span class="line">        facade.say(<span class="string">&quot;å…³é—­å®¶ç”µ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>ä¼˜ç¼ºç‚¹</strong></p><blockquote><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>é™ä½äº†å­ç³»ç»Ÿä¸å®¢æˆ·ç«¯ä¹‹é—´çš„è€¦åˆåº¦ï¼Œä½¿å¾—å­ç³»ç»Ÿçš„å˜åŒ–ä¸ä¼šå½±å“è°ƒç”¨å®ƒçš„å®¢æˆ·ç±»ã€‚</li><li>å¯¹å®¢æˆ·å±è”½äº†å­ç³»ç»Ÿç»„ä»¶ï¼Œå‡å°‘äº†å®¢æˆ·å¤„ç†çš„å¯¹è±¡æ•°ç›®ï¼Œå¹¶ä½¿å¾—å­ç³»ç»Ÿä½¿ç”¨èµ·æ¥æ›´åŠ å®¹æ˜“ã€‚</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>ä¸ç¬¦åˆå¼€é—­åŸåˆ™ï¼Œä¿®æ”¹å¾ˆéº»çƒ¦</li></ul></blockquote><p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p><blockquote><ul><li>å¯¹åˆ†å±‚ç»“æ„ç³»ç»Ÿæ„å»ºæ—¶ï¼Œä½¿ç”¨å¤–è§‚æ¨¡å¼å®šä¹‰å­ç³»ç»Ÿä¸­æ¯å±‚çš„å…¥å£ç‚¹å¯ä»¥ç®€åŒ–å­ç³»ç»Ÿä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚</li><li>å½“ä¸€ä¸ªå¤æ‚ç³»ç»Ÿçš„å­ç³»ç»Ÿå¾ˆå¤šæ—¶ï¼Œå¤–è§‚æ¨¡å¼å¯ä»¥ä¸ºç³»ç»Ÿè®¾è®¡ä¸€ä¸ªç®€å•çš„æ¥å£ä¾›å¤–ç•Œè®¿é—®ã€‚</li><li>å½“å®¢æˆ·ç«¯ä¸å¤šä¸ªå­ç³»ç»Ÿä¹‹é—´å­˜åœ¨å¾ˆå¤§çš„è”ç³»æ—¶ï¼Œå¼•å…¥å¤–è§‚æ¨¡å¼å¯å°†å®ƒä»¬åˆ†ç¦»ï¼Œä»è€Œæé«˜å­ç³»ç»Ÿçš„ç‹¬ç«‹æ€§å’Œå¯ç§»æ¤æ€§ã€‚</li></ul></blockquote><h3 id="3-2-5-æ¡¥æ¥æ¨¡å¼"><a href="#3-2-5-æ¡¥æ¥æ¨¡å¼" class="headerlink" title="3.2.5 æ¡¥æ¥æ¨¡å¼"></a>3.2.5 æ¡¥æ¥æ¨¡å¼</h3><p>ç°åœ¨æœ‰ä¸€ä¸ªéœ€æ±‚ï¼Œéœ€è¦åˆ›å»ºä¸åŒçš„å›¾å½¢ï¼Œå¹¶ä¸”æ¯ä¸ªå›¾å½¢éƒ½æœ‰å¯èƒ½ä¼šæœ‰ä¸åŒçš„é¢œè‰²ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç»§æ‰¿çš„æ–¹å¼æ¥è®¾è®¡ç±»çš„å…³ç³»ï¼š</p><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F-%E4%BE%8B%E5%AD%90.png" class="" title="æ¡¥æ¥æ¨¡å¼-ä¾‹å­"><blockquote><p>æˆ‘ä»¬å¯ä»¥å‘ç°æœ‰å¾ˆå¤šçš„ç±»ï¼Œå‡å¦‚æˆ‘ä»¬å†å¢åŠ ä¸€ä¸ªå½¢çŠ¶æˆ–å†å¢åŠ ä¸€ç§é¢œè‰²ï¼Œå°±éœ€è¦åˆ›å»ºæ›´å¤šçš„ç±»ã€‚</p><p>è¯•æƒ³ï¼Œåœ¨ä¸€ä¸ªæœ‰å¤šç§å¯èƒ½ä¼šå˜åŒ–çš„ç»´åº¦çš„ç³»ç»Ÿä¸­ï¼Œç”¨ç»§æ‰¿æ–¹å¼ä¼šé€ æˆç±»çˆ†ç‚¸ï¼Œæ‰©å±•èµ·æ¥ä¸çµæ´»ã€‚æ¯æ¬¡åœ¨ä¸€ä¸ªç»´åº¦ä¸Šæ–°å¢ä¸€ä¸ªå…·ä½“å®ç°éƒ½è¦å¢åŠ å¤šä¸ªå­ç±»ã€‚ä¸ºäº†æ›´åŠ çµæ´»çš„è®¾è®¡ç³»ç»Ÿï¼Œæˆ‘ä»¬æ­¤æ—¶å¯ä»¥è€ƒè™‘ä½¿ç”¨æ¡¥æ¥æ¨¡å¼ã€‚</p><p>ä»–çš„å®šä¹‰æ˜¯ï¼šå°†æŠ½è±¡ä¸å®ç°åˆ†ç¦»ï¼Œä½¿å®ƒä»¬å¯ä»¥ç‹¬ç«‹å˜åŒ–ã€‚å®ƒæ˜¯ç”¨ç»„åˆå…³ç³»ä»£æ›¿ç»§æ‰¿å…³ç³»æ¥å®ç°ï¼Œä»è€Œé™ä½äº†æŠ½è±¡å’Œå®ç°è¿™ä¸¤ä¸ªå¯å˜ç»´åº¦çš„è€¦åˆåº¦ã€‚</p></blockquote><p><strong>è§’è‰²ï¼š</strong></p><blockquote><ul><li><strong>æŠ½è±¡åŒ–ï¼ˆAbstractionï¼‰è§’è‰² ï¼š</strong>å®šä¹‰æŠ½è±¡ç±»ï¼Œå¹¶åŒ…å«ä¸€ä¸ªå¯¹å®ç°åŒ–å¯¹è±¡çš„å¼•ç”¨ã€‚</li><li><strong>æ‰©å±•æŠ½è±¡åŒ–ï¼ˆRefined Abstractionï¼‰è§’è‰²ï¼š</strong>æ˜¯æŠ½è±¡åŒ–è§’è‰²çš„å­ç±»ï¼Œå®ç°çˆ¶ç±»ä¸­çš„ä¸šåŠ¡æ–¹æ³•ï¼Œå¹¶é€šè¿‡ç»„åˆå…³ç³»è°ƒç”¨å®ç°åŒ–è§’è‰²ä¸­çš„ä¸šåŠ¡æ–¹æ³•ã€‚</li><li><strong>å®ç°åŒ–ï¼ˆImplementorï¼‰è§’è‰² ï¼š</strong>å®šä¹‰å®ç°åŒ–è§’è‰²çš„æ¥å£ï¼Œä¾›æ‰©å±•æŠ½è±¡åŒ–è§’è‰²è°ƒç”¨ã€‚</li><li><strong>å…·ä½“å®ç°åŒ–ï¼ˆConcrete Implementorï¼‰è§’è‰² ï¼š</strong>ç»™å‡ºå®ç°åŒ–è§’è‰²æ¥å£çš„å…·ä½“å®ç°ã€‚</li></ul></blockquote><p><strong>ä¾‹å­ï¼š</strong></p><blockquote><p>éœ€è¦å¼€å‘ä¸€ä¸ªè·¨å¹³å°è§†é¢‘æ’­æ”¾å™¨ï¼Œå¯ä»¥åœ¨ä¸åŒæ“ä½œç³»ç»Ÿå¹³å°ï¼ˆå¦‚Windowsã€Macã€Linuxç­‰ï¼‰ä¸Šæ’­æ”¾å¤šç§æ ¼å¼çš„è§†é¢‘æ–‡ä»¶ï¼Œå¸¸è§çš„è§†é¢‘æ ¼å¼åŒ…æ‹¬RMVBã€AVIã€WMVç­‰ã€‚è¯¥æ’­æ”¾å™¨åŒ…å«äº†ä¸¤ä¸ªç»´åº¦ï¼Œé€‚åˆä½¿ç”¨æ¡¥æ¥æ¨¡å¼ã€‚ç±»å›¾å¦‚ä¸‹</p></blockquote><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F-%E4%BE%8B%E5%AD%902.png" class="" title="æ¡¥æ¥æ¨¡å¼-ä¾‹å­2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è§†é¢‘æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">VideoFile</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">decode</span><span class="params">(String fileName)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//aviæ–‡ä»¶</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AVIFile</span> <span class="keyword">implements</span> <span class="title class_">VideoFile</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">decode</span><span class="params">(String fileName)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;aviè§†é¢‘æ–‡ä»¶ï¼š&quot;</span>+ fileName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//rmvbæ–‡ä»¶</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">REVBBFile</span> <span class="keyword">implements</span> <span class="title class_">VideoFile</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">decode</span><span class="params">(String fileName)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;rmvbæ–‡ä»¶ï¼š&quot;</span> + fileName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ“ä½œç³»ç»Ÿç‰ˆæœ¬</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">OperatingSystemVersion</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> VideoFile videoFile;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">OperatingSystemVersion</span><span class="params">(VideoFile videoFile)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.videoFile = videoFile;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">play</span><span class="params">(String fileName)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Windowsç‰ˆæœ¬</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Windows</span> <span class="keyword">extends</span> <span class="title class_">OperatingSystem</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Windows</span><span class="params">(VideoFile videoFile)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(videoFile);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">play</span><span class="params">(String fileName)</span> &#123;</span><br><span class="line">        videoFile.decode(fileName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//macç‰ˆæœ¬</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Mac</span> <span class="keyword">extends</span> <span class="title class_">OperatingSystemVersion</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Mac</span><span class="params">(VideoFile videoFile)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(videoFile);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">play</span><span class="params">(String fileName)</span> &#123;</span><br><span class="line">videoFile.decode(fileName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">OperatingSystem</span> <span class="variable">os</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Windows</span>(<span class="keyword">new</span> <span class="title class_">AVIFile</span>());</span><br><span class="line">        os.play(<span class="string">&quot;æˆ˜ç‹¼3&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">æ¥æ¨¡å¼æé«˜äº†ç³»ç»Ÿçš„å¯æ‰©å……æ€§ï¼Œåœ¨ä¸¤ä¸ªå˜åŒ–ç»´åº¦ä¸­ä»»æ„æ‰©å±•ä¸€ä¸ªç»´åº¦ï¼Œéƒ½ä¸éœ€è¦ä¿®æ”¹åŸæœ‰ç³»ç»Ÿã€‚</span></span><br><span class="line"><span class="comment">å¦‚ï¼šå¦‚æœç°åœ¨è¿˜æœ‰ä¸€ç§è§†é¢‘æ–‡ä»¶ç±»å‹wmvï¼Œæˆ‘ä»¬åªéœ€è¦å†å®šä¹‰ä¸€ä¸ªç±»å®ç°VideoFileæ¥å£å³å¯ï¼Œå…¶ä»–ç±»ä¸éœ€è¦å‘ç”Ÿå˜åŒ–ã€‚å®ç°ç»†èŠ‚å¯¹å®¢æˆ·é€æ˜</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    ä½¿ç”¨åœºæ™¯</span></span><br><span class="line"><span class="comment">        Â· å½“ä¸€ä¸ªç±»å­˜åœ¨ä¸¤ä¸ªç‹¬ç«‹å˜åŒ–çš„ç»´åº¦ï¼Œä¸”è¿™ä¸¤ä¸ªç»´åº¦éƒ½éœ€è¦è¿›è¡Œæ‰©å±•æ—¶ã€‚</span></span><br><span class="line"><span class="comment">        Â· å½“ä¸€ä¸ªç³»ç»Ÿä¸å¸Œæœ›ä½¿ç”¨ç»§æ‰¿æˆ–å› ä¸ºå¤šå±‚æ¬¡ç»§æ‰¿å¯¼è‡´ç³»ç»Ÿç±»çš„ä¸ªæ•°æ€¥å‰§å¢åŠ æ—¶ã€‚</span></span><br><span class="line"><span class="comment">        Â· å½“ä¸€ä¸ªç³»ç»Ÿéœ€è¦åœ¨æ„ä»¶çš„æŠ½è±¡åŒ–è§’è‰²å’Œå…·ä½“åŒ–è§’è‰²ä¹‹é—´å¢åŠ æ›´å¤šçš„çµæ´»æ€§æ—¶ã€‚é¿å…åœ¨ä¸¤ä¸ªå±‚æ¬¡ä¹‹é—´å»ºç«‹é™æ€çš„ç»§æ‰¿è”ç³»ï¼Œé€šè¿‡æ¡¥æ¥æ¨¡å¼å¯ä»¥ä½¿å®ƒä»¬åœ¨æŠ½è±¡å±‚å»ºç«‹ä¸€ä¸ªå…³è”å…³ç³»ã€‚</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h3 id="3-2-6-ç»„åˆæ¨¡å¼"><a href="#3-2-6-ç»„åˆæ¨¡å¼" class="headerlink" title="3.2.6 ç»„åˆæ¨¡å¼"></a>3.2.6 ç»„åˆæ¨¡å¼</h3><p>åˆåéƒ¨åˆ†æ•´ä½“æ¨¡å¼ï¼Œæ˜¯ç”¨äºæŠŠä¸€ç»„ç›¸ä¼¼çš„å¯¹è±¡å½“ä½œä¸€ä¸ªå•ä¸€çš„å¯¹è±¡ã€‚ç»„åˆæ¨¡å¼ä¾æ®æ ‘å½¢ç»“æ„æ¥ç»„åˆå¯¹è±¡ï¼Œç”¨æ¥è¡¨ç¤ºéƒ¨åˆ†ä»¥åŠæ•´ä½“å±‚æ¬¡ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºç»“æ„å‹æ¨¡å¼ï¼Œå®ƒåˆ›å»ºäº†å¯¹è±¡ç»„çš„æ ‘å½¢ç»“æ„ã€‚</p><p><strong>ç»“æ„ï¼š</strong></p><blockquote><ul><li><strong>æŠ½è±¡æ ¹èŠ‚ç‚¹ï¼ˆComponentï¼‰ï¼š</strong>å®šä¹‰ç³»ç»Ÿå„å±‚æ¬¡å¯¹è±¡çš„å…±æœ‰æ–¹æ³•å’Œå±æ€§ï¼Œå¯ä»¥é¢„å…ˆå®šä¹‰ä¸€äº›é»˜è®¤è¡Œä¸ºå’Œå±æ€§ã€‚</li><li><strong>æ ‘æèŠ‚ç‚¹ï¼ˆCompositeï¼‰ï¼š</strong>å®šä¹‰æ ‘æèŠ‚ç‚¹çš„è¡Œä¸ºï¼Œå­˜å‚¨å­èŠ‚ç‚¹ï¼Œç»„åˆæ ‘æèŠ‚ç‚¹å’Œå¶å­èŠ‚ç‚¹å½¢æˆä¸€ä¸ªæ ‘å½¢ç»“æ„ã€‚</li><li><strong>å¶å­èŠ‚ç‚¹ï¼ˆLeafï¼‰ï¼š</strong>å¶å­èŠ‚ç‚¹å¯¹è±¡ï¼Œå…¶ä¸‹å†æ— åˆ†æ”¯ï¼Œæ˜¯ç³»ç»Ÿå±‚æ¬¡éå†çš„æœ€å°å•ä½ã€‚</li></ul></blockquote><p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p><blockquote><p>ç»„åˆæ¨¡å¼æ­£æ˜¯åº”æ ‘å½¢ç»“æ„è€Œç”Ÿï¼Œæ‰€ä»¥ç»„åˆæ¨¡å¼çš„ä½¿ç”¨åœºæ™¯å°±æ˜¯å‡ºç°æ ‘å½¢ç»“æ„çš„åœ°æ–¹ã€‚æ¯”å¦‚ï¼šæ–‡ä»¶ç›®å½•æ˜¾ç¤ºï¼Œå¤šçº§ç›®å½•å‘ˆç°ç­‰æ ‘å½¢ç»“æ„æ•°æ®çš„æ“ä½œã€‚</p></blockquote><p><strong>ä¼˜ç‚¹ï¼š</strong></p><blockquote><ul><li>ç»„åˆæ¨¡å¼å¯ä»¥æ¸…æ¥šåœ°å®šä¹‰åˆ†å±‚æ¬¡çš„å¤æ‚å¯¹è±¡ï¼Œè¡¨ç¤ºå¯¹è±¡çš„å…¨éƒ¨æˆ–éƒ¨åˆ†å±‚æ¬¡ï¼Œå®ƒè®©å®¢æˆ·ç«¯å¿½ç•¥äº†å±‚æ¬¡çš„å·®å¼‚ï¼Œæ–¹ä¾¿å¯¹æ•´ä¸ªå±‚æ¬¡ç»“æ„è¿›è¡Œæ§åˆ¶ã€‚</li><li>å®¢æˆ·ç«¯å¯ä»¥ä¸€è‡´åœ°ä½¿ç”¨ä¸€ä¸ªç»„åˆç»“æ„æˆ–å…¶ä¸­å•ä¸ªå¯¹è±¡ï¼Œä¸å¿…å…³å¿ƒå¤„ç†çš„æ˜¯å•ä¸ªå¯¹è±¡è¿˜æ˜¯æ•´ä¸ªç»„åˆç»“æ„ï¼Œç®€åŒ–äº†å®¢æˆ·ç«¯ä»£ç ã€‚</li><li>åœ¨ç»„åˆæ¨¡å¼ä¸­å¢åŠ æ–°çš„æ ‘æèŠ‚ç‚¹å’Œå¶å­èŠ‚ç‚¹éƒ½å¾ˆæ–¹ä¾¿ï¼Œæ— é¡»å¯¹ç°æœ‰ç±»åº“è¿›è¡Œä»»ä½•ä¿®æ”¹ï¼Œç¬¦åˆâ€œå¼€é—­åŸåˆ™â€ã€‚</li><li>ç»„åˆæ¨¡å¼ä¸ºæ ‘å½¢ç»“æ„çš„é¢å‘å¯¹è±¡å®ç°æä¾›äº†ä¸€ç§çµæ´»çš„è§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡å¶å­èŠ‚ç‚¹å’Œæ ‘æèŠ‚ç‚¹çš„é€’å½’ç»„åˆï¼Œå¯ä»¥å½¢æˆå¤æ‚çš„æ ‘å½¢ç»“æ„ï¼Œä½†å¯¹æ ‘å½¢ç»“æ„çš„æ§åˆ¶å´éå¸¸ç®€å•ã€‚</li></ul></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//èœå•ç»„ä»¶  ä¸ç®¡æ˜¯èœå•è¿˜æ˜¯èœå•é¡¹ï¼Œéƒ½åº”è¯¥ç»§æ‰¿è¯¥ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">MenuComponent</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> String name;</span><br><span class="line">    <span class="keyword">protected</span> <span class="type">int</span> level;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ·»åŠ èœå•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(MenuComponent menuComponent)</span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">UnsupportedOperationException</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç§»é™¤èœå•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">remove</span><span class="params">(MenuComponent menuComponent)</span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">UnsupportedOperationException</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è·å–æŒ‡å®šçš„å­èœå•</span></span><br><span class="line">    <span class="keyword">public</span> MenuComponent <span class="title function_">getChild</span><span class="params">(<span class="type">int</span> i)</span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">UnsupportedOperationException</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è·å–èœå•åç§°</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">print</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">UnsupportedOperationException</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Menu</span> <span class="keyword">extends</span> <span class="title class_">MenuComponent</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;MenuComponent&gt; menuComponentList;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Menu</span><span class="params">(String name,<span class="type">int</span> level)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.level = level;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        menuComponentList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;MenuComponent&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(MenuComponent menuComponent)</span> &#123;</span><br><span class="line">        menuComponentList.add(menuComponent);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">remove</span><span class="params">(MenuComponent menuComponent)</span> &#123;</span><br><span class="line">        menuComponentList.remove(menuComponent);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> MenuComponent <span class="title function_">getChild</span><span class="params">(<span class="type">int</span> i)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> menuComponentList.get(i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">print</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; level; i++) &#123;</span><br><span class="line">            System.out.print(<span class="string">&quot;--&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(name);</span><br><span class="line">        <span class="keyword">for</span> (MenuComponent menuComponent : menuComponentList) &#123;</span><br><span class="line">            menuComponent.print();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MenuItem</span> <span class="keyword">extends</span> <span class="title class_">MenuComponent</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MenuItem</span><span class="params">(String name,<span class="type">int</span> level)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.level = level;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">print</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; level; i++) &#123;</span><br><span class="line">            System.out.print(<span class="string">&quot;--&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç»„åˆæ¨¡å¼çš„åˆ†ç±»</strong><br>åœ¨ä½¿ç”¨ç»„åˆæ¨¡å¼æ—¶ï¼Œæ ¹æ®æŠ½è±¡æ„ä»¶ç±»çš„å®šä¹‰å½¢å¼ï¼Œæˆ‘ä»¬å¯å°†ç»„åˆæ¨¡å¼åˆ†ä¸ºé€æ˜ç»„åˆæ¨¡å¼å’Œå®‰å…¨ç»„åˆæ¨¡å¼ä¸¤ç§å½¢å¼ã€‚</p><blockquote><p><strong>é€æ˜ç»„åˆæ¨¡å¼</strong></p><ul><li>é€æ˜ç»„åˆæ¨¡å¼ä¸­ï¼ŒæŠ½è±¡æ ¹èŠ‚ç‚¹è§’è‰²ä¸­å£°æ˜äº†æ‰€æœ‰ç”¨äºç®¡ç†æˆå‘˜å¯¹è±¡çš„æ–¹æ³•ï¼Œæ¯”å¦‚åœ¨ç¤ºä¾‹ä¸­ MenuComponent å£°æ˜äº† addã€remove ã€getChild æ–¹æ³•ï¼Œè¿™æ ·åšçš„å¥½å¤„æ˜¯ç¡®ä¿æ‰€æœ‰çš„æ„ä»¶ç±»éƒ½æœ‰ç›¸åŒçš„æ¥å£ã€‚é€æ˜ç»„åˆæ¨¡å¼ä¹Ÿæ˜¯ç»„åˆæ¨¡å¼çš„æ ‡å‡†å½¢å¼ã€‚</li><li>é€æ˜ç»„åˆæ¨¡å¼çš„ç¼ºç‚¹æ˜¯ä¸å¤Ÿå®‰å…¨ï¼Œå› ä¸ºå¶å­å¯¹è±¡å’Œå®¹å™¨å¯¹è±¡åœ¨æœ¬è´¨ä¸Šæ˜¯æœ‰åŒºåˆ«çš„ï¼Œå¶å­å¯¹è±¡ä¸å¯èƒ½æœ‰ä¸‹ä¸€ä¸ªå±‚æ¬¡çš„å¯¹è±¡ï¼Œå³ä¸å¯èƒ½åŒ…å«æˆå‘˜å¯¹è±¡ï¼Œå› æ­¤ä¸ºå…¶æä¾› add()ã€remove() ç­‰æ–¹æ³•æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œè¿™åœ¨ç¼–è¯‘é˜¶æ®µä¸ä¼šå‡ºé”™ï¼Œä½†åœ¨è¿è¡Œé˜¶æ®µå¦‚æœè°ƒç”¨è¿™äº›æ–¹æ³•å¯èƒ½ä¼šå‡ºé”™ï¼ˆå¦‚æœæ²¡æœ‰æä¾›ç›¸åº”çš„é”™è¯¯å¤„ç†ä»£ç ï¼‰</li></ul><p><strong>å®‰å…¨ç»„åˆæ¨¡å¼</strong></p><ul><li>åœ¨å®‰å…¨ç»„åˆæ¨¡å¼ä¸­ï¼Œåœ¨æŠ½è±¡æ„ä»¶è§’è‰²ä¸­æ²¡æœ‰å£°æ˜ä»»ä½•ç”¨äºç®¡ç†æˆå‘˜å¯¹è±¡çš„æ–¹æ³•ï¼Œè€Œæ˜¯åœ¨æ ‘æèŠ‚ç‚¹ Menu ç±»ä¸­å£°æ˜å¹¶å®ç°è¿™äº›æ–¹æ³•ã€‚å®‰å…¨ç»„åˆæ¨¡å¼çš„ç¼ºç‚¹æ˜¯ä¸å¤Ÿé€æ˜ï¼Œå› ä¸ºå¶å­æ„ä»¶å’Œå®¹å™¨æ„ä»¶å…·æœ‰ä¸åŒçš„æ–¹æ³•ï¼Œä¸”å®¹å™¨æ„ä»¶ä¸­é‚£äº›ç”¨äºç®¡ç†æˆå‘˜å¯¹è±¡çš„æ–¹æ³•æ²¡æœ‰åœ¨æŠ½è±¡æ„ä»¶ç±»ä¸­å®šä¹‰ï¼Œå› æ­¤å®¢æˆ·ç«¯ä¸èƒ½å®Œå…¨é’ˆå¯¹æŠ½è±¡ç¼–ç¨‹ï¼Œå¿…é¡»æœ‰åŒºåˆ«åœ°å¯¹å¾…å¶å­æ„ä»¶å’Œå®¹å™¨æ„ä»¶ã€‚</li></ul></blockquote><h3 id="3-2-7-äº«å…ƒæ¨¡å¼"><a href="#3-2-7-äº«å…ƒæ¨¡å¼" class="headerlink" title="3.2.7 äº«å…ƒæ¨¡å¼"></a>3.2.7 äº«å…ƒæ¨¡å¼</h3><p>è¿ç”¨å…±äº«æŠ€æœ¯æ¥æœ‰æ•ˆåœ°æ”¯æŒå¤§é‡ç»†ç²’åº¦å¯¹è±¡çš„å¤ç”¨ã€‚å®ƒé€šè¿‡å…±äº«å·²ç»å­˜åœ¨çš„å¯¹è±¡æ¥å¤§å¹…åº¦å‡å°‘éœ€è¦åˆ›å»ºçš„å¯¹è±¡æ•°é‡ã€é¿å…å¤§é‡ç›¸ä¼¼å¯¹è±¡çš„å¼€é”€ï¼Œä»è€Œæé«˜ç³»ç»Ÿèµ„æºçš„åˆ©ç”¨ç‡ã€‚é€šè¿‡å…±äº«çš„æ–¹å¼é«˜æ•ˆçš„æ”¯æŒå¤§é‡ç»†ç²’åº¦çš„å¯¹è±¡ã€‚</p><p>ä¸»è¦è§£å†³äº†åœ¨æœ‰å¤§é‡å¯¹è±¡æ—¶ï¼Œæœ‰å¯èƒ½ä¼šé€ æˆå†…å­˜æº¢å‡ºï¼Œæˆ‘ä»¬æŠŠå…¶ä¸­å…±åŒçš„éƒ¨åˆ†æŠ½è±¡å‡ºæ¥ï¼Œå¦‚æœæœ‰ç›¸åŒçš„ä¸šåŠ¡è¯·æ±‚ï¼Œç›´æ¥è¿”å›åœ¨å†…å­˜ä¸­å·²æœ‰çš„å¯¹è±¡ï¼Œé¿å…é‡æ–°åˆ›å»ºã€‚</p><p><strong>ç»“æ„ï¼š</strong></p><blockquote><ul><li>å†…éƒ¨çŠ¶æ€ï¼Œå³ä¸ä¼šéšç€ç¯å¢ƒçš„æ”¹å˜è€Œæ”¹å˜çš„å¯å…±äº«éƒ¨åˆ†</li><li>å¤–éƒ¨çŠ¶æ€ï¼ŒæŒ‡éšç¯å¢ƒæ”¹å˜è€Œæ”¹å˜çš„ä¸å¯ä»¥å…±äº«çš„éƒ¨åˆ†ã€‚äº«å…ƒæ¨¡å¼çš„å®ç°è¦é¢†å°±æ˜¯åŒºåˆ†åº”ç”¨ä¸­çš„è¿™ä¸¤ç§çŠ¶æ€ï¼Œå¹¶å°†å¤–éƒ¨çŠ¶æ€å¤–éƒ¨åŒ–ã€‚</li></ul></blockquote><p><strong>è§’è‰²ï¼š</strong></p><blockquote><ul><li><strong>æŠ½è±¡äº«å…ƒè§’è‰²ï¼ˆFlyweightï¼‰ï¼š</strong>é€šå¸¸æ˜¯ä¸€ä¸ªæ¥å£æˆ–æŠ½è±¡ç±»ï¼Œåœ¨æŠ½è±¡äº«å…ƒç±»ä¸­å£°æ˜äº†å…·ä½“äº«å…ƒç±»å…¬å…±çš„æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•å¯ä»¥å‘å¤–ç•Œæä¾›äº«å…ƒå¯¹è±¡çš„å†…éƒ¨æ•°æ®ï¼ˆå†…éƒ¨çŠ¶æ€ï¼‰ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥é€šè¿‡è¿™äº›æ–¹æ³•æ¥è®¾ç½®å¤–éƒ¨æ•°æ®ï¼ˆå¤–éƒ¨çŠ¶æ€ï¼‰ã€‚</li><li><strong>å…·ä½“äº«å…ƒï¼ˆConcrete Flyweightï¼‰è§’è‰² ï¼š</strong>å®ƒå®ç°äº†æŠ½è±¡äº«å…ƒç±»ï¼Œç§°ä¸ºäº«å…ƒå¯¹è±¡ï¼›åœ¨å…·ä½“äº«å…ƒç±»ä¸­ä¸ºå†…éƒ¨çŠ¶æ€æä¾›äº†å­˜å‚¨ç©ºé—´ã€‚é€šå¸¸æˆ‘ä»¬å¯ä»¥ç»“åˆå•ä¾‹æ¨¡å¼æ¥è®¾è®¡å…·ä½“äº«å…ƒç±»ï¼Œä¸ºæ¯ä¸€ä¸ªå…·ä½“äº«å…ƒç±»æä¾›å”¯ä¸€çš„äº«å…ƒå¯¹è±¡ã€‚</li><li><strong>éäº«å…ƒï¼ˆUnsharable Flyweight)è§’è‰² ï¼š</strong>å¹¶ä¸æ˜¯æ‰€æœ‰çš„æŠ½è±¡äº«å…ƒç±»çš„å­ç±»éƒ½éœ€è¦è¢«å…±äº«ï¼Œä¸èƒ½è¢«å…±äº«çš„å­ç±»å¯è®¾è®¡ä¸ºéå…±äº«å…·ä½“äº«å…ƒç±»ï¼›å½“éœ€è¦ä¸€ä¸ªéå…±äº«å…·ä½“äº«å…ƒç±»çš„å¯¹è±¡æ—¶å¯ä»¥ç›´æ¥é€šè¿‡å®ä¾‹åŒ–åˆ›å»ºã€‚</li><li><strong>äº«å…ƒå·¥å‚ï¼ˆFlyweight Factoryï¼‰è§’è‰² ï¼š</strong>è´Ÿè´£åˆ›å»ºå’Œç®¡ç†äº«å…ƒè§’è‰²ã€‚å½“å®¢æˆ·å¯¹è±¡è¯·æ±‚ä¸€ä¸ªäº«å…ƒå¯¹è±¡æ—¶ï¼Œäº«å…ƒå·¥å‚æ£€æŸ»ç³»ç»Ÿä¸­æ˜¯å¦å­˜åœ¨ç¬¦åˆè¦æ±‚çš„äº«å…ƒå¯¹è±¡ï¼Œå¦‚æœå­˜åœ¨åˆ™æä¾›ç»™å®¢æˆ·ï¼›å¦‚æœä¸å­˜åœ¨çš„è¯ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„äº«å…ƒå¯¹è±¡ã€‚</li></ul></blockquote><p><strong>ä¾‹å­ï¼š</strong><br>ä¸‹é¢çš„å›¾ç‰‡æ˜¯ä¼—æ‰€å‘¨çŸ¥çš„ä¿„ç½—æ–¯æ–¹å—ä¸­çš„ä¸€ä¸ªä¸ªæ–¹å—ï¼Œå¦‚æœåœ¨ä¿„ç½—æ–¯æ–¹å—è¿™ä¸ªæ¸¸æˆä¸­ï¼Œæ¯ä¸ªä¸åŒçš„æ–¹å—éƒ½æ˜¯ä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡å°±è¦å ç”¨å¾ˆå¤šçš„å†…å­˜ç©ºé—´ï¼Œä¸‹é¢åˆ©ç”¨äº«å…ƒæ¨¡å¼è¿›è¡Œå®ç°ã€‚</p><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F-%E4%BE%8B%E5%AD%90.png" class="" title="äº«å…ƒæ¨¡å¼-ä¾‹å­"><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F-%E4%BE%8B%E5%AD%90%E7%B1%BB%E5%9B%BE.png" class="" title="äº«å…ƒæ¨¡å¼-ä¾‹å­ç±»å›¾"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä¿„ç½—æ–¯æ–¹å—æœ‰ä¸åŒçš„å½¢çŠ¶ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹è¿™äº›å½¢çŠ¶å‘ä¸ŠæŠ½å–å‡ºAbstractBoxï¼Œç”¨æ¥å®šä¹‰å…±æ€§çš„å±æ€§å’Œè¡Œä¸ºã€‚</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">AbstractBox</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> String <span class="title function_">getShape</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">display</span><span class="params">(String color)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ–¹å—å½¢çŠ¶ï¼š&quot;</span> + <span class="built_in">this</span>.getShape() + <span class="string">&quot; é¢œè‰²ï¼š&quot;</span> + color);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ¥ä¸‹æ¥å°±æ˜¯å®šä¹‰ä¸åŒçš„å½¢çŠ¶äº†ï¼ŒIBoxç±»ã€LBoxç±»ã€OBoxç±»ç­‰ã€‚</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IBox</span> <span class="keyword">extends</span> <span class="title class_">AbstractBox</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getShape</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;I&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LBox</span> <span class="keyword">extends</span> <span class="title class_">AbstractBox</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getShape</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;L&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OBox</span> <span class="keyword">extends</span> <span class="title class_">AbstractBox</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getShape</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;O&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æä¾›äº†ä¸€ä¸ªå·¥å‚ç±»ï¼ˆBoxFactoryï¼‰ï¼Œç”¨æ¥ç®¡ç†äº«å…ƒå¯¹è±¡ï¼ˆä¹Ÿå°±æ˜¯AbstractBoxå­ç±»å¯¹è±¡ï¼‰ï¼Œè¯¥å·¥å‚ç±»å¯¹è±¡åªéœ€è¦ä¸€ä¸ªï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨å•ä¾‹æ¨¡å¼ã€‚å¹¶ç»™å·¥å‚ç±»æä¾›ä¸€ä¸ªè·å–å½¢çŠ¶çš„æ–¹æ³•ã€‚</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BoxFactory</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> HashMap&lt;String, AbstractBox&gt; map;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">BoxFactory</span><span class="params">()</span> &#123;</span><br><span class="line">        map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String, AbstractBox&gt;();</span><br><span class="line">        <span class="type">AbstractBox</span> <span class="variable">iBox</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IBox</span>();</span><br><span class="line">        <span class="type">AbstractBox</span> <span class="variable">lBox</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LBox</span>();</span><br><span class="line">        <span class="type">AbstractBox</span> <span class="variable">oBox</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OBox</span>();</span><br><span class="line">        map.put(<span class="string">&quot;I&quot;</span>, iBox);</span><br><span class="line">        map.put(<span class="string">&quot;L&quot;</span>, lBox);</span><br><span class="line">        map.put(<span class="string">&quot;O&quot;</span>, oBox);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> BoxFactory <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> SingletonHolder.INSTANCE;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">SingletonHolder</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">BoxFactory</span> <span class="variable">INSTANCE</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BoxFactory</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> AbstractBox <span class="title function_">getBox</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> map.get(key);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>ä¼˜ç¼ºç‚¹</strong></p><blockquote><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>æå¤§å‡å°‘å†…å­˜ä¸­ç›¸ä¼¼æˆ–ç›¸åŒå¯¹è±¡æ•°é‡ï¼ŒèŠ‚çº¦ç³»ç»Ÿèµ„æºï¼Œæä¾›ç³»ç»Ÿæ€§èƒ½</li><li>äº«å…ƒæ¨¡å¼ä¸­çš„å¤–éƒ¨çŠ¶æ€ç›¸å¯¹ç‹¬ç«‹ï¼Œä¸”ä¸å½±å“å†…éƒ¨çŠ¶æ€</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>ä¸ºäº†ä½¿å¯¹è±¡å¯ä»¥å…±äº«ï¼Œéœ€è¦å°†äº«å…ƒå¯¹è±¡çš„éƒ¨åˆ†çŠ¶æ€å¤–éƒ¨åŒ–ï¼Œåˆ†ç¦»å†…éƒ¨çŠ¶æ€å’Œå¤–éƒ¨çŠ¶æ€ï¼Œä½¿ç¨‹åºé€»è¾‘å¤æ‚</li></ul></blockquote><p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p><blockquote><ul><li>ä¸€ä¸ªç³»ç»Ÿæœ‰å¤§é‡ç›¸åŒæˆ–è€…ç›¸ä¼¼çš„å¯¹è±¡ï¼Œé€ æˆå†…å­˜çš„å¤§é‡è€—è´¹ã€‚</li><li>å¯¹è±¡çš„å¤§éƒ¨åˆ†çŠ¶æ€éƒ½å¯ä»¥å¤–éƒ¨åŒ–ï¼Œå¯ä»¥å°†è¿™äº›å¤–éƒ¨çŠ¶æ€ä¼ å…¥å¯¹è±¡ä¸­ã€‚</li><li>åœ¨ä½¿ç”¨äº«å…ƒæ¨¡å¼æ—¶éœ€è¦ç»´æŠ¤ä¸€ä¸ªå­˜å‚¨äº«å…ƒå¯¹è±¡çš„äº«å…ƒæ± ï¼Œè€Œè¿™éœ€è¦è€—è´¹ä¸€å®šçš„ç³»ç»Ÿèµ„æºï¼Œå› æ­¤ï¼Œåº”å½“åœ¨éœ€è¦å¤šæ¬¡é‡å¤ä½¿ç”¨äº«å…ƒå¯¹è±¡æ—¶æ‰å€¼å¾—ä½¿ç”¨äº«å…ƒæ¨¡å¼ã€‚</li></ul></blockquote><h2 id="3-3-è¡Œä¸ºå‹æ¨¡å¼"><a href="#3-3-è¡Œä¸ºå‹æ¨¡å¼" class="headerlink" title="3.3 è¡Œä¸ºå‹æ¨¡å¼"></a><em>3.3 è¡Œä¸ºå‹æ¨¡å¼</em></h2><hr><h3 id="3-3-1-ç­–ç•¥æ¨¡å¼"><a href="#3-3-1-ç­–ç•¥æ¨¡å¼" class="headerlink" title="3.3.1 ç­–ç•¥æ¨¡å¼"></a>3.3.1 ç­–ç•¥æ¨¡å¼</h3><blockquote><p>å°±åƒå‡ºè¡Œå¯ä»¥é€‰æ‹©å¤šç§å‡ºè¡Œæ–¹å¼ï¼Œç¨‹åºå‘˜å¯ä»¥é€‰æ‹©å¤šç§IDEå·¥å…·ä¸€æ ·</p></blockquote><p>è¯¥æ¨¡å¼å®šä¹‰äº†ä¸€ç³»åˆ—ç®—æ³•ï¼Œå¹¶<strong>å°†æ¯ä¸ªç®—æ³•å°è£…èµ·æ¥ï¼Œä½¿å®ƒä»¬å¯ä»¥ç›¸äº’æ›¿æ¢ï¼Œä¸”ç®—æ³•çš„å˜åŒ–ä¸ä¼šå½±å“ä½¿ç”¨ç®—æ³•çš„å®¢æˆ·</strong>ã€‚ç­–ç•¥æ¨¡å¼å±äºå¯¹è±¡è¡Œä¸ºæ¨¡å¼ï¼Œå®ƒé€šè¿‡å¯¹ç®—æ³•è¿›è¡Œå°è£…ï¼ŒæŠŠä½¿ç”¨ç®—æ³•çš„è´£ä»»å’Œç®—æ³•çš„å®ç°åˆ†å‰²å¼€æ¥ï¼Œå¹¶å§”æ´¾ç»™ä¸åŒçš„å¯¹è±¡å¯¹è¿™äº›ç®—æ³•è¿›è¡Œç®¡ç†ã€‚</p><p><strong>ç»“æ„ï¼š</strong></p><blockquote><ul><li><strong>æŠ½è±¡ç­–ç•¥ï¼ˆStrategyï¼‰ç±»ï¼š</strong>è¿™æ˜¯ä¸€ä¸ªæŠ½è±¡è§’è‰²ï¼Œé€šå¸¸ç”±ä¸€ä¸ªæ¥å£æˆ–æŠ½è±¡ç±»å®ç°ã€‚æ­¤è§’è‰²ç»™å‡ºæ‰€æœ‰çš„å…·ä½“ç­–ç•¥ç±»æ‰€éœ€çš„æ¥å£ã€‚</li><li><strong>å…·ä½“ç­–ç•¥ï¼ˆConcrete Strategyï¼‰ç±»ï¼š</strong>å®ç°äº†æŠ½è±¡ç­–ç•¥å®šä¹‰çš„æ¥å£ï¼Œæä¾›å…·ä½“çš„ç®—æ³•å®ç°æˆ–è¡Œä¸ºã€‚</li><li><strong>ç¯å¢ƒï¼ˆContextï¼‰ç±»ï¼š</strong>æŒæœ‰ä¸€ä¸ªç­–ç•¥ç±»çš„å¼•ç”¨ï¼Œæœ€ç»ˆç»™å®¢æˆ·ç«¯è°ƒç”¨ã€‚</li></ul></blockquote><p><strong>ä¾‹å­ï¼š</strong><br>ä¸€å®¶ç™¾è´§å…¬å¸åœ¨å®šå¹´åº¦çš„ä¿ƒé”€æ´»åŠ¨ã€‚é’ˆå¯¹ä¸åŒçš„èŠ‚æ—¥ï¼ˆæ˜¥èŠ‚ã€ä¸­ç§‹èŠ‚ã€åœ£è¯èŠ‚ï¼‰æ¨å‡ºä¸åŒçš„ä¿ƒé”€æ´»åŠ¨ï¼Œç”±ä¿ƒé”€å‘˜å°†ä¿ƒé”€æ´»åŠ¨å±•ç¤ºç»™å®¢æˆ·ã€‚ç±»å›¾å¦‚ä¸‹ï¼š</p><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F.png" class="" title="ç­–ç•¥æ¨¡å¼"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å®šä¹‰ç™¾è´§å…¬å¸æ‰€æœ‰ä¿ƒé”€æ´»åŠ¨çš„å…±åŒæ¥å£</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Strategy</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">show</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸ºæ˜¥èŠ‚å‡†å¤‡çš„ä¿ƒé”€æ´»åŠ¨A</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StrategyA</span> <span class="keyword">implements</span> <span class="title class_">Strategy</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">show</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¹°ä¸€é€ä¸€&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸ºä¸­ç§‹å‡†å¤‡çš„ä¿ƒé”€æ´»åŠ¨B</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StrategyB</span> <span class="keyword">implements</span> <span class="title class_">Strategy</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">show</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ»¡200å…ƒå‡50å…ƒ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸ºåœ£è¯å‡†å¤‡çš„ä¿ƒé”€æ´»åŠ¨C</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StrategyC</span> <span class="keyword">implements</span> <span class="title class_">Strategy</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">show</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ»¡1000å…ƒåŠ ä¸€å…ƒæ¢è´­ä»»æ„200å…ƒä»¥ä¸‹å•†å“&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®šä¹‰ç¯å¢ƒè§’è‰²ï¼ˆContextï¼‰ï¼šç”¨äºè¿æ¥ä¸Šä¸‹æ–‡ï¼Œå³æŠŠä¿ƒé”€æ´»åŠ¨æ¨é”€ç»™å®¢æˆ·ï¼Œè¿™é‡Œå¯ä»¥ç†è§£ä¸ºé”€å”®å‘˜</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SalesMan</span> &#123;                        </span><br><span class="line">    <span class="comment">//æŒæœ‰æŠ½è±¡ç­–ç•¥è§’è‰²çš„å¼•ç”¨                              </span></span><br><span class="line">    <span class="keyword">private</span> Strategy strategy;                 </span><br><span class="line">                                               </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">SalesMan</span><span class="params">(Strategy strategy)</span> &#123;       </span><br><span class="line">        <span class="built_in">this</span>.strategy = strategy;              </span><br><span class="line">    &#125;                                          </span><br><span class="line">                                               </span><br><span class="line">    <span class="comment">//å‘å®¢æˆ·å±•ç¤ºä¿ƒé”€æ´»åŠ¨                                </span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">salesManShow</span><span class="params">()</span>&#123;                </span><br><span class="line">        strategy.show();                       </span><br><span class="line">    &#125;                                          </span><br><span class="line">&#125;        </span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>ä¼˜ç¼ºç‚¹</strong></p><blockquote><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>ç­–ç•¥ç±»ä¹‹é—´å¯ä»¥è‡ªç”±åˆ‡æ¢ï¼šç”±äºç­–ç•¥ç±»éƒ½å®ç°åŒä¸€ä¸ªæ¥å£ï¼Œæ‰€ä»¥ä½¿å®ƒä»¬ä¹‹é—´å¯ä»¥è‡ªç”±åˆ‡æ¢ã€‚</li><li>æ˜“äºæ‰©å±•ï¼šå¢åŠ ä¸€ä¸ªæ–°çš„ç­–ç•¥åªéœ€è¦æ·»åŠ ä¸€ä¸ªå…·ä½“çš„ç­–ç•¥ç±»å³å¯ï¼ŒåŸºæœ¬ä¸éœ€è¦æ”¹å˜åŸæœ‰çš„ä»£ç ï¼Œç¬¦åˆâ€œå¼€é—­åŸåˆ™â€</li><li>é¿å…ä½¿ç”¨å¤šé‡æ¡ä»¶é€‰æ‹©è¯­å¥ï¼ˆif elseï¼‰ï¼Œå……åˆ†ä½“ç°é¢å‘å¯¹è±¡è®¾è®¡æ€æƒ³ã€‚</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>å®¢æˆ·ç«¯å¿…é¡»çŸ¥é“æ‰€æœ‰çš„ç­–ç•¥ç±»ï¼Œå¹¶è‡ªè¡Œå†³å®šä½¿ç”¨å“ªä¸€ä¸ªç­–ç•¥ç±»ã€‚</li><li>ç­–ç•¥æ¨¡å¼å°†é€ æˆäº§ç”Ÿå¾ˆå¤šç­–ç•¥ç±»ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨äº«å…ƒæ¨¡å¼åœ¨ä¸€å®šç¨‹åº¦ä¸Šå‡å°‘å¯¹è±¡çš„æ•°é‡ã€‚</li></ul></blockquote><p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p><blockquote><ul><li>ä¸€ä¸ªç³»ç»Ÿéœ€è¦åŠ¨æ€åœ°åœ¨å‡ ç§ç®—æ³•ä¸­é€‰æ‹©ä¸€ç§æ—¶ï¼Œå¯å°†æ¯ä¸ªç®—æ³•å°è£…åˆ°ç­–ç•¥ç±»ä¸­ã€‚</li><li>ä¸€ä¸ªç±»å®šä¹‰äº†å¤šç§è¡Œä¸ºï¼Œå¹¶ä¸”è¿™äº›è¡Œä¸ºåœ¨è¿™ä¸ªç±»çš„æ“ä½œä¸­ä»¥å¤šä¸ªæ¡ä»¶è¯­å¥çš„å½¢å¼å‡ºç°ï¼Œå¯å°†æ¯ä¸ªæ¡ä»¶åˆ†æ”¯ç§»å…¥å®ƒä»¬å„è‡ªçš„ç­–ç•¥ç±»ä¸­ä»¥ä»£æ›¿è¿™äº›æ¡ä»¶è¯­å¥ã€‚</li><li>ç³»ç»Ÿä¸­å„ç®—æ³•å½¼æ­¤å®Œå…¨ç‹¬ç«‹ï¼Œä¸”è¦æ±‚å¯¹å®¢æˆ·éšè—å…·ä½“ç®—æ³•çš„å®ç°ç»†èŠ‚æ—¶ã€‚</li><li>ç³»ç»Ÿè¦æ±‚ä½¿ç”¨ç®—æ³•çš„å®¢æˆ·ä¸åº”è¯¥çŸ¥é“å…¶æ“ä½œçš„æ•°æ®æ—¶ï¼Œå¯ä½¿ç”¨ç­–ç•¥æ¨¡å¼æ¥éšè—ä¸ç®—æ³•ç›¸å…³çš„æ•°æ®ç»“æ„ã€‚</li><li>å¤šä¸ªç±»åªåŒºåˆ«åœ¨è¡¨ç°è¡Œä¸ºä¸åŒï¼Œå¯ä»¥ä½¿ç”¨ç­–ç•¥æ¨¡å¼ï¼Œåœ¨è¿è¡Œæ—¶åŠ¨æ€é€‰æ‹©å…·ä½“è¦æ‰§è¡Œçš„è¡Œä¸ºã€‚</li></ul></blockquote><h3 id="3-3-2-æ¨¡æ¿æ¨¡å¼"><a href="#3-3-2-æ¨¡æ¿æ¨¡å¼" class="headerlink" title="3.3.2 æ¨¡æ¿æ¨¡å¼"></a>3.3.2 æ¨¡æ¿æ¨¡å¼</h3><p><strong>å®šä¹‰ï¼š</strong></p><blockquote><p><strong>å®šä¹‰ä¸€ä¸ªæ“ä½œä¸­ç®—æ³•çš„éª¨æ¶ï¼Œè€Œå°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ï¼Œ</strong>æ¨¡æ¿æ–¹æ³•ä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜ç®—æ³•çš„ç»“æ„å³å¯é‡å®šä¹‰è¯¥ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤ã€‚<br><strong>é€šä¿—ç‚¹çš„ç†è§£å°±æ˜¯ï¼š</strong>å®Œæˆä¸€ä»¶äº‹æƒ…ï¼Œæœ‰å›ºå®šçš„æ•°ä¸ªæ­¥éª¤ï¼Œä½†æ˜¯æ¯ä¸ªæ­¥éª¤æ ¹æ®å¯¹è±¡çš„ä¸åŒï¼Œè€Œå®ç°ç»†èŠ‚ä¸åŒï¼›å°±å¯ä»¥åœ¨çˆ¶ç±»ä¸­å®šä¹‰ä¸€ä¸ªå®Œæˆè¯¥äº‹æƒ…çš„æ€»æ–¹æ³•ï¼ŒæŒ‰ç…§å®Œæˆäº‹ä»¶éœ€è¦çš„æ­¥éª¤å»è°ƒç”¨å…¶æ¯ä¸ªæ­¥éª¤çš„å®ç°æ–¹æ³•ã€‚æ¯ä¸ªæ­¥éª¤çš„å…·ä½“å®ç°ï¼Œç”±å­ç±»å®Œæˆã€‚</p></blockquote><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%A8%A1%E6%9D%BF%E6%A8%A1%E5%BC%8F.png" class="" title="æ¨¡æ¿æ¨¡å¼"><p><strong>ç»“æ„ï¼š</strong></p><blockquote><p><strong>æŠ½è±¡ç±»ï¼ˆAbstract Classï¼‰ï¼š</strong>è´Ÿè´£ç»™å‡ºä¸€ä¸ªç®—æ³•çš„è½®å»“å’Œéª¨æ¶ã€‚å®ƒç”±ä¸€ä¸ªæ¨¡æ¿æ–¹æ³•å’Œè‹¥å¹²ä¸ªåŸºæœ¬æ–¹æ³•æ„æˆã€‚</p><ul><li><p>æ¨¡æ¿æ–¹æ³•ï¼š å®šä¹‰äº†ç®—æ³•çš„éª¨æ¶ï¼ŒæŒ‰æŸç§é¡ºåºè°ƒç”¨å…¶åŒ…å«çš„åŸºæœ¬æ–¹æ³•ã€‚</p></li><li><p>åŸºæœ¬æ–¹æ³•ï¼š æ˜¯å®ç°ç®—æ³•å„ä¸ªæ­¥éª¤çš„æ–¹æ³•ï¼Œæ˜¯æ¨¡æ¿æ–¹æ³•çš„ç»„æˆéƒ¨åˆ†ã€‚åŸºæœ¬æ–¹æ³•åˆå¯ä»¥åˆ†ä¸ºä¸‰ç§ï¼š</p><ol><li><strong>æŠ½è±¡æ–¹æ³•(Abstract Method) ï¼š</strong>ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ç”±æŠ½è±¡ç±»å£°æ˜ã€ç”±å…¶å…·ä½“å­ç±»å®ç°ã€‚</li><li><strong>å…·ä½“æ–¹æ³•(Concrete Method) ï¼š</strong>ä¸€ä¸ªå…·ä½“æ–¹æ³•ç”±ä¸€ä¸ªæŠ½è±¡ç±»æˆ–å…·ä½“ç±»å£°æ˜å¹¶å®ç°ï¼Œå…¶å­ç±»å¯ä»¥è¿›è¡Œè¦†ç›–ä¹Ÿå¯ä»¥ç›´æ¥ç»§æ‰¿ã€‚</li><li><strong>é’©å­æ–¹æ³•(Hook Method) ï¼š</strong>åœ¨æŠ½è±¡ç±»ä¸­å·²ç»å®ç°ï¼ŒåŒ…æ‹¬ç”¨äºåˆ¤æ–­çš„é€»è¾‘æ–¹æ³•å’Œéœ€è¦å­ç±»é‡å†™çš„ç©ºæ–¹æ³•ä¸¤ç§ã€‚ä¸€èˆ¬é’©å­æ–¹æ³•æ˜¯ç”¨äºåˆ¤æ–­çš„é€»è¾‘æ–¹æ³•ï¼Œè¿™ç±»æ–¹æ³•åä¸€èˆ¬ä¸ºisXxxï¼Œè¿”å›å€¼ç±»å‹ä¸ºbooleanç±»å‹ã€‚</li></ol></li></ul><p><strong>å…·ä½“å­ç±»ï¼ˆConcrete Classï¼‰ï¼š</strong>å®ç°æŠ½è±¡ç±»ä¸­æ‰€å®šä¹‰çš„æŠ½è±¡æ–¹æ³•å’Œé’©å­æ–¹æ³•ï¼Œå®ƒä»¬æ˜¯ä¸€ä¸ªé¡¶çº§é€»è¾‘çš„ç»„æˆæ­¥éª¤ã€‚</p></blockquote><p><strong>ä¾‹å­ï¼š</strong><br>ç‚’èœçš„æ­¥éª¤æ˜¯å›ºå®šçš„ï¼Œåˆ†ä¸ºå€’æ²¹ã€çƒ­æ²¹ã€å€’è”¬èœã€å€’è°ƒæ–™å“ã€ç¿»ç‚’ç­‰æ­¥éª¤ã€‚ç°é€šè¿‡æ¨¡æ¿æ–¹æ³•æ¨¡å¼æ¥ç”¨ä»£ç æ¨¡æ‹Ÿã€‚ç±»å›¾å¦‚ä¸‹ï¼š</p><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%A8%A1%E6%9D%BF%E6%A8%A1%E5%BC%8F-%E4%BE%8B%E5%AD%90%E7%B1%BB%E5%9B%BE.png" class="" title="æ¨¡æ¿æ¨¡å¼-ä¾‹å­ç±»å›¾"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">AbstractClass</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">cookProcess</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//ç¬¬ä¸€æ­¥ï¼šå€’æ²¹</span></span><br><span class="line">        <span class="built_in">this</span>.pourOil();</span><br><span class="line">        <span class="comment">//ç¬¬äºŒæ­¥ï¼šçƒ­æ²¹</span></span><br><span class="line">        <span class="built_in">this</span>.heatOil();</span><br><span class="line">        <span class="comment">//ç¬¬ä¸‰æ­¥ï¼šå€’è”¬èœ</span></span><br><span class="line">        <span class="built_in">this</span>.pourVegetable();</span><br><span class="line">        <span class="comment">//ç¬¬å››æ­¥ï¼šå€’è°ƒå‘³æ–™</span></span><br><span class="line">        <span class="built_in">this</span>.pourSauce();</span><br><span class="line">        <span class="comment">//ç¬¬äº”æ­¥ï¼šç¿»ç‚’</span></span><br><span class="line">        <span class="built_in">this</span>.fry();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pourOil</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å€’æ²¹&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç¬¬äºŒæ­¥ï¼šçƒ­æ²¹æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥ç›´æ¥å®ç°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">heatOil</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;çƒ­æ²¹&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç¬¬ä¸‰æ­¥ï¼šå€’è”¬èœæ˜¯ä¸ä¸€æ ·çš„ï¼ˆä¸€ä¸ªä¸‹åŒ…èœï¼Œä¸€ä¸ªæ˜¯ä¸‹èœå¿ƒï¼‰</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">pourVegetable</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç¬¬å››æ­¥ï¼šå€’è°ƒå‘³æ–™æ˜¯ä¸ä¸€æ ·</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">pourSauce</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç¬¬äº”æ­¥ï¼šç¿»ç‚’æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥ç›´æ¥å®ç°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">fry</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç‚’å•Šç‚’å•Šç‚’åˆ°ç†Ÿå•Š&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConcreteClass_BaoCai</span> <span class="keyword">extends</span> <span class="title class_">AbstractClass</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pourVegetable</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸‹é”…çš„è”¬èœæ˜¯åŒ…èœ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pourSauce</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸‹é”…çš„é…±æ–™æ˜¯è¾£æ¤’&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConcreteClass_CaiXin</span> <span class="keyword">extends</span> <span class="title class_">AbstractClass</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pourVegetable</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸‹é”…çš„è”¬èœæ˜¯èœå¿ƒ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pourSauce</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸‹é”…çš„é…±æ–™æ˜¯è’œè“‰&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//ç‚’æ‰‹æ’•åŒ…èœ</span></span><br><span class="line">        <span class="type">ConcreteClass_BaoCai</span> <span class="variable">baoCai</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConcreteClass_BaoCai</span>();</span><br><span class="line">        baoCai.cookProcess();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç‚’è’œè“‰èœå¿ƒ</span></span><br><span class="line">        <span class="type">ConcreteClass_CaiXin</span> <span class="variable">caiXin</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConcreteClass_CaiXin</span>();</span><br><span class="line">        caiXin.cookProcess();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><strong>æ³¨æ„ï¼šä¸ºé˜²æ­¢æ¶æ„æ“ä½œï¼Œä¸€èˆ¬æ¨¡æ¿æ–¹æ³•éƒ½åŠ ä¸Š final å…³é”®è¯ã€‚</strong></p></blockquote><p><strong>ä¼˜ç¼ºç‚¹</strong></p><blockquote><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>æé«˜ä»£ç å¤ç”¨æ€§ï¼šå°†ç›¸åŒéƒ¨åˆ†çš„ä»£ç æ”¾åœ¨æŠ½è±¡çš„çˆ¶ç±»ä¸­ï¼Œè€Œå°†ä¸åŒçš„ä»£ç æ”¾å…¥ä¸åŒçš„å­ç±»ä¸­ã€‚</li><li>å®ç°äº†åå‘æ§åˆ¶ï¼šé€šè¿‡ä¸€ä¸ªçˆ¶ç±»è°ƒç”¨å…¶å­ç±»çš„æ“ä½œï¼Œé€šè¿‡å¯¹å­ç±»çš„å…·ä½“å®ç°æ‰©å±•ä¸åŒçš„è¡Œä¸ºï¼Œå®ç°äº†åå‘æ§åˆ¶ ï¼Œå¹¶ç¬¦åˆâ€œå¼€é—­åŸåˆ™â€ã€‚</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>å¯¹æ¯ä¸ªä¸åŒçš„å®ç°éƒ½éœ€è¦å®šä¹‰ä¸€ä¸ªå­ç±»ï¼Œè¿™ä¼šå¯¼è‡´ç±»çš„ä¸ªæ•°å¢åŠ ï¼Œç³»ç»Ÿæ›´åŠ åºå¤§ï¼Œè®¾è®¡ä¹Ÿæ›´åŠ æŠ½è±¡ã€‚</li><li>çˆ¶ç±»ä¸­çš„æŠ½è±¡æ–¹æ³•ç”±å­ç±»å®ç°ï¼Œå­ç±»æ‰§è¡Œçš„ç»“æœä¼šå½±å“çˆ¶ç±»çš„ç»“æœï¼Œè¿™å¯¼è‡´ä¸€ç§åå‘çš„æ§åˆ¶ç»“æ„ï¼Œå®ƒæé«˜äº†ä»£ç é˜…è¯»çš„éš¾åº¦ã€‚</li></ul></blockquote><p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p><blockquote><ul><li>ç®—æ³•çš„æ•´ä½“æ­¥éª¤å¾ˆå›ºå®šï¼Œä½†å…¶ä¸­ä¸ªåˆ«éƒ¨åˆ†æ˜“å˜æ—¶ï¼Œè¿™æ—¶å€™å¯ä»¥ä½¿ç”¨æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼Œå°†å®¹æ˜“å˜çš„éƒ¨åˆ†æŠ½è±¡å‡ºæ¥ï¼Œä¾›å­ç±»å®ç°ã€‚</li><li>éœ€è¦é€šè¿‡å­ç±»æ¥å†³å®šçˆ¶ç±»ç®—æ³•ä¸­æŸä¸ªæ­¥éª¤æ˜¯å¦æ‰§è¡Œï¼Œå®ç°å­ç±»å¯¹çˆ¶ç±»çš„åå‘æ§åˆ¶ã€‚</li></ul></blockquote><h3 id="3-3-3-è§‚å¯Ÿè€…æ¨¡å¼"><a href="#3-3-3-è§‚å¯Ÿè€…æ¨¡å¼" class="headerlink" title="3.3.3 è§‚å¯Ÿè€…æ¨¡å¼"></a>3.3.3 è§‚å¯Ÿè€…æ¨¡å¼</h3><p><strong>å®šä¹‰ï¼š</strong><br>åˆè¢«ç§°ä¸ºå‘å¸ƒ-è®¢é˜…ï¼ˆPublish&#x2F;Subscribeï¼‰æ¨¡å¼ï¼Œå®ƒå®šä¹‰äº†ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œè®©å¤šä¸ªè§‚å¯Ÿè€…å¯¹è±¡åŒæ—¶ç›‘å¬æŸä¸€ä¸ªä¸»é¢˜å¯¹è±¡ã€‚è¿™ä¸ªä¸»é¢˜å¯¹è±¡åœ¨çŠ¶æ€å˜åŒ–æ—¶ï¼Œä¼šé€šçŸ¥æ‰€æœ‰çš„è§‚å¯Ÿè€…å¯¹è±¡ï¼Œä½¿ä»–ä»¬èƒ½å¤Ÿè‡ªåŠ¨æ›´æ–°è‡ªå·±ã€‚</p><p><strong>ç»“æ„ï¼š</strong></p><blockquote><ul><li><strong>Subjectï¼šæŠ½è±¡ä¸»é¢˜ï¼ˆæŠ½è±¡è¢«è§‚å¯Ÿè€…ï¼‰</strong>ï¼ŒæŠ½è±¡ä¸»é¢˜è§’è‰²æŠŠæ‰€æœ‰è§‚å¯Ÿè€…å¯¹è±¡ä¿å­˜åœ¨ä¸€ä¸ªé›†åˆé‡Œï¼Œæ¯ä¸ªä¸»é¢˜éƒ½å¯ä»¥æœ‰ä»»æ„æ•°é‡çš„è§‚å¯Ÿè€…ï¼ŒæŠ½è±¡ä¸»é¢˜æä¾›ä¸€ä¸ªæ¥å£ï¼Œå¯ä»¥å¢åŠ å’Œåˆ é™¤è§‚å¯Ÿè€…å¯¹è±¡ã€‚</li><li><strong>ConcreteSubjectï¼šå…·ä½“ä¸»é¢˜ï¼ˆå…·ä½“è¢«è§‚å¯Ÿè€…ï¼‰</strong>ï¼Œè¯¥è§’è‰²å°†æœ‰å…³çŠ¶æ€å­˜å…¥å…·ä½“è§‚å¯Ÿè€…å¯¹è±¡ï¼Œåœ¨å…·ä½“ä¸»é¢˜çš„å†…éƒ¨çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œç»™æ‰€æœ‰æ³¨å†Œè¿‡çš„è§‚å¯Ÿè€…å‘é€é€šçŸ¥ã€‚</li><li><strong>Observerï¼šæŠ½è±¡è§‚å¯Ÿè€…</strong>ï¼Œæ˜¯è§‚å¯Ÿè€…çš„æŠ½è±¡ç±»ï¼Œå®ƒå®šä¹‰äº†ä¸€ä¸ªæ›´æ–°æ¥å£ï¼Œä½¿å¾—åœ¨å¾—åˆ°ä¸»é¢˜æ›´æ”¹é€šçŸ¥æ—¶æ›´æ–°è‡ªå·±ã€‚</li><li><strong>ConcrereObserverï¼šå…·ä½“è§‚å¯Ÿè€…</strong>ï¼Œå®ç°æŠ½è±¡è§‚å¯Ÿè€…å®šä¹‰çš„æ›´æ–°æ¥å£ï¼Œä»¥ä¾¿åœ¨å¾—åˆ°ä¸»é¢˜æ›´æ”¹é€šçŸ¥æ—¶æ›´æ–°è‡ªèº«çš„çŠ¶æ€ã€‚</li></ul></blockquote><p><strong>ä¾‹å­ï¼š</strong><br>æœ‰ä¸€ä¸ªå¾®ä¿¡å…¬ä¼—å·æœåŠ¡ï¼Œä¸å®šæ—¶å‘å¸ƒä¸€äº›æ¶ˆæ¯ï¼Œå…³æ³¨å…¬ä¼—å·å°±å¯ä»¥æ”¶åˆ°æ¨é€æ¶ˆæ¯ï¼Œå–æ¶ˆå…³æ³¨å°±æ”¶ä¸åˆ°æ¨é€æ¶ˆæ¯ã€‚</p><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F-%E4%BE%8B%E5%AD%90.png" class="" title="è§‚å¯Ÿè€…æ¨¡å¼-ä¾‹å­"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰æŠ½è±¡è§‚å¯Ÿè€…ç±»ï¼Œé‡Œé¢å®šä¹‰ä¸€ä¸ªæ›´æ–°çš„æ–¹æ³•</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Observer</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(String message)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰å…·ä½“è§‚å¯Ÿè€…ç±»ï¼Œå¾®ä¿¡ç”¨æˆ·æ˜¯è§‚å¯Ÿè€…ï¼Œé‡Œé¢å®ç°äº†æ›´æ–°çš„æ–¹æ³•</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WeixinUser</span> <span class="keyword">implements</span> <span class="title class_">Observer</span> &#123;</span><br><span class="line">    <span class="comment">// å¾®ä¿¡ç”¨æˆ·å</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">WeixinUser</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(String message)</span> &#123;</span><br><span class="line">        System.out.println(name + <span class="string">&quot;-&quot;</span> + message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  å®šä¹‰æŠ½è±¡ä¸»é¢˜ç±»ï¼Œæä¾›äº†attachã€detachã€notifyä¸‰ä¸ªæ–¹æ³•</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Subject</span> &#123;</span><br><span class="line">    <span class="comment">//å¢åŠ è®¢é˜…è€…</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">attach</span><span class="params">(Observer observer)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆ é™¤è®¢é˜…è€…</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">detach</span><span class="params">(Observer observer)</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//é€šçŸ¥è®¢é˜…è€…æ›´æ–°æ¶ˆæ¯</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">notify</span><span class="params">(String message)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  å¾®ä¿¡å…¬ä¼—å·æ˜¯å…·ä½“ä¸»é¢˜ï¼ˆå…·ä½“è¢«è§‚å¯Ÿè€…ï¼‰ï¼Œé‡Œé¢å­˜å‚¨äº†è®¢é˜…è¯¥å…¬ä¼—å·çš„å¾®ä¿¡ç”¨æˆ·ï¼Œå¹¶å®ç°äº†æŠ½è±¡ä¸»é¢˜ä¸­çš„æ–¹æ³•</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubscriptionSubject</span> <span class="keyword">implements</span> <span class="title class_">Subject</span> &#123;</span><br><span class="line">    <span class="comment">//å‚¨å­˜è®¢é˜…å…¬ä¼—å·çš„å¾®ä¿¡ç”¨æˆ·</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Observer&gt; weixinUserlist = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Observer&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">attach</span><span class="params">(Observer observer)</span> &#123;</span><br><span class="line">        weixinUserlist.add(observer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">detach</span><span class="params">(Observer observer)</span> &#123;</span><br><span class="line">        weixinUserlist.remove(observer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">notify</span><span class="params">(String message)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (Observer observer : weixinUserlist) &#123;</span><br><span class="line">            observer.update(message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®¢æˆ·ç«¯ç¨‹åº</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SubscriptionSubject mSubscriptionSubject=<span class="keyword">new</span> <span class="title class_">SubscriptionSubject</span>();</span><br><span class="line">        <span class="comment">//åˆ›å»ºå¾®ä¿¡ç”¨æˆ·</span></span><br><span class="line">        WeixinUser user1=<span class="keyword">new</span> <span class="title class_">WeixinUser</span>(<span class="string">&quot;å­™æ‚Ÿç©º&quot;</span>);</span><br><span class="line">        WeixinUser user2=<span class="keyword">new</span> <span class="title class_">WeixinUser</span>(<span class="string">&quot;çŒªæ‚Ÿèƒ½&quot;</span>);</span><br><span class="line">        WeixinUser user3=<span class="keyword">new</span> <span class="title class_">WeixinUser</span>(<span class="string">&quot;æ²™æ‚Ÿå‡€&quot;</span>);</span><br><span class="line">        <span class="comment">//è®¢é˜…å…¬ä¼—å·</span></span><br><span class="line">        mSubscriptionSubject.attach(user1);</span><br><span class="line">        mSubscriptionSubject.attach(user2);</span><br><span class="line">        mSubscriptionSubject.attach(user3);</span><br><span class="line">        <span class="comment">//å…¬ä¼—å·æ›´æ–°å‘å‡ºæ¶ˆæ¯ç»™è®¢é˜…çš„å¾®ä¿¡ç”¨æˆ·</span></span><br><span class="line">        mSubscriptionSubject.notify(<span class="string">&quot;ä¼ æ™ºé»‘é©¬çš„ä¸“æ æ›´æ–°äº†&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>ä¼˜ç¼ºç‚¹</strong></p><blockquote><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>é™ä½äº†ç›®æ ‡ä¸è§‚å¯Ÿè€…ä¹‹é—´çš„è€¦åˆå…³ç³»ï¼Œä¸¤è€…ä¹‹é—´æ˜¯æŠ½è±¡è€¦åˆå…³ç³»ã€‚</li><li>è¢«è§‚å¯Ÿè€…å‘é€é€šçŸ¥ï¼Œæ‰€æœ‰æ³¨å†Œçš„è§‚å¯Ÿè€…éƒ½ä¼šæ”¶åˆ°ä¿¡æ¯ã€å¯ä»¥å®ç°å¹¿æ’­æœºåˆ¶ã€‘</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>å¦‚æœè§‚å¯Ÿè€…éå¸¸å¤šçš„è¯ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„è§‚å¯Ÿè€…æ”¶åˆ°è¢«è§‚å¯Ÿè€…å‘é€çš„é€šçŸ¥ä¼šè€—æ—¶</li><li>å¦‚æœè¢«è§‚å¯Ÿè€…æœ‰å¾ªç¯ä¾èµ–çš„è¯ï¼Œé‚£ä¹ˆè¢«è§‚å¯Ÿè€…å‘é€é€šçŸ¥ä¼šä½¿è§‚å¯Ÿè€…å¾ªç¯è°ƒç”¨ï¼Œä¼šå¯¼è‡´ç³»ç»Ÿå´©æºƒ</li></ul></blockquote><p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p><blockquote><ul><li>å¯¹è±¡é—´å­˜åœ¨ä¸€å¯¹å¤šå…³ç³»ï¼Œä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜ä¼šå½±å“å…¶ä»–å¯¹è±¡ã€‚</li><li>å½“ä¸€ä¸ªæŠ½è±¡æ¨¡å‹æœ‰ä¸¤ä¸ªæ–¹é¢ï¼Œå…¶ä¸­ä¸€ä¸ªæ–¹é¢ä¾èµ–äºå¦ä¸€æ–¹é¢æ—¶ã€‚</li></ul></blockquote><h3 id="3-3-4-è¿­ä»£å™¨æ¨¡å¼"><a href="#3-3-4-è¿­ä»£å™¨æ¨¡å¼" class="headerlink" title="3.3.4 è¿­ä»£å™¨æ¨¡å¼"></a>3.3.4 è¿­ä»£å™¨æ¨¡å¼</h3><p><strong>å®šä¹‰ï¼š</strong><br>æä¾›ä¸€ä¸ªå¯¹è±¡æ¥é¡ºåºè®¿é—®èšåˆå¯¹è±¡ä¸­çš„ä¸€ç³»åˆ—æ•°æ®ï¼Œè€Œä¸æš´éœ²èšåˆå¯¹è±¡çš„å†…éƒ¨è¡¨ç¤ºã€‚</p><p><strong>ç»“æ„ï¼š</strong></p><blockquote><ul><li><strong>æŠ½è±¡èšåˆï¼ˆAggregateï¼‰è§’è‰²ï¼š</strong>å®šä¹‰å­˜å‚¨ã€æ·»åŠ ã€åˆ é™¤èšåˆå…ƒç´ ä»¥åŠåˆ›å»ºè¿­ä»£å™¨å¯¹è±¡çš„æ¥å£ã€‚</li><li><strong>å…·ä½“èšåˆï¼ˆConcreteAggregateï¼‰è§’è‰²ï¼š</strong>å®ç°æŠ½è±¡èšåˆç±»ï¼Œè¿”å›ä¸€ä¸ªå…·ä½“è¿­ä»£å™¨çš„å®ä¾‹ã€‚</li><li><strong>æŠ½è±¡è¿­ä»£å™¨ï¼ˆIteratorï¼‰è§’è‰²ï¼š</strong>å®šä¹‰è®¿é—®å’Œéå†èšåˆå…ƒç´ çš„æ¥å£ï¼Œé€šå¸¸åŒ…å« hasNext()ã€next() ç­‰æ–¹æ³•ã€‚</li><li><strong>å…·ä½“è¿­ä»£å™¨ï¼ˆConcretelteratorï¼‰è§’è‰²ï¼š</strong>å®ç°æŠ½è±¡è¿­ä»£å™¨æ¥å£ä¸­æ‰€å®šä¹‰çš„æ–¹æ³•ï¼Œå®Œæˆå¯¹èšåˆå¯¹è±¡çš„éå†ï¼Œè®°å½•éå†çš„å½“å‰ä½ç½®ã€‚</li></ul></blockquote><p><strong>ä¾‹å­ï¼š</strong><br>å®šä¹‰ä¸€ä¸ªå¯ä»¥å­˜å‚¨å­¦ç”Ÿå¯¹è±¡çš„å®¹å™¨å¯¹è±¡ï¼Œå°†éå†è¯¥å®¹å™¨çš„åŠŸèƒ½äº¤ç”±è¿­ä»£å™¨å®ç°ï¼Œæ¶‰åŠåˆ°çš„ç±»å¦‚ä¸‹ï¼š</p><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F-%E4%BE%8B%E5%AD%90%E7%B1%BB%E5%9B%BE.png" class="" title="è¿­ä»£å™¨æ¨¡å¼-ä¾‹å­ç±»å›¾"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰è¿­ä»£å™¨æ¥å£ï¼Œå£°æ˜hasNextã€nextæ–¹æ³•</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">StudentIterator</span> &#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">hasNext</span><span class="params">()</span>;</span><br><span class="line">    Student <span class="title function_">next</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰å…·ä½“çš„è¿­ä»£å™¨ç±»ï¼Œé‡å†™æ‰€æœ‰çš„æŠ½è±¡æ–¹æ³•</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StudentIteratorImpl</span> <span class="keyword">implements</span> <span class="title class_">StudentIterator</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Student&gt; list;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">position</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">StudentIteratorImpl</span><span class="params">(List&lt;Student&gt; list)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.list = list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hasNext</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> position &lt; list.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Student <span class="title function_">next</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Student</span> <span class="variable">currentStudent</span> <span class="operator">=</span> list.get(position);</span><br><span class="line">        position ++;</span><br><span class="line">        <span class="keyword">return</span> currentStudent;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰æŠ½è±¡å®¹å™¨ç±»ï¼ŒåŒ…å«æ·»åŠ å…ƒç´ ï¼Œåˆ é™¤å…ƒç´ ï¼Œè·å–è¿­ä»£å™¨å¯¹è±¡çš„æ–¹æ³•</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">StudentAggregate</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">addStudent</span><span class="params">(Student student)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">removeStudent</span><span class="params">(Student student)</span>;</span><br><span class="line"></span><br><span class="line">    StudentIterator <span class="title function_">getStudentIterator</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰å…·ä½“çš„å®¹å™¨ç±»ï¼Œé‡å†™æ‰€æœ‰çš„æ–¹æ³•</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StudentAggregateImpl</span> <span class="keyword">implements</span> <span class="title class_">StudentAggregate</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;Student&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Student&gt;();  <span class="comment">// å­¦ç”Ÿåˆ—è¡¨</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addStudent</span><span class="params">(Student student)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.list.add(student);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">removeStudent</span><span class="params">(Student student)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.list.remove(student);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> StudentIterator <span class="title function_">getStudentIterator</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">StudentIteratorImpl</span>(list);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä¼˜ç¼ºç‚¹</strong></p><blockquote><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>å®ƒæ”¯æŒä»¥ä¸åŒçš„æ–¹å¼éå†ä¸€ä¸ªèšåˆå¯¹è±¡ï¼Œåœ¨åŒä¸€ä¸ªèšåˆå¯¹è±¡ä¸Šå¯ä»¥å®šä¹‰å¤šç§éå†æ–¹å¼ã€‚åœ¨è¿­ä»£å™¨æ¨¡å¼ä¸­åªéœ€è¦ç”¨ä¸€ä¸ªä¸åŒçš„è¿­ä»£å™¨æ¥æ›¿æ¢åŸæœ‰è¿­ä»£å™¨å³å¯æ”¹å˜éå†ç®—æ³•ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå·±å®šä¹‰è¿­ä»£å™¨çš„å­ç±»ä»¥æ”¯æŒæ–°çš„éå†æ–¹å¼ã€‚</li><li>è¿­ä»£å™¨ç®€åŒ–äº†èšåˆç±»ã€‚ç”±äºå¼•å…¥äº†è¿­ä»£å™¨ï¼Œåœ¨åŸæœ‰çš„èšåˆå¯¹è±¡ä¸­ä¸éœ€è¦å†è‡ªè¡Œæä¾›æ•°æ®éå†ç­‰æ–¹æ³•ï¼Œè¿™æ ·å¯ä»¥ç®€åŒ–èšåˆç±»çš„è®¾è®¡ã€‚</li><li>åœ¨è¿­ä»£å™¨æ¨¡å¼ä¸­ï¼Œç”±äºå¼•å…¥äº†æŠ½è±¡å±‚ï¼Œå¢åŠ æ–°çš„èšåˆç±»å’Œè¿­ä»£å™¨ç±»éƒ½å¾ˆæ–¹ä¾¿ï¼Œæ— é¡»ä¿®æ”¹åŸæœ‰ä»£ç ï¼Œæ»¡è¶³ â€œå¼€é—­åŸåˆ™â€ çš„è¦æ±‚ã€‚</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>å¢åŠ äº†ç±»çš„ä¸ªæ•°ï¼Œè¿™åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚æ€§ã€‚</li></ul></blockquote><p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p><blockquote><ul><li>å½“éœ€è¦ä¸ºèšåˆå¯¹è±¡æä¾›å¤šç§éå†æ–¹å¼æ—¶ã€‚</li><li>å½“éœ€è¦ä¸ºéå†ä¸åŒçš„èšåˆç»“æ„æä¾›ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£æ—¶ã€‚</li><li>å½“è®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡çš„å†…å®¹è€Œæ— é¡»æš´éœ²å…¶å†…éƒ¨ç»†èŠ‚çš„è¡¨ç¤ºæ—¶ã€‚</li></ul></blockquote><h3 id="3-3-5-è´£ä»»é“¾æ¨¡å¼"><a href="#3-3-5-è´£ä»»é“¾æ¨¡å¼" class="headerlink" title="3.3.5 è´£ä»»é“¾æ¨¡å¼"></a>3.3.5 è´£ä»»é“¾æ¨¡å¼</h3><p>åˆåèŒè´£é“¾æ¨¡å¼ï¼Œä¸ºäº†é¿å…è¯·æ±‚å‘é€è€…ä¸å¤šä¸ªè¯·æ±‚å¤„ç†è€…è€¦åˆåœ¨ä¸€èµ·ï¼Œå°†æ‰€æœ‰è¯·æ±‚çš„å¤„ç†è€…é€šè¿‡å‰ä¸€å¯¹è±¡è®°ä½å…¶ä¸‹ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨è€Œè¿æˆä¸€æ¡é“¾ï¼›å½“æœ‰è¯·æ±‚å‘ç”Ÿæ—¶ï¼Œå¯å°†è¯·æ±‚æ²¿ç€è¿™æ¡é“¾ä¼ é€’ï¼Œç›´åˆ°æœ‰å¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚</p><blockquote><p>å…¬å¸å‘˜å·¥è¯·å‡ï¼Œå¯æ‰¹å‡çš„é¢†å¯¼æœ‰éƒ¨é—¨è´Ÿè´£äººã€å‰¯æ€»ç»ç†ã€æ€»ç»ç†ç­‰ï¼Œä½†æ¯ä¸ªé¢†å¯¼èƒ½æ‰¹å‡†çš„å¤©æ•°ä¸åŒï¼Œå‘˜å·¥å¿…é¡»æ ¹æ®è‡ªå·±è¦è¯·å‡çš„å¤©æ•°å»æ‰¾ä¸åŒçš„é¢†å¯¼ç­¾åï¼Œä¹Ÿå°±æ˜¯è¯´å‘˜å·¥å¿…é¡»è®°ä½æ¯ä¸ªé¢†å¯¼çš„å§“åã€ç”µè¯å’Œåœ°å€ç­‰ä¿¡æ¯ï¼Œè¿™å¢åŠ äº†éš¾åº¦ã€‚</p></blockquote><p><strong>è§’è‰²ï¼š</strong></p><blockquote><ul><li><strong>æŠ½è±¡å¤„ç†è€…ï¼ˆHandlerï¼‰è§’è‰²ï¼š</strong>å®šä¹‰ä¸€ä¸ªå¤„ç†è¯·æ±‚çš„æ¥å£ï¼ŒåŒ…å«æŠ½è±¡å¤„ç†æ–¹æ³•å’Œä¸€ä¸ªåç»§è¿æ¥ã€‚</li><li><strong>å…·ä½“å¤„ç†è€…ï¼ˆConcrete Handlerï¼‰è§’è‰²ï¼š</strong>å®ç°æŠ½è±¡å¤„ç†è€…çš„å¤„ç†æ–¹æ³•ï¼Œåˆ¤æ–­èƒ½å¦å¤„ç†æœ¬æ¬¡è¯·æ±‚ï¼Œå¦‚æœå¯ä»¥å¤„ç†è¯·æ±‚åˆ™å¤„ç†ï¼Œå¦åˆ™å°†è¯¥è¯·æ±‚è½¬ç»™å®ƒçš„åç»§è€…ã€‚</li><li><strong>å®¢æˆ·ç±»ï¼ˆClientï¼‰è§’è‰²ï¼š</strong>åˆ›å»ºå¤„ç†é“¾ï¼Œå¹¶å‘é“¾å¤´çš„å…·ä½“å¤„ç†è€…å¯¹è±¡æäº¤è¯·æ±‚ï¼Œå®ƒä¸å…³å¿ƒå¤„ç†ç»†èŠ‚å’Œè¯·æ±‚çš„ä¼ é€’è¿‡ç¨‹ã€‚</li></ul></blockquote><p><strong>ä¾‹å­ï¼š</strong></p><blockquote><p>ç°éœ€è¦å¼€å‘ä¸€ä¸ªè¯·å‡æµç¨‹æ§åˆ¶ç³»ç»Ÿã€‚è¯·å‡ä¸€å¤©ä»¥ä¸‹çš„å‡åªéœ€è¦å°ç»„é•¿åŒæ„å³å¯ï¼›è¯·å‡1å¤©åˆ°3å¤©çš„å‡è¿˜éœ€è¦éƒ¨é—¨ç»ç†åŒæ„ï¼›è¯·æ±‚3å¤©åˆ°7å¤©è¿˜éœ€è¦æ€»ç»ç†åŒæ„æ‰è¡Œã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è¯·å‡æ¡</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LeaveRequest</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;<span class="comment">//å§“å</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> num;<span class="comment">//è¯·å‡å¤©æ•°</span></span><br><span class="line">    <span class="keyword">private</span> String content;<span class="comment">//è¯·å‡å†…å®¹</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">LeaveRequest</span><span class="params">(String name, <span class="type">int</span> num, String content)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.num = num;</span><br><span class="line">        <span class="built_in">this</span>.content = content;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getNum</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> num;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getContent</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> content;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¤„ç†è€…æŠ½è±¡ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Handler</span> &#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">NUM_ONE</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">NUM_THREE</span> <span class="operator">=</span> <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">NUM_SEVEN</span> <span class="operator">=</span> <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è¯¥é¢†å¯¼å¤„ç†çš„è¯·å‡å¤©æ•°åŒºé—´</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> numStart;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> numEnd;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é¢†å¯¼ä¸Šé¢è¿˜æœ‰é¢†å¯¼</span></span><br><span class="line">    <span class="keyword">private</span> Handler nextHandler;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è®¾ç½®è¯·å‡å¤©æ•°èŒƒå›´ ä¸Šä¸å°é¡¶</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Handler</span><span class="params">(<span class="type">int</span> numStart)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.numStart = numStart;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è®¾ç½®è¯·å‡å¤©æ•°èŒƒå›´</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Handler</span><span class="params">(<span class="type">int</span> numStart, <span class="type">int</span> numEnd)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.numStart = numStart;</span><br><span class="line">        <span class="built_in">this</span>.numEnd = numEnd;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è®¾ç½®ä¸Šçº§é¢†å¯¼</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setNextHandler</span><span class="params">(Handler nextHandler)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.nextHandler = nextHandler;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æäº¤è¯·å‡æ¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">submit</span><span class="params">(LeaveRequest leave)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="number">0</span> == <span class="built_in">this</span>.numStart)&#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¦‚æœè¯·å‡å¤©æ•°è¾¾åˆ°è¯¥é¢†å¯¼è€…çš„å¤„ç†è¦æ±‚</span></span><br><span class="line">        <span class="keyword">if</span>(leave.getNum() &gt;= <span class="built_in">this</span>.numStart)&#123;</span><br><span class="line">            <span class="built_in">this</span>.handleLeave(leave);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//å¦‚æœè¿˜æœ‰ä¸Šçº§ å¹¶ä¸”è¯·å‡å¤©æ•°è¶…è¿‡äº†å½“å‰é¢†å¯¼çš„å¤„ç†èŒƒå›´</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="literal">null</span> != <span class="built_in">this</span>.nextHandler &amp;&amp; leave.getNum() &gt; numEnd)&#123;</span><br><span class="line">                <span class="built_in">this</span>.nextHandler.submit(leave);<span class="comment">//ç»§ç»­æäº¤</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;æµç¨‹ç»“æŸ&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å„çº§é¢†å¯¼å¤„ç†è¯·å‡æ¡æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">handleLeave</span><span class="params">(LeaveRequest leave)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å°ç»„é•¿</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GroupLeader</span> <span class="keyword">extends</span> <span class="title class_">Handler</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">GroupLeader</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//å°ç»„é•¿å¤„ç†1-3å¤©çš„è¯·å‡</span></span><br><span class="line">        <span class="built_in">super</span>(Handler.NUM_ONE, Handler.NUM_THREE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">handleLeave</span><span class="params">(LeaveRequest leave)</span> &#123;</span><br><span class="line">        System.out.println(leave.getName() + <span class="string">&quot;è¯·å‡&quot;</span> + leave.getNum() + <span class="string">&quot;å¤©,&quot;</span> + leave.getContent() + <span class="string">&quot;ã€‚&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;å°ç»„é•¿å®¡æ‰¹ï¼šåŒæ„ã€‚&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//éƒ¨é—¨ç»ç†</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Manager</span> <span class="keyword">extends</span> <span class="title class_">Handler</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Manager</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//éƒ¨é—¨ç»ç†å¤„ç†3-7å¤©çš„è¯·å‡</span></span><br><span class="line">        <span class="built_in">super</span>(Handler.NUM_THREE, Handler.NUM_SEVEN);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">handleLeave</span><span class="params">(LeaveRequest leave)</span> &#123;</span><br><span class="line">        System.out.println(leave.getName() + <span class="string">&quot;è¯·å‡&quot;</span> + leave.getNum() + <span class="string">&quot;å¤©,&quot;</span> + leave.getContent() + <span class="string">&quot;ã€‚&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;éƒ¨é—¨ç»ç†å®¡æ‰¹ï¼šåŒæ„ã€‚&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ€»ç»ç†</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GeneralManager</span> <span class="keyword">extends</span> <span class="title class_">Handler</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">GeneralManager</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//éƒ¨é—¨ç»ç†å¤„ç†7å¤©ä»¥ä¸Šçš„è¯·å‡</span></span><br><span class="line">        <span class="built_in">super</span>(Handler.NUM_SEVEN);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">handleLeave</span><span class="params">(LeaveRequest leave)</span> &#123;</span><br><span class="line">        System.out.println(leave.getName() + <span class="string">&quot;è¯·å‡&quot;</span> + leave.getNum() + <span class="string">&quot;å¤©,&quot;</span> + leave.getContent() + <span class="string">&quot;ã€‚&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;æ€»ç»ç†å®¡æ‰¹ï¼šåŒæ„ã€‚&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//è¯·å‡æ¡æ¥ä¸€å¼ </span></span><br><span class="line">        <span class="type">LeaveRequest</span> <span class="variable">leave</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LeaveRequest</span>(<span class="string">&quot;å°èŠ±&quot;</span>,<span class="number">5</span>,<span class="string">&quot;èº«ä½“ä¸é€‚&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å„ä½é¢†å¯¼</span></span><br><span class="line">        <span class="type">GroupLeader</span> <span class="variable">groupLeader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GroupLeader</span>();</span><br><span class="line">        <span class="type">Manager</span> <span class="variable">manager</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Manager</span>();</span><br><span class="line">        <span class="type">GeneralManager</span> <span class="variable">generalManager</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GeneralManager</span>();</span><br><span class="line"></span><br><span class="line">        groupLeader.setNextHandler(manager);<span class="comment">//å°ç»„é•¿çš„é¢†å¯¼æ˜¯éƒ¨é—¨ç»ç†</span></span><br><span class="line">        manager.setNextHandler(generalManager);<span class="comment">//éƒ¨é—¨ç»ç†çš„é¢†å¯¼æ˜¯æ€»ç»ç†</span></span><br><span class="line">        <span class="comment">//ä¹‹æ‰€ä»¥åœ¨è¿™é‡Œè®¾ç½®ä¸Šçº§é¢†å¯¼ï¼Œæ˜¯å› ä¸ºå¯ä»¥æ ¹æ®å®é™…éœ€æ±‚æ¥æ›´æ”¹è®¾ç½®ï¼Œå¦‚æœå®æˆ˜ä¸­ä¸Šçº§é¢†å¯¼äººéƒ½æ˜¯å›ºå®šçš„ï¼Œåˆ™å¯ä»¥ç§»åˆ°é¢†å¯¼å®ç°ç±»ä¸­ã€‚</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//æäº¤ç”³è¯·</span></span><br><span class="line">        groupLeader.submit(leave);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä¼˜ç¼ºç‚¹</strong></p><blockquote><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>é™ä½äº†å¯¹è±¡ä¹‹é—´çš„è€¦åˆåº¦ï¼šè¯¥æ¨¡å¼é™ä½äº†è¯·æ±‚å‘é€è€…å’Œæ¥æ”¶è€…çš„è€¦åˆåº¦ã€‚</li><li>å¢å¼ºäº†ç³»ç»Ÿçš„å¯æ‰©å±•æ€§ï¼šå¯ä»¥æ ¹æ®éœ€è¦å¢åŠ æ–°çš„è¯·æ±‚å¤„ç†ç±»ï¼Œæ»¡è¶³å¼€é—­åŸåˆ™ã€‚</li><li>å¢å¼ºäº†ç»™å¯¹è±¡æŒ‡æ´¾èŒè´£çš„çµæ´»æ€§ï¼šå½“å·¥ä½œæµç¨‹å‘ç”Ÿå˜åŒ–ï¼Œå¯ä»¥åŠ¨æ€åœ°æ”¹å˜é“¾å†…çš„æˆå‘˜æˆ–è€…ä¿®æ”¹å®ƒä»¬çš„æ¬¡åºï¼Œä¹Ÿå¯åŠ¨æ€åœ°æ–°å¢æˆ–è€…åˆ é™¤è´£ä»»ã€‚</li><li>è´£ä»»é“¾ç®€åŒ–äº†å¯¹è±¡ä¹‹é—´çš„è¿æ¥ï¼šä¸€ä¸ªå¯¹è±¡åªéœ€ä¿æŒä¸€ä¸ªæŒ‡å‘å…¶åç»§è€…çš„å¼•ç”¨ï¼Œä¸éœ€ä¿æŒå…¶ä»–æ‰€æœ‰å¤„ç†è€…çš„å¼•ç”¨ï¼Œè¿™é¿å…äº†ä½¿ç”¨ä¼—å¤šçš„if æˆ–è€… ifÂ·Â·Â·else è¯­å¥ã€‚</li><li>è´£ä»»åˆ†æ‹…ï¼šæ¯ä¸ªç±»åªéœ€è¦å¤„ç†è‡ªå·±è¯¥å¤„ç†çš„å·¥ä½œï¼Œä¸èƒ½å¤„ç†çš„ä¼ é€’ç»™ä¸‹ä¸€ä¸ªå¯¹è±¡å®Œæˆï¼Œæ˜ç¡®å„ç±»çš„è´£ä»»èŒƒå›´ï¼Œç¬¦åˆç±»çš„å•ä¸€èŒè´£åŸåˆ™ã€‚</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>ä¸èƒ½ä¿è¯æ¯ä¸ªè¯·æ±‚ä¸€å®šè¢«å¤„ç†ã€‚ç”±äºä¸€ä¸ªè¯·æ±‚æ²¡æœ‰æ˜ç¡®çš„æ¥æ”¶è€…ï¼Œæ‰€ä»¥ä¸èƒ½ä¿è¯å®ƒä¸€å®šä¼šè¢«å¤„ç†ï¼Œè¯¥è¯·æ±‚å¯èƒ½ä¸€ç›´ä¼ åˆ°é“¾çš„æœ«ç«¯éƒ½å¾—ä¸åˆ°å¤„ç†ã€‚</li><li>å¯¹æ¯”è¾ƒé•¿çš„èŒè´£é“¾ï¼Œè¯·æ±‚çš„å¤„ç†å¯èƒ½æ¶‰åŠå¤šä¸ªå¤„ç†å¯¹è±¡ï¼Œç³»ç»Ÿæ€§èƒ½å°†å—åˆ°ä¸€å®šå½±å“ã€‚</li><li>èŒè´£é“¾å»ºç«‹çš„åˆç†æ€§è¦é å®¢æˆ·ç«¯æ¥ä¿è¯ï¼Œå¢åŠ äº†å®¢æˆ·ç«¯çš„å¤æ‚æ€§ï¼Œå¯èƒ½ä¼šç”±äºèŒè´£é“¾çš„é”™è¯¯è®¾ç½®è€Œå¯¼è‡´ç³»ç»Ÿå‡ºé”™ï¼Œå¦‚å¯èƒ½ä¼šé€ æˆå¾ªç¯è°ƒç”¨ã€‚</li></ul></blockquote><h3 id="3-3-6-å‘½ä»¤æ¨¡å¼"><a href="#3-3-6-å‘½ä»¤æ¨¡å¼" class="headerlink" title="3.3.6 å‘½ä»¤æ¨¡å¼"></a>3.3.6 å‘½ä»¤æ¨¡å¼</h3><p><strong>å®šä¹‰ï¼š</strong><br>å°†ä¸€ä¸ªè¯·æ±‚å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œä½¿å‘å‡ºè¯·æ±‚çš„è´£ä»»å’Œæ‰§è¡Œè¯·æ±‚çš„è´£ä»»åˆ†å‰²å¼€ã€‚è¿™æ ·ä¸¤è€…ä¹‹é—´é€šè¿‡å‘½ä»¤å¯¹è±¡è¿›è¡Œæ²Ÿé€šï¼Œè¿™æ ·æ–¹ä¾¿å°†å‘½ä»¤å¯¹è±¡è¿›è¡Œå­˜å‚¨ã€ä¼ é€’ã€è°ƒç”¨ã€å¢åŠ ä¸ç®¡ç†ã€‚</p><p><strong>ç»“æ„ï¼š</strong></p><blockquote><ul><li><strong>æŠ½è±¡å‘½ä»¤ç±»ï¼ˆCommandï¼‰è§’è‰²ï¼š</strong>å®šä¹‰å‘½ä»¤çš„æ¥å£ï¼Œå£°æ˜æ‰§è¡Œçš„æ–¹æ³•ã€‚</li><li><strong>å…·ä½“å‘½ä»¤ï¼ˆConcrete Commandï¼‰è§’è‰²ï¼š</strong>å…·ä½“çš„å‘½ä»¤ï¼Œå®ç°å‘½ä»¤æ¥å£ï¼›é€šå¸¸ä¼šæŒæœ‰æ¥æ”¶è€…ï¼Œå¹¶è°ƒç”¨æ¥æ”¶è€…çš„åŠŸèƒ½æ¥å®Œæˆå‘½ä»¤è¦æ‰§è¡Œçš„æ“ä½œã€‚</li><li><strong>å®ç°è€…&#x2F;æ¥æ”¶è€…ï¼ˆReceiverï¼‰è§’è‰²ï¼š</strong>æ¥æ”¶è€…ï¼ŒçœŸæ­£æ‰§è¡Œå‘½ä»¤çš„å¯¹è±¡ã€‚ä»»ä½•ç±»éƒ½å¯èƒ½æˆä¸ºä¸€ä¸ªæ¥æ”¶è€…ï¼Œåªè¦å®ƒèƒ½å¤Ÿå®ç°å‘½ä»¤è¦æ±‚å®ç°çš„ç›¸åº”åŠŸèƒ½ã€‚</li><li><strong>è°ƒç”¨è€…&#x2F;è¯·æ±‚è€…ï¼ˆInvokerï¼‰è§’è‰²ï¼š</strong>è¦æ±‚å‘½ä»¤å¯¹è±¡æ‰§è¡Œè¯·æ±‚ï¼Œé€šå¸¸ä¼šæŒæœ‰å‘½ä»¤å¯¹è±¡ï¼Œå¯ä»¥æŒæœ‰å¾ˆå¤šçš„å‘½ä»¤å¯¹è±¡ã€‚è¿™ä¸ªæ˜¯å®¢æˆ·ç«¯çœŸæ­£è§¦å‘å‘½ä»¤å¹¶è¦æ±‚å‘½ä»¤æ‰§è¡Œç›¸åº”æ“ä½œçš„åœ°æ–¹ï¼Œä¹Ÿå°±æ˜¯è¯´ç›¸å½“äºä½¿ç”¨å‘½ä»¤å¯¹è±¡çš„å…¥å£ã€‚</li></ul></blockquote><p><strong>æ¡ˆä¾‹ï¼š</strong></p><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F-%E4%BE%8B%E5%AD%90.png" class="" title="å‘½ä»¤æ¨¡å¼-ä¾‹å­"><blockquote><ul><li>æœåŠ¡å‘˜ï¼š å°±æ˜¯è°ƒç”¨è€…è§’è‰²ï¼Œç”±å¥¹æ¥å‘èµ·å‘½ä»¤ã€‚</li><li>èµ„æ·±å¤§å¨ï¼š å°±æ˜¯æ¥æ”¶è€…è§’è‰²ï¼ŒçœŸæ­£å‘½ä»¤æ‰§è¡Œçš„å¯¹è±¡ã€‚</li><li>è®¢å•ï¼š å‘½ä»¤ä¸­åŒ…å«è®¢å•ã€‚</li></ul></blockquote><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F-%E4%BE%8B%E5%AD%90%E7%B1%BB%E5%9B%BE.png" class="" title="å‘½ä»¤æ¨¡å¼-ä¾‹å­ç±»å›¾"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Command</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">execute</span><span class="params">()</span>;<span class="comment">//åªéœ€è¦å®šä¹‰ä¸€ä¸ªç»Ÿä¸€çš„æ‰§è¡Œæ–¹æ³•</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderCommand</span> <span class="keyword">implements</span> <span class="title class_">Command</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æŒæœ‰æ¥å—è€…å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">private</span> SeniorChef receiver;</span><br><span class="line">    <span class="keyword">private</span> Order order;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">OrderCommand</span><span class="params">(SeniorChef receiver, Order order)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.receiver = receiver;</span><br><span class="line">        <span class="built_in">this</span>.order = order;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">execute</span><span class="params">()</span>  &#123;</span><br><span class="line">        System.out.println(order.getDiningTable() + <span class="string">&quot;æ¡Œçš„è®¢å•ï¼š&quot;</span>);</span><br><span class="line">        Set&lt;String&gt; keys = order.getFoodDic().keySet();</span><br><span class="line">        <span class="keyword">for</span> (String key : keys) &#123;</span><br><span class="line">            receiver.makeFood(order.getFoodDic().get(key),key);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">100</span>);<span class="comment">//åœé¡¿ä¸€ä¸‹ æ¨¡æ‹Ÿåšé¥­çš„è¿‡ç¨‹</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        System.out.println(order.getDiningTable() + <span class="string">&quot;æ¡Œçš„é¥­å¼„å¥½äº†&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Order</span> &#123;</span><br><span class="line">    <span class="comment">// é¤æ¡Œå·ç </span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> diningTable;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç”¨æ¥å­˜å‚¨é¤åå¹¶è®°å½•ä»½æ•°</span></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, Integer&gt; foodDic = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String, Integer&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getDiningTable</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> diningTable;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDiningTable</span><span class="params">(<span class="type">int</span> diningTable)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.diningTable = diningTable;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, Integer&gt; <span class="title function_">getFoodDic</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> foodDic;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setFoodDic</span><span class="params">(String name, <span class="type">int</span> num)</span> &#123;</span><br><span class="line">        foodDic.put(name,num);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// èµ„æ·±å¤§å¨ç±» æ˜¯å‘½ä»¤çš„Receiver</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SeniorChef</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">makeFood</span><span class="params">(<span class="type">int</span> num,String foodName)</span> &#123;</span><br><span class="line">        System.out.println(num + <span class="string">&quot;ä»½&quot;</span> + foodName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Waitor</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt;Command&gt; commands;<span class="comment">//å¯ä»¥æŒæœ‰å¾ˆå¤šçš„å‘½ä»¤å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Waitor</span><span class="params">()</span> &#123;</span><br><span class="line">        commands = <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCommand</span><span class="params">(Command cmd)</span>&#123;</span><br><span class="line">        commands.add(cmd);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‘å‡ºå‘½ä»¤ å–Š è®¢å•æ¥äº†ï¼Œå¨å¸ˆå¼€å§‹æ‰§è¡Œ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">orderUp</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç¾å¥³æœåŠ¡å‘˜ï¼šå®å’šï¼Œå¤§å¨ï¼Œæ–°è®¢å•æ¥äº†.......&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; commands.size(); i++) &#123;</span><br><span class="line">            <span class="type">Command</span> <span class="variable">cmd</span> <span class="operator">=</span> commands.get(i);</span><br><span class="line">            <span class="keyword">if</span> (cmd != <span class="literal">null</span>) &#123;</span><br><span class="line">                cmd.execute();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//åˆ›å»º2ä¸ªorder</span></span><br><span class="line">        <span class="type">Order</span> <span class="variable">order1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Order</span>();</span><br><span class="line">        order1.setDiningTable(<span class="number">1</span>);</span><br><span class="line">        order1.getFoodDic().put(<span class="string">&quot;è¥¿çº¢æŸ¿é¸¡è›‹é¢&quot;</span>,<span class="number">1</span>);</span><br><span class="line">        order1.getFoodDic().put(<span class="string">&quot;å°æ¯å¯ä¹&quot;</span>,<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Order</span> <span class="variable">order2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Order</span>();</span><br><span class="line">        order2.setDiningTable(<span class="number">3</span>);</span><br><span class="line">        order2.getFoodDic().put(<span class="string">&quot;å°–æ¤’è‚‰ä¸ç›–é¥­&quot;</span>,<span class="number">1</span>);</span><br><span class="line">        order2.getFoodDic().put(<span class="string">&quot;å°æ¯é›ªç¢§&quot;</span>,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºæ¥æ”¶è€…</span></span><br><span class="line">        SeniorChef receiver=<span class="keyword">new</span> <span class="title class_">SeniorChef</span>();</span><br><span class="line">        <span class="comment">//å°†è®¢å•å’Œæ¥æ”¶è€…å°è£…æˆå‘½ä»¤å¯¹è±¡</span></span><br><span class="line">        <span class="type">OrderCommand</span> <span class="variable">cmd1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OrderCommand</span>(receiver, order1);</span><br><span class="line">        <span class="type">OrderCommand</span> <span class="variable">cmd2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OrderCommand</span>(receiver, order2);</span><br><span class="line">        <span class="comment">//åˆ›å»ºè°ƒç”¨è€… waitor</span></span><br><span class="line">        <span class="type">Waitor</span> <span class="variable">invoker</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Waitor</span>();</span><br><span class="line">        invoker.setCommand(cmd1);</span><br><span class="line">        invoker.setCommand(cmd2);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å°†è®¢å•å¸¦åˆ°æŸœå° å¹¶å‘å¨å¸ˆå–Š è®¢å•æ¥äº†</span></span><br><span class="line">        invoker.orderUp();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ€»ä½“ä¸Šå°±æ˜¯ç»™å‘½ä»¤å¯¹è±¡æŒ‡å®šæ¥æ”¶è€…ï¼Œè°ƒç”¨è€…å‘å¸ƒå‘½ä»¤ï¼Œç„¶åæ¥æ”¶è€…è´Ÿè´£æ‰§è¡Œ</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>ä¼˜ç¼ºç‚¹</strong></p><blockquote><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>é™ä½ç³»ç»Ÿçš„è€¦åˆåº¦ã€‚å‘½ä»¤æ¨¡å¼èƒ½å°†è°ƒç”¨æ“ä½œçš„å¯¹è±¡ä¸å®ç°è¯¥æ“ä½œçš„å¯¹è±¡è§£è€¦ã€‚</li><li>å¢åŠ æˆ–åˆ é™¤å‘½ä»¤éå¸¸æ–¹ä¾¿ã€‚é‡‡ç”¨å‘½ä»¤æ¨¡å¼å¢åŠ ä¸åˆ é™¤å‘½ä»¤ä¸ä¼šå½±å“å…¶ä»–ç±»ï¼Œå®ƒæ»¡è¶³â€œå¼€é—­åŸåˆ™â€ï¼Œå¯¹æ‰©å±•æ¯”è¾ƒçµæ´»ã€‚</li><li>å¯ä»¥å®ç°å®å‘½ä»¤ã€‚å‘½ä»¤æ¨¡å¼å¯ä»¥ä¸ç»„åˆæ¨¡å¼ç»“åˆï¼Œå°†å¤šä¸ªå‘½ä»¤è£…é…æˆä¸€ä¸ªç»„åˆå‘½ä»¤ï¼Œå³å®å‘½ä»¤ã€‚</li><li>æ–¹ä¾¿å®ç° Undo å’Œ Redo æ“ä½œã€‚å‘½ä»¤æ¨¡å¼å¯ä»¥ä¸åé¢ä»‹ç»çš„å¤‡å¿˜å½•æ¨¡å¼ç»“åˆï¼Œå®ç°å‘½ä»¤çš„æ’¤é”€ä¸æ¢å¤ã€‚</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>ä½¿ç”¨å‘½ä»¤æ¨¡å¼å¯èƒ½ä¼šå¯¼è‡´æŸäº›ç³»ç»Ÿæœ‰è¿‡å¤šçš„å…·ä½“å‘½ä»¤ç±»ã€‚</li><li>ç³»ç»Ÿç»“æ„æ›´åŠ å¤æ‚ã€‚</li></ul></blockquote><p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p><blockquote><ul><li>ç³»ç»Ÿéœ€è¦å°†è¯·æ±‚è°ƒç”¨è€…å’Œè¯·æ±‚æ¥æ”¶è€…è§£è€¦ï¼Œä½¿å¾—è°ƒç”¨è€…å’Œæ¥æ”¶è€…ä¸ç›´æ¥äº¤äº’ã€‚</li><li>ç³»ç»Ÿéœ€è¦åœ¨ä¸åŒçš„æ—¶é—´æŒ‡å®šè¯·æ±‚ã€å°†è¯·æ±‚æ’é˜Ÿå’Œæ‰§è¡Œè¯·æ±‚ã€‚</li><li>ç³»ç»Ÿéœ€è¦æ”¯æŒå‘½ä»¤çš„æ’¤é”€(Undo)æ“ä½œå’Œæ¢å¤(Redo)æ“ä½œã€‚</li></ul></blockquote><h3 id="3-3-7-å¤‡å¿˜å½•æ¨¡å¼"><a href="#3-3-7-å¤‡å¿˜å½•æ¨¡å¼" class="headerlink" title="3.3.7 å¤‡å¿˜å½•æ¨¡å¼"></a>3.3.7 å¤‡å¿˜å½•æ¨¡å¼</h3><p>åˆå«å¿«ç…§æ¨¡å¼ï¼Œåœ¨ä¸ç ´åå°è£…æ€§çš„å‰æä¸‹ï¼Œæ•è·ä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œå¹¶åœ¨è¯¥å¯¹è±¡ä¹‹å¤–ä¿å­˜è¿™ä¸ªçŠ¶æ€ï¼Œä»¥ä¾¿ä»¥åå½“éœ€è¦æ—¶èƒ½å°†è¯¥å¯¹è±¡æ¢å¤åˆ°åŸå…ˆä¿å­˜çš„çŠ¶æ€ã€‚</p><p><strong>ç»“æ„ï¼š</strong></p><blockquote><ul><li><strong>å‘èµ·äººï¼ˆOriginatorï¼‰è§’è‰²ï¼š</strong>è®°å½•å½“å‰æ—¶åˆ»çš„å†…éƒ¨çŠ¶æ€ä¿¡æ¯ï¼Œæä¾›åˆ›å»ºå¤‡å¿˜å½•å’Œæ¢å¤å¤‡å¿˜å½•æ•°æ®çš„åŠŸèƒ½ï¼Œå®ç°å…¶ä»–ä¸šåŠ¡åŠŸèƒ½ï¼Œå®ƒå¯ä»¥è®¿é—®å¤‡å¿˜å½•é‡Œçš„æ‰€æœ‰ä¿¡æ¯ã€‚</li><li><strong>å¤‡å¿˜å½•ï¼ˆMementoï¼‰è§’è‰²ï¼š</strong>è´Ÿè´£å­˜å‚¨å‘èµ·äººçš„å†…éƒ¨çŠ¶æ€ï¼Œåœ¨éœ€è¦çš„æ—¶å€™æä¾›è¿™äº›å†…éƒ¨çŠ¶æ€ç»™å‘èµ·äººã€‚</li><li><strong>ç®¡ç†è€…ï¼ˆCaretakerï¼‰è§’è‰²ï¼š</strong>å¯¹å¤‡å¿˜å½•è¿›è¡Œç®¡ç†ï¼Œæä¾›ä¿å­˜ä¸è·å–å¤‡å¿˜å½•çš„åŠŸèƒ½ï¼Œä½†å…¶ä¸èƒ½å¯¹å¤‡å¿˜å½•çš„å†…å®¹è¿›è¡Œè®¿é—®ä¸ä¿®æ”¹ã€‚</li></ul></blockquote><blockquote><p><strong>å¤‡å¿˜å½•æœ‰ä¸¤ä¸ªç­‰æ•ˆçš„æ¥å£ï¼š</strong></p><ul><li><strong>çª„æ¥å£ï¼š</strong>ç®¡ç†è€…(Caretaker)å¯¹è±¡ï¼ˆå’Œå…¶ä»–å‘èµ·äººå¯¹è±¡ä¹‹å¤–çš„ä»»ä½•å¯¹è±¡ï¼‰çœ‹åˆ°çš„æ˜¯å¤‡å¿˜å½•çš„çª„æ¥å£(narror Interface)ï¼Œè¿™ä¸ªçª„æ¥å£åªå…è®¸ä»–æŠŠå¤‡å¿˜å½•å¯¹è±¡ä¼ ç»™å…¶ä»–çš„å¯¹è±¡ã€‚</li><li><strong>å®½æ¥å£ï¼š</strong>ä¸ç®¡ç†è€…çœ‹åˆ°çš„çª„æ¥å£ç›¸åï¼Œå‘èµ·äººå¯¹è±¡å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå®½æ¥å£(wide Interface)ï¼Œè¿™ä¸ªå®½æ¥å£å…è®¸å®ƒè¯»å–æ‰€æœ‰çš„æ•°æ®ï¼Œä»¥ä¾¿æ ¹æ®è¿™äº›æ•°æ®æ¢å¤è¿™ä¸ªå‘èµ·äººå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ã€‚</li></ul></blockquote><p><strong>ä¾‹å­ï¼š</strong></p><blockquote><p>æ¸¸æˆä¸­çš„æŸä¸ªåœºæ™¯ï¼Œä¸€æ¸¸æˆè§’è‰²æœ‰ç”Ÿå‘½åŠ›ã€æ”»å‡»åŠ›ã€é˜²å¾¡åŠ›ç­‰æ•°æ®ï¼Œåœ¨æ‰“Bosså‰å’Œåä¸€å®šä¼šä¸ä¸€æ ·çš„ï¼Œæˆ‘ä»¬å…è®¸ç©å®¶å¦‚æœæ„Ÿè§‰ä¸Bosså†³æ–—çš„æ•ˆæœä¸ç†æƒ³å¯ä»¥è®©æ¸¸æˆæ¢å¤åˆ°å†³æ–—ä¹‹å‰çš„çŠ¶æ€ã€‚<br><strong>è¦å®ç°ä¸Šè¿°æ¡ˆä¾‹ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š</strong></p></blockquote><ul><li>â€œç™½ç®±â€å¤‡å¿˜å½•æ¨¡å¼</li><li>â€œé»‘ç®±â€å¤‡å¿˜å½•æ¨¡å¼</li></ul><h4 id="3-3-7-1-ç™½ç®±å¤‡å¿˜å½•æ¨¡å¼"><a href="#3-3-7-1-ç™½ç®±å¤‡å¿˜å½•æ¨¡å¼" class="headerlink" title="3.3.7.1 ç™½ç®±å¤‡å¿˜å½•æ¨¡å¼"></a>3.3.7.1 ç™½ç®±å¤‡å¿˜å½•æ¨¡å¼</h4><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%A4%87%E5%BF%98%E5%BD%95%E6%A8%A1%E5%BC%8F-%E7%99%BD%E7%AE%B1%E7%B1%BB%E5%9B%BE.png" class="" title="å¤‡å¿˜å½•æ¨¡å¼-ç™½ç®±ç±»å›¾"><blockquote><p>ç™½ç®±å¤‡å¿˜å½•æ¨¡å¼æ˜¯ç ´åå°è£…æ€§çš„ã€‚ä½†æ˜¯é€šè¿‡ç¨‹åºå‘˜è‡ªå¾‹ï¼ŒåŒæ ·å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šå®ç°æ¨¡å¼çš„å¤§éƒ¨åˆ†ç”¨æ„ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ¸¸æˆè§’è‰²ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GameRole</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> vit; <span class="comment">//ç”Ÿå‘½åŠ›</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> atk; <span class="comment">//æ”»å‡»åŠ›</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> def; <span class="comment">//é˜²å¾¡åŠ›</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆå§‹åŒ–çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initState</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.vit = <span class="number">100</span>;</span><br><span class="line">        <span class="built_in">this</span>.atk = <span class="number">100</span>;</span><br><span class="line">        <span class="built_in">this</span>.def = <span class="number">100</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æˆ˜æ–—</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">fight</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.vit = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">this</span>.atk = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">this</span>.def = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä¿å­˜è§’è‰²çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">public</span> RoleStateMemento <span class="title function_">saveState</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RoleStateMemento</span>(vit, atk, def);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å›å¤è§’è‰²çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">recoverState</span><span class="params">(RoleStateMemento roleStateMemento)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.vit = roleStateMemento.getVit();</span><br><span class="line">        <span class="built_in">this</span>.atk = roleStateMemento.getAtk();</span><br><span class="line">        <span class="built_in">this</span>.def = roleStateMemento.getDef();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">stateDisplay</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;è§’è‰²ç”Ÿå‘½åŠ›ï¼š&quot;</span> + vit);</span><br><span class="line">        System.out.println(<span class="string">&quot;è§’è‰²æ”»å‡»åŠ›ï¼š&quot;</span> + atk);</span><br><span class="line">        System.out.println(<span class="string">&quot;è§’è‰²é˜²å¾¡åŠ›ï¼š&quot;</span> + def);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getVit</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> vit;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setVit</span><span class="params">(<span class="type">int</span> vit)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.vit = vit;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAtk</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> atk;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAtk</span><span class="params">(<span class="type">int</span> atk)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.atk = atk;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getDef</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> def;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDef</span><span class="params">(<span class="type">int</span> def)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.def = def;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ¸¸æˆçŠ¶æ€å­˜å‚¨ç±»(å¤‡å¿˜å½•ç±»)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RoleStateMemento</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> vit;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> atk;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> def;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">RoleStateMemento</span><span class="params">(<span class="type">int</span> vit, <span class="type">int</span> atk, <span class="type">int</span> def)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.vit = vit;</span><br><span class="line">        <span class="built_in">this</span>.atk = atk;</span><br><span class="line">        <span class="built_in">this</span>.def = def;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getVit</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> vit;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setVit</span><span class="params">(<span class="type">int</span> vit)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.vit = vit;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAtk</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> atk;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAtk</span><span class="params">(<span class="type">int</span> atk)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.atk = atk;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getDef</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> def;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDef</span><span class="params">(<span class="type">int</span> def)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.def = def;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è§’è‰²çŠ¶æ€ç®¡ç†è€…ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RoleStateCaretaker</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> RoleStateMemento roleStateMemento;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> RoleStateMemento <span class="title function_">getRoleStateMemento</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> roleStateMemento;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setRoleStateMemento</span><span class="params">(RoleStateMemento roleStateMemento)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.roleStateMemento = roleStateMemento;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;------------å¤§æˆ˜Bosså‰------------&quot;</span>);</span><br><span class="line">        <span class="comment">//å¤§æˆ˜Bosså‰</span></span><br><span class="line">        <span class="type">GameRole</span> <span class="variable">gameRole</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GameRole</span>();</span><br><span class="line">        gameRole.initState();</span><br><span class="line">        gameRole.stateDisplay();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ä¿å­˜è¿›åº¦</span></span><br><span class="line">        <span class="type">RoleStateCaretaker</span> <span class="variable">roleStateCaretaker</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RoleStateCaretaker</span>();</span><br><span class="line">        roleStateCaretaker.setRoleStateMemento(gameRole.saveState());</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;------------å¤§æˆ˜Bosså------------&quot;</span>);</span><br><span class="line">        <span class="comment">//å¤§æˆ˜Bossæ—¶ï¼ŒæŸè€—ä¸¥é‡</span></span><br><span class="line">        gameRole.fight();</span><br><span class="line">        gameRole.stateDisplay();</span><br><span class="line">        System.out.println(<span class="string">&quot;------------æ¢å¤ä¹‹å‰çŠ¶æ€------------&quot;</span>);</span><br><span class="line">        <span class="comment">//æ¢å¤ä¹‹å‰çŠ¶æ€</span></span><br><span class="line">        gameRole.recoverState(roleStateCaretaker.getRoleStateMemento());</span><br><span class="line">        gameRole.stateDisplay();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-3-7-2-é»‘ç®±å¤‡å¿˜å½•æ¨¡å¼"><a href="#3-3-7-2-é»‘ç®±å¤‡å¿˜å½•æ¨¡å¼" class="headerlink" title="3.3.7.2 é»‘ç®±å¤‡å¿˜å½•æ¨¡å¼"></a>3.3.7.2 é»‘ç®±å¤‡å¿˜å½•æ¨¡å¼</h4><blockquote><p>å¤‡å¿˜å½•è§’è‰²å¯¹å‘èµ·äººå¯¹è±¡æä¾›ä¸€ä¸ªå®½æ¥å£ï¼Œè€Œä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ä¸ªçª„æ¥å£ã€‚åœ¨Javaè¯­è¨€ä¸­ï¼Œå®ç°åŒé‡æ¥å£çš„åŠæ³•å°±æ˜¯å°†å¤‡å¿˜å½•ç±»è®¾è®¡æˆå‘èµ·äººç±»çš„å†…éƒ¨æˆå‘˜ç±»ã€‚</p><p>å°† RoleStateMemento è®¾ä¸º GameRole çš„å†…éƒ¨ç±»ï¼Œä»è€Œå°† RoleStateMemento å¯¹è±¡å°è£…åœ¨ GameRole é‡Œé¢ï¼›åœ¨å¤–é¢æä¾›ä¸€ä¸ªæ ‡è¯†æ¥å£ Memento ç»™ RoleStateCaretaker åŠå…¶ä»–å¯¹è±¡ä½¿ç”¨ã€‚è¿™æ · GameRole ç±»çœ‹åˆ°çš„æ˜¯ RoleStateMemento æ‰€æœ‰çš„æ¥å£ï¼Œè€ŒRoleStateCaretaker åŠå…¶ä»–å¯¹è±¡çœ‹åˆ°çš„ä»…ä»…æ˜¯æ ‡è¯†æ¥å£ Memento æ‰€æš´éœ²å‡ºæ¥çš„æ¥å£ï¼Œä»è€Œç»´æŠ¤äº†å°è£…å‹ã€‚ç±»å›¾å¦‚ä¸‹ï¼š</p></blockquote><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%A4%87%E5%BF%98%E5%BD%95%E6%A8%A1%E5%BC%8F-%E9%BB%91%E7%AE%B1%E7%B1%BB%E5%9B%BE.png" class="" title="å¤‡å¿˜å½•æ¨¡å¼-é»‘ç®±ç±»å›¾"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// çª„æ¥å£Mementoï¼Œè¿™æ˜¯ä¸€ä¸ªæ ‡è¯†æ¥å£ï¼Œå› æ­¤æ²¡æœ‰å®šä¹‰å‡ºä»»ä½•çš„æ–¹æ³•</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Memento</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰å‘èµ·äººç±» GameRoleï¼Œå¹¶åœ¨å†…éƒ¨å®šä¹‰å¤‡å¿˜å½•å†…éƒ¨ç±» RoleStateMementoï¼ˆè¯¥å†…éƒ¨ç±»è®¾ç½®ä¸ºç§æœ‰çš„ï¼‰</span></span><br><span class="line">/æ¸¸æˆè§’è‰²ç±»</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GameRole</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> vit; <span class="comment">//ç”Ÿå‘½åŠ›</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> atk; <span class="comment">//æ”»å‡»åŠ›</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> def; <span class="comment">//é˜²å¾¡åŠ›</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆå§‹åŒ–çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initState</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.vit = <span class="number">100</span>;</span><br><span class="line">        <span class="built_in">this</span>.atk = <span class="number">100</span>;</span><br><span class="line">        <span class="built_in">this</span>.def = <span class="number">100</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æˆ˜æ–—</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">fight</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.vit = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">this</span>.atk = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">this</span>.def = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä¿å­˜è§’è‰²çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">public</span> Memento <span class="title function_">saveState</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RoleStateMemento</span>(vit, atk, def);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å›å¤è§’è‰²çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">recoverState</span><span class="params">(Memento memento)</span> &#123;</span><br><span class="line">        <span class="type">RoleStateMemento</span> <span class="variable">roleStateMemento</span> <span class="operator">=</span> (RoleStateMemento) memento;</span><br><span class="line">        <span class="built_in">this</span>.vit = roleStateMemento.getVit();</span><br><span class="line">        <span class="built_in">this</span>.atk = roleStateMemento.getAtk();</span><br><span class="line">        <span class="built_in">this</span>.def = roleStateMemento.getDef();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">stateDisplay</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;è§’è‰²ç”Ÿå‘½åŠ›ï¼š&quot;</span> + vit);</span><br><span class="line">        System.out.println(<span class="string">&quot;è§’è‰²æ”»å‡»åŠ›ï¼š&quot;</span> + atk);</span><br><span class="line">        System.out.println(<span class="string">&quot;è§’è‰²é˜²å¾¡åŠ›ï¼š&quot;</span> + def);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getVit</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> vit;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setVit</span><span class="params">(<span class="type">int</span> vit)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.vit = vit;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAtk</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> atk;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAtk</span><span class="params">(<span class="type">int</span> atk)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.atk = atk;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getDef</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> def;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDef</span><span class="params">(<span class="type">int</span> def)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.def = def;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">class</span> <span class="title class_">RoleStateMemento</span> <span class="keyword">implements</span> <span class="title class_">Memento</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> vit;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> atk;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> def;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">RoleStateMemento</span><span class="params">(<span class="type">int</span> vit, <span class="type">int</span> atk, <span class="type">int</span> def)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.vit = vit;</span><br><span class="line">            <span class="built_in">this</span>.atk = atk;</span><br><span class="line">            <span class="built_in">this</span>.def = def;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getVit</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> vit;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setVit</span><span class="params">(<span class="type">int</span> vit)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.vit = vit;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAtk</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> atk;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAtk</span><span class="params">(<span class="type">int</span> atk)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.atk = atk;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getDef</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> def;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDef</span><span class="params">(<span class="type">int</span> def)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.def = def;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è´Ÿè´£äººè§’è‰²ç±» RoleStateCaretaker èƒ½å¤Ÿå¾—åˆ°çš„å¤‡å¿˜å½•å¯¹è±¡æ˜¯ä»¥ Memento ä¸ºæ¥å£çš„ï¼Œç”±äºè¿™ä¸ªæ¥å£ä»…ä»…æ˜¯ä¸€ä¸ªæ ‡è¯†æ¥å£ï¼Œå› æ­¤è´Ÿè´£äººè§’è‰²ä¸å¯èƒ½æ”¹å˜è¿™ä¸ªå¤‡å¿˜å½•å¯¹è±¡çš„å†…å®¹</span></span><br><span class="line"><span class="comment">//è§’è‰²çŠ¶æ€ç®¡ç†è€…ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RoleStateCaretaker</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Memento memento;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Memento <span class="title function_">getMemento</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> memento;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMemento</span><span class="params">(Memento memento)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.memento = memento;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æµ‹è¯•ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;------------å¤§æˆ˜Bosså‰------------&quot;</span>);</span><br><span class="line">        <span class="comment">//å¤§æˆ˜Bosså‰</span></span><br><span class="line">        <span class="type">GameRole</span> <span class="variable">gameRole</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GameRole</span>();</span><br><span class="line">        gameRole.initState();</span><br><span class="line">        gameRole.stateDisplay();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ä¿å­˜è¿›åº¦</span></span><br><span class="line">        <span class="type">RoleStateCaretaker</span> <span class="variable">roleStateCaretaker</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RoleStateCaretaker</span>();</span><br><span class="line">        roleStateCaretaker.setMemento(gameRole.saveState());</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;------------å¤§æˆ˜Bosså------------&quot;</span>);</span><br><span class="line">        <span class="comment">//å¤§æˆ˜Bossæ—¶ï¼ŒæŸè€—ä¸¥é‡</span></span><br><span class="line">        gameRole.fight();</span><br><span class="line">        gameRole.stateDisplay();</span><br><span class="line">        System.out.println(<span class="string">&quot;------------æ¢å¤ä¹‹å‰çŠ¶æ€------------&quot;</span>);</span><br><span class="line">        <span class="comment">//æ¢å¤ä¹‹å‰çŠ¶æ€</span></span><br><span class="line">        gameRole.recoverState(roleStateCaretaker.getMemento());</span><br><span class="line">        gameRole.stateDisplay();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä¼˜ç¼ºç‚¹</strong></p><blockquote><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>æä¾›äº†ä¸€ç§å¯ä»¥æ¢å¤çŠ¶æ€çš„æœºåˆ¶ã€‚å½“ç”¨æˆ·éœ€è¦æ—¶èƒ½å¤Ÿæ¯”è¾ƒæ–¹ä¾¿åœ°å°†æ•°æ®æ¢å¤åˆ°æŸä¸ªå†å²çš„çŠ¶æ€ã€‚</li><li>å®ç°äº†å†…éƒ¨çŠ¶æ€çš„å°è£…ã€‚é™¤äº†åˆ›å»ºå®ƒçš„å‘èµ·äººä¹‹å¤–ï¼Œå…¶ä»–å¯¹è±¡éƒ½ä¸èƒ½å¤Ÿè®¿é—®è¿™äº›çŠ¶æ€ä¿¡æ¯ã€‚</li><li>ç®€åŒ–äº†å‘èµ·äººç±»ã€‚å‘èµ·äººä¸éœ€è¦ç®¡ç†å’Œä¿å­˜å…¶å†…éƒ¨çŠ¶æ€çš„å„ä¸ªå¤‡ä»½ï¼Œæ‰€æœ‰çŠ¶æ€ä¿¡æ¯éƒ½ä¿å­˜åœ¨å¤‡å¿˜å½•ä¸­ï¼Œå¹¶ç”±ç®¡ç†è€…è¿›è¡Œç®¡ç†ï¼Œè¿™ç¬¦åˆå•ä¸€èŒè´£åŸåˆ™ã€‚</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>èµ„æºæ¶ˆè€—å¤§ã€‚å¦‚æœè¦ä¿å­˜çš„å†…éƒ¨çŠ¶æ€ä¿¡æ¯è¿‡å¤šæˆ–è€…ç‰¹åˆ«é¢‘ç¹ï¼Œå°†ä¼šå ç”¨æ¯”è¾ƒå¤§çš„å†…å­˜èµ„æºã€‚</li></ul></blockquote><p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p><blockquote><ul><li>éœ€è¦ä¿å­˜ä¸æ¢å¤æ•°æ®çš„åœºæ™¯ï¼Œå¦‚ç©æ¸¸æˆæ—¶çš„ä¸­é—´ç»“æœçš„å­˜æ¡£åŠŸèƒ½ã€‚</li><li>éœ€è¦æä¾›ä¸€ä¸ªå¯å›æ»šæ“ä½œçš„åœºæ™¯ï¼Œå¦‚ Wordã€è®°äº‹æœ¬ã€Photoshopï¼Œideaç­‰è½¯ä»¶åœ¨ç¼–è¾‘æ—¶æŒ‰ Ctrl+Z ç»„åˆé”®ï¼Œè¿˜æœ‰æ•°æ®åº“ä¸­äº‹åŠ¡æ“ä½œã€‚</li></ul></blockquote><h3 id="3-3-8-çŠ¶æ€æ¨¡å¼"><a href="#3-3-8-çŠ¶æ€æ¨¡å¼" class="headerlink" title="3.3.8 çŠ¶æ€æ¨¡å¼"></a>3.3.8 çŠ¶æ€æ¨¡å¼</h3><p>å¯¹æœ‰çŠ¶æ€çš„å¯¹è±¡ï¼ŒæŠŠå¤æ‚çš„â€œåˆ¤æ–­é€»è¾‘â€æå–åˆ°ä¸åŒçš„çŠ¶æ€å¯¹è±¡ä¸­ï¼Œå…è®¸çŠ¶æ€å¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶æ”¹å˜å…¶è¡Œä¸ºã€‚</p><p><strong>ä»¥ä¸‹ä¾‹å­æœ‰å¾…ä¼˜åŒ–</strong></p><blockquote><p>é€šè¿‡æŒ‰é’®æ¥æ§åˆ¶ä¸€ä¸ªç”µæ¢¯çš„çŠ¶æ€ï¼Œä¸€ä¸ªç”µæ¢¯æœ‰å¼€é—¨çŠ¶æ€ï¼Œå…³é—¨çŠ¶æ€ï¼Œåœæ­¢çŠ¶æ€ï¼Œè¿è¡ŒçŠ¶æ€ã€‚æ¯ä¸€ç§çŠ¶æ€æ”¹å˜ï¼Œéƒ½æœ‰å¯èƒ½è¦æ ¹æ®å…¶ä»–çŠ¶æ€æ¥æ›´æ–°å¤„ç†ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç”µæ¢¯é—¨ç°åœ¨å¤„äºè¿è¡Œæ—¶çŠ¶æ€ï¼Œå°±ä¸èƒ½è¿›è¡Œå¼€é—¨æ“ä½œï¼Œè€Œå¦‚æœç”µæ¢¯é—¨æ˜¯åœæ­¢çŠ¶æ€ï¼Œå°±å¯ä»¥æ‰§è¡Œå¼€é—¨æ“ä½œã€‚</p></blockquote><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F-%E5%BE%85%E4%BC%98%E5%8C%96%E4%BE%8B%E5%AD%90%E7%B1%BB%E5%9B%BE.png" class="" title="çŠ¶æ€æ¨¡å¼-å¾…ä¼˜åŒ–ä¾‹å­ç±»å›¾"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ILift</span> &#123;</span><br><span class="line">    <span class="comment">//ç”µæ¢¯çš„4ä¸ªçŠ¶æ€</span></span><br><span class="line">    <span class="comment">//å¼€é—¨çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">OPENING_STATE</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="comment">//å…³é—¨çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">CLOSING_STATE</span> <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line">    <span class="comment">//è¿è¡ŒçŠ¶æ€</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">RUNNING_STATE</span> <span class="operator">=</span> <span class="number">3</span>;</span><br><span class="line">    <span class="comment">//åœæ­¢çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">STOPPING_STATE</span> <span class="operator">=</span> <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è®¾ç½®ç”µæ¢¯çš„çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setState</span><span class="params">(<span class="type">int</span> state)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”µæ¢¯çš„åŠ¨ä½œ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">open</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">stop</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Lift</span> <span class="keyword">implements</span> <span class="title class_">ILift</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> state;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setState</span><span class="params">(<span class="type">int</span> state)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.state = state;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ‰§è¡Œå…³é—¨åŠ¨ä½œ</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="built_in">this</span>.state) &#123;</span><br><span class="line">            <span class="keyword">case</span> OPENING_STATE:</span><br><span class="line">                System.out.println(<span class="string">&quot;ç”µæ¢¯å…³é—¨äº†ã€‚ã€‚ã€‚&quot;</span>);<span class="comment">//åªæœ‰å¼€é—¨çŠ¶æ€å¯ä»¥å…³é—­ç”µæ¢¯é—¨ï¼Œå¯ä»¥å¯¹åº”ç”µæ¢¯çŠ¶æ€è¡¨æ¥çœ‹</span></span><br><span class="line">                <span class="built_in">this</span>.setState(CLOSING_STATE);<span class="comment">//å…³é—¨ä¹‹åç”µæ¢¯å°±æ˜¯å…³é—­çŠ¶æ€äº†</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> CLOSING_STATE:</span><br><span class="line">                <span class="comment">//do nothing //å·²ç»æ˜¯å…³é—¨çŠ¶æ€ï¼Œä¸èƒ½å…³é—¨</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> RUNNING_STATE:</span><br><span class="line">                <span class="comment">//do nothing //è¿è¡Œæ—¶ç”µæ¢¯é—¨æ˜¯å…³ç€çš„ï¼Œä¸èƒ½å…³é—¨</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> STOPPING_STATE:</span><br><span class="line">                <span class="comment">//do nothing //åœæ­¢æ—¶ç”µæ¢¯ä¹Ÿæ˜¯å…³ç€çš„ï¼Œä¸èƒ½å…³é—¨</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ‰§è¡Œå¼€é—¨åŠ¨ä½œ</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">open</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="built_in">this</span>.state) &#123;</span><br><span class="line">            <span class="keyword">case</span> OPENING_STATE:<span class="comment">//é—¨å·²ç»å¼€äº†ï¼Œä¸èƒ½å†å¼€é—¨äº†</span></span><br><span class="line">                <span class="comment">//do nothing</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> CLOSING_STATE:<span class="comment">//å…³é—¨çŠ¶æ€ï¼Œé—¨æ‰“å¼€:</span></span><br><span class="line">                System.out.println(<span class="string">&quot;ç”µæ¢¯é—¨æ‰“å¼€äº†ã€‚ã€‚ã€‚&quot;</span>);</span><br><span class="line">                <span class="built_in">this</span>.setState(OPENING_STATE);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> RUNNING_STATE:</span><br><span class="line">                <span class="comment">//do nothing è¿è¡Œæ—¶ç”µæ¢¯ä¸èƒ½å¼€é—¨</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> STOPPING_STATE:</span><br><span class="line">                System.out.println(<span class="string">&quot;ç”µæ¢¯é—¨å¼€äº†ã€‚ã€‚ã€‚&quot;</span>);<span class="comment">//ç”µæ¢¯åœäº†ï¼Œå¯ä»¥å¼€é—¨äº†</span></span><br><span class="line">                <span class="built_in">this</span>.setState(OPENING_STATE);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ‰§è¡Œè¿è¡ŒåŠ¨ä½œ</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="built_in">this</span>.state) &#123;</span><br><span class="line">            <span class="keyword">case</span> OPENING_STATE:<span class="comment">//ç”µæ¢¯ä¸èƒ½å¼€ç€é—¨å°±èµ°</span></span><br><span class="line">                <span class="comment">//do nothing</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> CLOSING_STATE:<span class="comment">//é—¨å…³äº†ï¼Œå¯ä»¥è¿è¡Œäº†</span></span><br><span class="line">                System.out.println(<span class="string">&quot;ç”µæ¢¯å¼€å§‹è¿è¡Œäº†ã€‚ã€‚ã€‚&quot;</span>);</span><br><span class="line">                <span class="built_in">this</span>.setState(RUNNING_STATE);<span class="comment">//ç°åœ¨æ˜¯è¿è¡ŒçŠ¶æ€</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> RUNNING_STATE:</span><br><span class="line">                <span class="comment">//do nothing å·²ç»æ˜¯è¿è¡ŒçŠ¶æ€äº†</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> STOPPING_STATE:</span><br><span class="line">                System.out.println(<span class="string">&quot;ç”µæ¢¯å¼€å§‹è¿è¡Œäº†ã€‚ã€‚ã€‚&quot;</span>);</span><br><span class="line">                <span class="built_in">this</span>.setState(RUNNING_STATE);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ‰§è¡Œåœæ­¢åŠ¨ä½œ</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">stop</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="built_in">this</span>.state) &#123;</span><br><span class="line">            <span class="keyword">case</span> OPENING_STATE: <span class="comment">//å¼€é—¨çš„ç”µæ¢¯å·²ç»æ˜¯æ˜¯åœæ­¢çš„äº†(æ­£å¸¸æƒ…å†µä¸‹)</span></span><br><span class="line">                <span class="comment">//do nothing</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> CLOSING_STATE:<span class="comment">//å…³é—¨æ—¶æ‰å¯ä»¥åœæ­¢</span></span><br><span class="line">                System.out.println(<span class="string">&quot;ç”µæ¢¯åœæ­¢äº†ã€‚ã€‚ã€‚&quot;</span>);</span><br><span class="line">                <span class="built_in">this</span>.setState(STOPPING_STATE);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> RUNNING_STATE:<span class="comment">//è¿è¡Œæ—¶å½“ç„¶å¯ä»¥åœæ­¢äº†</span></span><br><span class="line">                System.out.println(<span class="string">&quot;ç”µæ¢¯åœæ­¢äº†ã€‚ã€‚ã€‚&quot;</span>);</span><br><span class="line">                <span class="built_in">this</span>.setState(STOPPING_STATE);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> STOPPING_STATE:</span><br><span class="line">                <span class="comment">//do nothing</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Lift</span> <span class="variable">lift</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Lift</span>();</span><br><span class="line">        lift.setState(ILift.STOPPING_STATE);<span class="comment">//ç”µæ¢¯æ˜¯åœæ­¢çš„</span></span><br><span class="line">        lift.open();<span class="comment">//å¼€é—¨</span></span><br><span class="line">        lift.close();<span class="comment">//å…³é—¨</span></span><br><span class="line">        lift.run();<span class="comment">//è¿è¡Œ</span></span><br><span class="line">        lift.stop();<span class="comment">//åœæ­¢</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å¯ä»¥çœ‹å‡ºï¼š</p><ul><li>ä½¿ç”¨äº†å¤§é‡çš„switchâ€¦caseè¿™æ ·çš„åˆ¤æ–­ï¼ˆifâ€¦elseä¹Ÿæ˜¯ä¸€æ ·)ï¼Œä½¿ç¨‹åºçš„å¯é˜…è¯»æ€§å˜å·®ã€‚</li><li>æ‰©å±•æ€§å¾ˆå·®ã€‚å¦‚æœæ–°åŠ äº†æ–­ç”µçš„çŠ¶æ€ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ä¸Šé¢åˆ¤æ–­é€»è¾‘</li></ul></blockquote><p><strong>ç»“æ„ï¼š</strong></p><blockquote><ul><li>ç¯å¢ƒï¼ˆContextï¼‰è§’è‰²ï¼šä¹Ÿç§°ä¸ºä¸Šä¸‹æ–‡ï¼Œå®ƒå®šä¹‰äº†å®¢æˆ·ç¨‹åºéœ€è¦çš„æ¥å£ï¼Œç»´æŠ¤ä¸€ä¸ªå½“å‰çŠ¶æ€ï¼Œå¹¶å°†ä¸çŠ¶æ€ç›¸å…³çš„æ“ä½œå§”æ‰˜ç»™å½“å‰çŠ¶æ€å¯¹è±¡æ¥å¤„ç†ã€‚</li><li>æŠ½è±¡çŠ¶æ€ï¼ˆStateï¼‰è§’è‰²ï¼šå®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œç”¨ä»¥å°è£…ç¯å¢ƒå¯¹è±¡ä¸­çš„ç‰¹å®šçŠ¶æ€æ‰€å¯¹åº”çš„è¡Œä¸ºã€‚</li><li>å…·ä½“çŠ¶æ€ï¼ˆConcrete Stateï¼‰è§’è‰²ï¼šå®ç°æŠ½è±¡çŠ¶æ€æ‰€å¯¹åº”çš„è¡Œä¸ºã€‚</li></ul></blockquote><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F%E7%B1%BB%E5%9B%BE.png" class="" title="çŠ¶æ€æ¨¡å¼ç±»å›¾"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æŠ½è±¡çŠ¶æ€ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">LiftState</span> &#123;</span><br><span class="line">    <span class="comment">//å®šä¹‰ä¸€ä¸ªç¯å¢ƒè§’è‰²ï¼Œä¹Ÿå°±æ˜¯å°è£…çŠ¶æ€çš„å˜åŒ–å¼•èµ·çš„åŠŸèƒ½å˜åŒ–</span></span><br><span class="line">    <span class="keyword">protected</span> Context context;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setContext</span><span class="params">(Context context)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.context = context;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”µæ¢¯å¼€é—¨åŠ¨ä½œ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">open</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”µæ¢¯å…³é—¨åŠ¨ä½œ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”µæ¢¯è¿è¡ŒåŠ¨ä½œ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”µæ¢¯åœæ­¢åŠ¨ä½œ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">stop</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¼€å¯çŠ¶æ€</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OpenningState</span> <span class="keyword">extends</span> <span class="title class_">LiftState</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¼€å¯å½“ç„¶å¯ä»¥å…³é—­äº†ï¼Œæˆ‘å°±æƒ³æµ‹è¯•ä¸€ä¸‹ç”µæ¢¯é—¨å¼€å…³åŠŸèƒ½</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">open</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç”µæ¢¯é—¨å¼€å¯...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//çŠ¶æ€ä¿®æ”¹</span></span><br><span class="line">        <span class="built_in">super</span>.context.setLiftState(Context.closeingState);</span><br><span class="line">        <span class="comment">//åŠ¨ä½œå§”æ‰˜ä¸ºCloseStateæ¥æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯å§”æ‰˜ç»™äº†ClosingStateå­ç±»æ‰§è¡Œè¿™ä¸ªåŠ¨ä½œ</span></span><br><span class="line">        <span class="built_in">super</span>.context.getLiftState().close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”µæ¢¯é—¨ä¸èƒ½å¼€ç€å°±è·‘ï¼Œè¿™é‡Œä»€ä¹ˆä¹Ÿä¸åš</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//do nothing</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¼€é—¨çŠ¶æ€å·²ç»æ˜¯åœæ­¢çš„äº†</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">stop</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//do nothing</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿è¡ŒçŠ¶æ€</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RunningState</span> <span class="keyword">extends</span> <span class="title class_">LiftState</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è¿è¡Œçš„æ—¶å€™å¼€ç”µæ¢¯é—¨ï¼Ÿä½ ç–¯äº†ï¼ç”µæ¢¯ä¸ä¼šç»™ä½ å¼€çš„</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">open</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//do nothing</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”µæ¢¯é—¨å…³é—­ï¼Ÿè¿™æ˜¯è‚¯å®šäº†</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span> &#123;<span class="comment">//è™½ç„¶å¯ä»¥å…³é—¨ï¼Œä½†è¿™ä¸ªåŠ¨ä½œä¸å½’æˆ‘æ‰§è¡Œ</span></span><br><span class="line">        <span class="comment">//do nothing</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è¿™æ˜¯åœ¨è¿è¡ŒçŠ¶æ€ä¸‹è¦å®ç°çš„æ–¹æ³•</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç”µæ¢¯æ­£åœ¨è¿è¡Œ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è¿™ä¸ªäº‹ç»å¯¹æ˜¯åˆç†çš„ï¼Œå…‰è¿è¡Œä¸åœæ­¢è¿˜æœ‰è°æ•¢åšè¿™ä¸ªç”µæ¢¯ï¼Ÿï¼ä¼°è®¡åªæœ‰ä¸Šå¸äº†</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">stop</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.context.setLiftState(Context.stoppingState);</span><br><span class="line">        <span class="built_in">super</span>.context.stop();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åœæ­¢çŠ¶æ€</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StoppingState</span> <span class="keyword">extends</span> <span class="title class_">LiftState</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åœæ­¢çŠ¶æ€ï¼Œå¼€é—¨ï¼Œé‚£æ˜¯è¦çš„ï¼</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">open</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//çŠ¶æ€ä¿®æ”¹</span></span><br><span class="line">        <span class="built_in">super</span>.context.setLiftState(Context.openningState);</span><br><span class="line">        <span class="comment">//åŠ¨ä½œå§”æ‰˜ä¸ºCloseStateæ¥æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯å§”æ‰˜ç»™äº†ClosingStateå­ç±»æ‰§è¡Œè¿™ä¸ªåŠ¨ä½œ</span></span><br><span class="line">        <span class="built_in">super</span>.context.getLiftState().open();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span> &#123;<span class="comment">//è™½ç„¶å¯ä»¥å…³é—¨ï¼Œä½†è¿™ä¸ªåŠ¨ä½œä¸å½’æˆ‘æ‰§è¡Œ</span></span><br><span class="line">        <span class="comment">//çŠ¶æ€ä¿®æ”¹</span></span><br><span class="line">        <span class="built_in">super</span>.context.setLiftState(Context.closeingState);</span><br><span class="line">        <span class="comment">//åŠ¨ä½œå§”æ‰˜ä¸ºCloseStateæ¥æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯å§”æ‰˜ç»™äº†ClosingStateå­ç±»æ‰§è¡Œè¿™ä¸ªåŠ¨ä½œ</span></span><br><span class="line">        <span class="built_in">super</span>.context.getLiftState().close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åœæ­¢çŠ¶æ€å†è·‘èµ·æ¥ï¼Œæ­£å¸¸çš„å¾ˆ</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//çŠ¶æ€ä¿®æ”¹</span></span><br><span class="line">        <span class="built_in">super</span>.context.setLiftState(Context.runningState);</span><br><span class="line">        <span class="comment">//åŠ¨ä½œå§”æ‰˜ä¸ºCloseStateæ¥æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯å§”æ‰˜ç»™äº†ClosingStateå­ç±»æ‰§è¡Œè¿™ä¸ªåŠ¨ä½œ</span></span><br><span class="line">        <span class="built_in">super</span>.context.getLiftState().run();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åœæ­¢çŠ¶æ€æ˜¯æ€ä¹ˆå‘ç”Ÿçš„å‘¢ï¼Ÿå½“ç„¶æ˜¯åœæ­¢æ–¹æ³•æ‰§è¡Œäº†</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">stop</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç”µæ¢¯åœæ­¢äº†...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å…³é—­çŠ¶æ€</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ClosingState</span> <span class="keyword">extends</span> <span class="title class_">LiftState</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="comment">//ç”µæ¢¯é—¨å…³é—­ï¼Œè¿™æ˜¯å…³é—­çŠ¶æ€è¦å®ç°çš„åŠ¨ä½œ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç”µæ¢¯é—¨å…³é—­...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”µæ¢¯é—¨å…³äº†å†æ‰“å¼€ï¼Œé€—ä½ ç©å‘¢ï¼Œé‚£è¿™ä¸ªå…è®¸å‘€</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">open</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.context.setLiftState(Context.openningState);</span><br><span class="line">        <span class="built_in">super</span>.context.open();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”µæ¢¯é—¨å…³äº†å°±è·‘ï¼Œè¿™æ˜¯å†æ­£å¸¸ä¸è¿‡äº†</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.context.setLiftState(Context.runningState);</span><br><span class="line">        <span class="built_in">super</span>.context.run();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”µæ¢¯é—¨å…³ç€ï¼Œæˆ‘å°±ä¸æŒ‰æ¥¼å±‚</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">stop</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.context.setLiftState(Context.stoppingState);</span><br><span class="line">        <span class="built_in">super</span>.context.stop();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¯å¢ƒè§’è‰²</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Context</span> &#123;</span><br><span class="line">    <span class="comment">//å®šä¹‰å‡ºæ‰€æœ‰çš„ç”µæ¢¯çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="type">OpenningState</span> <span class="variable">openningState</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OpenningState</span>();<span class="comment">//å¼€é—¨çŠ¶æ€ï¼Œè¿™æ—¶å€™ç”µæ¢¯åªèƒ½å…³é—­</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="type">ClosingState</span> <span class="variable">closeingState</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClosingState</span>();<span class="comment">//å…³é—­çŠ¶æ€ï¼Œè¿™æ—¶å€™ç”µæ¢¯å¯ä»¥è¿è¡Œã€åœæ­¢å’Œå¼€é—¨</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="type">RunningState</span> <span class="variable">runningState</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RunningState</span>();<span class="comment">//è¿è¡ŒçŠ¶æ€ï¼Œè¿™æ—¶å€™ç”µæ¢¯åªèƒ½åœæ­¢</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="type">StoppingState</span> <span class="variable">stoppingState</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StoppingState</span>();<span class="comment">//åœæ­¢çŠ¶æ€ï¼Œè¿™æ—¶å€™ç”µæ¢¯å¯ä»¥å¼€é—¨ã€è¿è¡Œ</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//å®šä¹‰ä¸€ä¸ªå½“å‰ç”µæ¢¯çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">private</span> LiftState liftState;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> LiftState <span class="title function_">getLiftState</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.liftState;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setLiftState</span><span class="params">(LiftState liftState)</span> &#123;</span><br><span class="line">        <span class="comment">//å½“å‰ç¯å¢ƒæ”¹å˜</span></span><br><span class="line">        <span class="built_in">this</span>.liftState = liftState;</span><br><span class="line">        <span class="comment">//æŠŠå½“å‰çš„ç¯å¢ƒé€šçŸ¥åˆ°å„ä¸ªå®ç°ç±»ä¸­</span></span><br><span class="line">        <span class="built_in">this</span>.liftState.setContext(<span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">open</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.liftState.open();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.liftState.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.liftState.run();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">stop</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.liftState.stop();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Context</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Context</span>();</span><br><span class="line">        context.setLiftState(<span class="keyword">new</span> <span class="title class_">ClosingState</span>());</span><br><span class="line"></span><br><span class="line">        context.open();</span><br><span class="line">        context.close();</span><br><span class="line">        context.run();</span><br><span class="line">        context.stop();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä¼˜ç¼ºç‚¹</strong></p><blockquote><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>å°†æ‰€æœ‰ä¸æŸä¸ªçŠ¶æ€æœ‰å…³çš„è¡Œä¸ºæ”¾åˆ°ä¸€ä¸ªç±»ä¸­ï¼Œå¹¶ä¸”å¯ä»¥æ–¹ä¾¿åœ°å¢åŠ æ–°çš„çŠ¶æ€ï¼Œåªéœ€è¦æ”¹å˜å¯¹è±¡çŠ¶æ€å³å¯æ”¹å˜å¯¹è±¡çš„è¡Œä¸ºã€‚</li><li>å…è®¸çŠ¶æ€è½¬æ¢é€»è¾‘ä¸çŠ¶æ€å¯¹è±¡åˆæˆä¸€ä½“ï¼Œè€Œä¸æ˜¯æŸä¸€ä¸ªå·¨å¤§çš„æ¡ä»¶è¯­å¥å—ã€‚</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>çŠ¶æ€æ¨¡å¼çš„ä½¿ç”¨å¿…ç„¶ä¼šå¢åŠ ç³»ç»Ÿç±»å’Œå¯¹è±¡çš„ä¸ªæ•°ã€‚</li><li>çŠ¶æ€æ¨¡å¼çš„ç»“æ„ä¸å®ç°éƒ½è¾ƒä¸ºå¤æ‚ï¼Œå¦‚æœä½¿ç”¨ä¸å½“å°†å¯¼è‡´ç¨‹åºç»“æ„å’Œä»£ç çš„æ··ä¹±ã€‚</li><li>çŠ¶æ€æ¨¡å¼å¯¹â€å¼€é—­åŸåˆ™â€çš„æ”¯æŒå¹¶ä¸å¤ªå¥½ã€‚</li></ul></blockquote><p><strong>ä½¿ç”¨åœºæ™¯</strong></p><blockquote><ul><li>å½“ä¸€ä¸ªå¯¹è±¡çš„è¡Œä¸ºå–å†³äºå®ƒçš„çŠ¶æ€ï¼Œå¹¶ä¸”å®ƒå¿…é¡»åœ¨è¿è¡Œæ—¶æ ¹æ®çŠ¶æ€æ”¹å˜å®ƒçš„è¡Œä¸ºæ—¶ï¼Œå°±å¯ä»¥è€ƒè™‘ä½¿ç”¨çŠ¶æ€æ¨¡å¼ã€‚</li><li>ä¸€ä¸ªæ“ä½œä¸­å«æœ‰åºå¤§çš„åˆ†æ”¯ç»“æ„ï¼Œå¹¶ä¸”è¿™äº›åˆ†æ”¯å†³å®šäºå¯¹è±¡çš„çŠ¶æ€æ—¶ã€‚</li></ul></blockquote><h3 id="3-3-9-è®¿é—®è€…æ¨¡å¼"><a href="#3-3-9-è®¿é—®è€…æ¨¡å¼" class="headerlink" title="3.3.9 è®¿é—®è€…æ¨¡å¼"></a>3.3.9 è®¿é—®è€…æ¨¡å¼</h3><p>å°è£…ä¸€äº›ä½œç”¨äºæŸç§æ•°æ®ç»“æ„ä¸­çš„å„å…ƒç´ çš„æ“ä½œï¼Œå®ƒå¯ä»¥åœ¨ä¸æ”¹å˜è¿™ä¸ªæ•°æ®ç»“æ„çš„å‰æä¸‹å®šä¹‰ä½œç”¨äºè¿™äº›å…ƒç´ çš„æ–°çš„æ“ä½œã€‚</p><p><strong>ç»“æ„ï¼š</strong></p><blockquote><ul><li><strong>æŠ½è±¡è®¿é—®è€…ï¼ˆVisitorï¼‰è§’è‰²ï¼š</strong>å®šä¹‰äº†å¯¹æ¯ä¸€ä¸ªå…ƒç´ ï¼ˆElementï¼‰è®¿é—®çš„è¡Œä¸ºï¼Œå®ƒçš„å‚æ•°å°±æ˜¯å¯ä»¥è®¿é—®çš„å…ƒç´ ï¼Œå®ƒçš„æ–¹æ³•ä¸ªæ•°ç†è®ºä¸Šæ¥è®²ä¸å…ƒç´ ç±»ä¸ªæ•°ï¼ˆElementçš„å®ç°ç±»ä¸ªæ•°ï¼‰æ˜¯ä¸€æ ·çš„ï¼Œä»è¿™ç‚¹ä¸éš¾çœ‹å‡ºï¼Œè®¿é—®è€…æ¨¡å¼è¦æ±‚å…ƒç´ ç±»çš„ä¸ªæ•°ä¸èƒ½æ”¹å˜ã€‚</li><li><strong>å…·ä½“è®¿é—®è€…ï¼ˆConcreteVisitorï¼‰è§’è‰²ï¼š</strong>ç»™å‡ºå¯¹æ¯ä¸€ä¸ªå…ƒç´ ç±»è®¿é—®æ—¶æ‰€äº§ç”Ÿçš„å…·ä½“è¡Œä¸ºã€‚</li><li><strong>æŠ½è±¡å…ƒç´ ï¼ˆElementï¼‰è§’è‰²ï¼š</strong>å®šä¹‰äº†ä¸€ä¸ªæ¥å—è®¿é—®è€…çš„æ–¹æ³•ï¼ˆacceptï¼‰ï¼Œå…¶æ„ä¹‰æ˜¯æŒ‡ï¼Œæ¯ä¸€ä¸ªå…ƒç´ éƒ½è¦å¯ä»¥è¢«è®¿é—®è€…è®¿é—®ã€‚</li><li><strong>å…·ä½“å…ƒç´ ï¼ˆConcreteElementï¼‰è§’è‰²ï¼š</strong>æä¾›æ¥å—è®¿é—®æ–¹æ³•çš„å…·ä½“å®ç°ï¼Œè€Œè¿™ä¸ªå…·ä½“çš„å®ç°ï¼Œé€šå¸¸æƒ…å†µä¸‹æ˜¯ä½¿ç”¨è®¿é—®è€…æä¾›çš„è®¿é—®è¯¥å…ƒç´ ç±»çš„æ–¹æ³•ã€‚</li><li><strong>å¯¹è±¡ç»“æ„ï¼ˆObject Structureï¼‰è§’è‰²ï¼š</strong>å®šä¹‰å½“ä¸­æ‰€æåˆ°çš„å¯¹è±¡ç»“æ„ï¼Œå¯¹è±¡ç»“æ„æ˜¯ä¸€ä¸ªæŠ½è±¡è¡¨è¿°ï¼Œå…·ä½“ç‚¹å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªå…·æœ‰å®¹å™¨æ€§è´¨æˆ–è€…å¤åˆå¯¹è±¡ç‰¹æ€§çš„ç±»ï¼Œå®ƒä¼šå«æœ‰ä¸€ç»„å…ƒç´ ï¼ˆElementï¼‰ï¼Œå¹¶ä¸”å¯ä»¥è¿­ä»£è¿™äº›å…ƒç´ ï¼Œä¾›è®¿é—®è€…è®¿é—®ã€‚</li></ul></blockquote><p><strong>ä¾‹å­ï¼š</strong></p><blockquote><ul><li><p>ç°åœ¨å…»å® ç‰©çš„äººç‰¹åˆ«å¤šï¼Œæˆ‘ä»¬å°±ä»¥è¿™ä¸ªä¸ºä¾‹ï¼Œå½“ç„¶å® ç‰©è¿˜åˆ†ä¸ºç‹—ï¼ŒçŒ«ç­‰ï¼Œè¦ç»™å® ç‰©å–‚é£Ÿçš„è¯ï¼Œä¸»äººå¯ä»¥å–‚ï¼Œå…¶ä»–äººä¹Ÿå¯ä»¥å–‚é£Ÿã€‚</p></li><li><p>è®¿é—®è€…è§’è‰²ï¼šç»™å® ç‰©å–‚é£Ÿçš„äºº</p></li><li><p>å…·ä½“è®¿é—®è€…è§’è‰²ï¼šä¸»äººã€å…¶ä»–äºº</p></li><li><p>æŠ½è±¡å…ƒç´ è§’è‰²ï¼šåŠ¨ç‰©æŠ½è±¡ç±»</p></li><li><p>å…·ä½“å…ƒç´ è§’è‰²ï¼šå® ç‰©ç‹—ã€å® ç‰©çŒ«</p></li><li><p>ç»“æ„å¯¹è±¡è§’è‰²ï¼šä¸»äººå®¶</p></li></ul></blockquote><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BF%E9%97%AE%E8%80%85%E6%A8%A1%E5%BC%8F%E7%B1%BB%E5%9B%BE.png" class="" title="è®¿é—®è€…æ¨¡å¼ç±»å›¾"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»ºæŠ½è±¡è®¿é—®è€…æ¥å£</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">feed</span><span class="params">(Cat cat)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">feed</span><span class="params">(Dog dog)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºä¸åŒçš„å…·ä½“è®¿é—®è€…è§’è‰²ï¼ˆä¸»äººå’Œå…¶ä»–äººï¼‰ï¼Œéƒ½éœ€è¦å®ç° Personæ¥å£</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Owner</span> <span class="keyword">implements</span> <span class="title class_">Person</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">feed</span><span class="params">(Cat cat)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸»äººå–‚é£ŸçŒ«&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">feed</span><span class="params">(Dog dog)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸»äººå–‚é£Ÿç‹—&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Someone</span> <span class="keyword">implements</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">feed</span><span class="params">(Cat cat)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å…¶ä»–äººå–‚é£ŸçŒ«&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">feed</span><span class="params">(Dog dog)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å…¶ä»–äººå–‚é£Ÿç‹—&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰æŠ½è±¡èŠ‚ç‚¹ â€“ å® ç‰©</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">accept</span><span class="params">(Person person)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Dog</span> <span class="keyword">implements</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">accept</span><span class="params">(Person person)</span> &#123;</span><br><span class="line">        person.feed(<span class="built_in">this</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;å¥½å¥½åƒï¼Œæ±ªæ±ªæ±ªï¼ï¼ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰å®ç°Animalæ¥å£çš„ å…·ä½“èŠ‚ç‚¹ï¼ˆå…ƒç´ ï¼‰</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Cat</span> <span class="keyword">implements</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">accept</span><span class="params">(Person person)</span> &#123;</span><br><span class="line">        person.feed(<span class="built_in">this</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;å¥½å¥½åƒï¼Œå–µå–µå–µï¼ï¼ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰å¯¹è±¡ç»“æ„ï¼Œæ­¤æ¡ˆä¾‹ä¸­å°±æ˜¯ä¸»äººçš„å®¶</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Home</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Animal&gt; nodeList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Animal&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">action</span><span class="params">(Person person)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (Animal node : nodeList) &#123;</span><br><span class="line">            node.accept(person);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ·»åŠ æ“ä½œ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(Animal animal)</span> &#123;</span><br><span class="line">        nodeList.add(animal);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æµ‹è¯•ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Home</span> <span class="variable">home</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Home</span>();</span><br><span class="line">        home.add(<span class="keyword">new</span> <span class="title class_">Dog</span>());</span><br><span class="line">        home.add(<span class="keyword">new</span> <span class="title class_">Cat</span>());</span><br><span class="line"></span><br><span class="line">        <span class="type">Owner</span> <span class="variable">owner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Owner</span>();</span><br><span class="line">        home.action(owner);</span><br><span class="line"></span><br><span class="line">        <span class="type">Someone</span> <span class="variable">someone</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Someone</span>();</span><br><span class="line">        home.action(someone);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä¼˜ç¼ºç‚¹</strong></p><blockquote><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>æ‰©å±•æ€§å¥½ï¼šåœ¨ä¸ä¿®æ”¹å¯¹è±¡ç»“æ„ä¸­çš„å…ƒç´ çš„æƒ…å†µä¸‹ï¼Œä¸ºå¯¹è±¡ç»“æ„ä¸­çš„å…ƒç´ æ·»åŠ æ–°çš„åŠŸèƒ½ã€‚</li><li>å¤ç”¨æ€§å¥½ï¼šé€šè¿‡è®¿é—®è€…æ¥å®šä¹‰æ•´ä¸ªå¯¹è±¡ç»“æ„é€šç”¨çš„åŠŸèƒ½ï¼Œä»è€Œæé«˜å¤ç”¨ç¨‹åº¦ã€‚</li><li>åˆ†ç¦»æ— å…³è¡Œä¸ºï¼šé€šè¿‡è®¿é—®è€…æ¥åˆ†ç¦»æ— å…³çš„è¡Œä¸ºï¼ŒæŠŠç›¸å…³çš„è¡Œä¸ºå°è£…åœ¨ä¸€èµ·ï¼Œæ„æˆä¸€ä¸ªè®¿é—®è€…ï¼Œè¿™æ ·æ¯ä¸€ä¸ªè®¿é—®è€…çš„åŠŸèƒ½éƒ½æ¯”è¾ƒå•ä¸€ã€‚</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>å¯¹è±¡ç»“æ„å˜åŒ–å¾ˆå›°éš¾ï¼šåœ¨è®¿é—®è€…æ¨¡å¼ä¸­ï¼Œæ¯å¢åŠ ä¸€ä¸ªæ–°çš„å…ƒç´ ç±»ï¼Œéƒ½è¦åœ¨æ¯ä¸€ä¸ªå…·ä½“è®¿é—®è€…ç±»ä¸­å¢åŠ ç›¸åº”çš„å…·ä½“æ“ä½œï¼Œè¿™è¿èƒŒäº†â€œå¼€é—­åŸåˆ™â€ã€‚</li><li>è¿åäº†ä¾èµ–å€’ç½®åŸåˆ™ï¼šè®¿é—®è€…æ¨¡å¼ä¾èµ–äº†å…·ä½“ç±»ï¼Œè€Œæ²¡æœ‰ä¾èµ–æŠ½è±¡ç±»ã€‚</li></ul></blockquote><p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p><blockquote><ul><li>å¯¹è±¡ç»“æ„ç›¸å¯¹ç¨³å®šï¼Œä½†å…¶æ“ä½œç®—æ³•ç»å¸¸å˜åŒ–çš„ç¨‹åºã€‚</li><li>å¯¹è±¡ç»“æ„ä¸­çš„å¯¹è±¡éœ€è¦æä¾›å¤šç§ä¸åŒä¸”ä¸ç›¸å…³çš„æ“ä½œï¼Œè€Œä¸”è¦é¿å…è®©è¿™äº›æ“ä½œçš„å˜åŒ–å½±å“å¯¹è±¡çš„ç»“æ„ã€‚</li></ul></blockquote><p><strong>æ‰©å±•ï¼š</strong><br><strong>è®¿é—®è€…æ¨¡å¼ç”¨åˆ°äº†ä¸€ç§åŒåˆ†æ´¾çš„æŠ€æœ¯</strong><br><strong>å˜é‡è¢«å£°æ˜æ—¶çš„ç±»å‹å«åšå˜é‡çš„é™æ€ç±»å‹ï¼Œæœ‰äº›äººåˆæŠŠé™æ€ç±»å‹å«åšæ˜æ˜¾ç±»å‹ï¼›è€Œå˜é‡æ‰€å¼•ç”¨çš„å¯¹è±¡çš„çœŸå®ç±»å‹åˆå«åšå˜é‡çš„å®é™…ç±»å‹ã€‚æ¯”å¦‚ Map map &#x3D; new HashMap() ï¼Œmapå˜é‡çš„é™æ€ç±»å‹æ˜¯ Map ï¼Œå®é™…ç±»å‹æ˜¯ HashMap ã€‚æ ¹æ®å¯¹è±¡çš„ç±»å‹è€Œå¯¹æ–¹æ³•è¿›è¡Œçš„é€‰æ‹©ï¼Œå°±æ˜¯åˆ†æ´¾(Dispatch)ï¼Œåˆ†æ´¾(Dispatch)åˆåˆ†ä¸ºä¸¤ç§ï¼Œå³é™æ€åˆ†æ´¾å’ŒåŠ¨æ€åˆ†æ´¾ã€‚</strong></p><blockquote><p>**é™æ€åˆ†æ´¾(Static Dispatch) **å‘ç”Ÿåœ¨ç¼–è¯‘æ—¶æœŸï¼Œåˆ†æ´¾æ ¹æ®é™æ€ç±»å‹ä¿¡æ¯å‘ç”Ÿã€‚é™æ€åˆ†æ´¾å¯¹äºæˆ‘ä»¬æ¥è¯´å¹¶ä¸é™Œç”Ÿï¼Œæ–¹æ³•é‡è½½å°±æ˜¯é™æ€åˆ†æ´¾ã€‚<br>**åŠ¨æ€åˆ†æ´¾(Dynamic Dispatch) **å‘ç”Ÿåœ¨è¿è¡Œæ—¶æœŸï¼ŒåŠ¨æ€åˆ†æ´¾åŠ¨æ€åœ°ç½®æ¢æ‰æŸä¸ªæ–¹æ³•ã€‚Javaé€šè¿‡æ–¹æ³•çš„é‡å†™æ”¯æŒåŠ¨æ€åˆ†æ´¾ã€‚</p></blockquote><ol><li>é™æ€åˆ†æ´¾ï¼šé€šè¿‡æ–¹æ³•é‡è½½æ”¯æŒé™æ€åˆ†æ´¾ã€‚<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Dog</span> <span class="keyword">extends</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Cat</span> <span class="keyword">extends</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Execute</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">execute</span><span class="params">(Animal a)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Animal&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">execute</span><span class="params">(Dog d)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;dog&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">execute</span><span class="params">(Cat c)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;cat&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Animal</span> <span class="variable">a</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Animal</span>();</span><br><span class="line">        <span class="type">Animal</span> <span class="variable">a1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Dog</span>();</span><br><span class="line">        <span class="type">Animal</span> <span class="variable">a2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cat</span>();</span><br><span class="line"></span><br><span class="line">        <span class="type">Execute</span> <span class="variable">exe</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Execute</span>();</span><br><span class="line">        exe.execute(a);</span><br><span class="line">        exe.execute(a1);</span><br><span class="line">        exe.execute(a2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ç»“æœ</span></span><br><span class="line">animal</span><br><span class="line">animal</span><br><span class="line">animal</span><br><span class="line"><span class="comment">// å› ä¸ºé‡è½½æ–¹æ³•çš„åˆ†æ´¾æ˜¯æ ¹æ®é™æ€ç±»å‹è¿›è¡Œçš„ï¼Œè¿™ä¸ªåˆ†æ´¾è¿‡ç¨‹åœ¨ç¼–è¯‘æ—¶æœŸå°±å®Œæˆäº†ã€‚</span></span><br></pre></td></tr></table></figure></li><li>åŠ¨æ€åˆ†æ´¾ï¼šé€šè¿‡æ–¹æ³•çš„é‡å†™æ”¯æŒåŠ¨æ€åˆ†æ´¾<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">execute</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Animal&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Dog</span> <span class="keyword">extends</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">execute</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;dog&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Cat</span> <span class="keyword">extends</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">     <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">execute</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;cat&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Animal</span> <span class="variable">a</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Dog</span>();</span><br><span class="line">        a.execute();</span><br><span class="line">        </span><br><span class="line">        <span class="type">Animal</span> <span class="variable">a1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cat</span>();</span><br><span class="line">        a1.execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p>3.åŒåˆ†æ´¾</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ‰€è°“åŒåˆ†æ´¾æŠ€æœ¯å°±æ˜¯åœ¨é€‰æ‹©ä¸€ä¸ªæ–¹æ³•çš„æ—¶å€™ï¼Œä¸ä»…ä»…è¦æ ¹æ®æ¶ˆæ¯æ¥æ”¶è€…ï¼ˆreceiverï¼‰çš„è¿è¡Œæ—¶åŒºåˆ«ï¼Œè¿˜è¦æ ¹æ®å‚æ•°çš„è¿è¡Œæ—¶åŒºåˆ«ã€‚</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">accept</span><span class="params">(Execute exe)</span> &#123;</span><br><span class="line">        exe.execute(<span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Dog</span> <span class="keyword">extends</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">accept</span><span class="params">(Execute exe)</span> &#123;</span><br><span class="line">        exe.execute(<span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Cat</span> <span class="keyword">extends</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">accept</span><span class="params">(Execute exe)</span> &#123;</span><br><span class="line">        exe.execute(<span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Execute</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">execute</span><span class="params">(Animal a)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;animal&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">execute</span><span class="params">(Dog d)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;dog&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">execute</span><span class="params">(Cat c)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;cat&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Animal</span> <span class="variable">a</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Animal</span>();</span><br><span class="line">        <span class="type">Animal</span> <span class="variable">d</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Dog</span>();</span><br><span class="line">        <span class="type">Animal</span> <span class="variable">c</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cat</span>();</span><br><span class="line"></span><br><span class="line">        <span class="type">Execute</span> <span class="variable">exe</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Execute</span>();</span><br><span class="line">        a.accept(exe);</span><br><span class="line">        d.accept(exe);</span><br><span class="line">        c.accept(exe);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨ä¸Šé¢ä»£ç ä¸­ï¼Œå®¢æˆ·ç«¯å°†Executeå¯¹è±¡åšä¸ºå‚æ•°ä¼ é€’ç»™Animalç±»å‹çš„å˜é‡è°ƒç”¨çš„æ–¹æ³•ï¼Œè¿™é‡Œå®Œæˆç¬¬ä¸€æ¬¡åˆ†æ´¾ï¼Œè¿™é‡Œæ˜¯æ–¹æ³•é‡å†™ï¼Œæ‰€ä»¥æ˜¯åŠ¨æ€åˆ†æ´¾ï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œå®é™…ç±»å‹ä¸­çš„æ–¹æ³•ï¼ŒåŒæ—¶ä¹Ÿå°†è‡ªå·±thisä½œä¸ºå‚æ•°ä¼ é€’è¿›å»ï¼Œè¿™é‡Œå°±å®Œæˆäº†ç¬¬äºŒæ¬¡åˆ†æ´¾ï¼Œè¿™é‡Œçš„Executeç±»ä¸­æœ‰å¤šä¸ªé‡è½½çš„æ–¹æ³•ï¼Œè€Œä¼ é€’è¿›è¡Œçš„æ˜¯thisï¼Œå°±æ˜¯å…·ä½“çš„å®é™…ç±»å‹çš„å¯¹è±¡ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯´åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å·²ç»æ˜ç™½åŒåˆ†æ´¾æ˜¯æ€ä¹ˆå›äº‹äº†ï¼Œä½†æ˜¯å®ƒæœ‰ä»€ä¹ˆæ•ˆæœå‘¢ï¼Ÿå°±æ˜¯å¯ä»¥å®ç°æ–¹æ³•çš„åŠ¨æ€ç»‘å®šï¼Œæˆ‘ä»¬å¯ä»¥å¯¹ä¸Šé¢çš„ç¨‹åºè¿›è¡Œä¿®æ”¹ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»“æœ</span></span><br><span class="line"><span class="comment">// animal</span></span><br><span class="line"><span class="comment">// dog</span></span><br><span class="line"><span class="comment">// cat</span></span><br></pre></td></tr></table></figure><blockquote><p>åŒåˆ†æ´¾å®ç°åŠ¨æ€ç»‘å®šçš„æœ¬è´¨ï¼Œå°±æ˜¯åœ¨é‡è½½æ–¹æ³•å§”æ´¾çš„å‰é¢åŠ ä¸Šäº†ç»§æ‰¿ä½“ç³»ä¸­è¦†ç›–çš„ç¯èŠ‚ï¼Œç”±äºè¦†ç›–æ˜¯åŠ¨æ€çš„ï¼Œæ‰€ä»¥é‡è½½å°±æ˜¯åŠ¨æ€çš„äº†ã€‚</p></blockquote><h3 id="3-3-10-ä¸­ä»‹è€…æ¨¡å¼"><a href="#3-3-10-ä¸­ä»‹è€…æ¨¡å¼" class="headerlink" title="3.3.10 ä¸­ä»‹è€…æ¨¡å¼"></a>3.3.10 ä¸­ä»‹è€…æ¨¡å¼</h3><blockquote><p>åˆå«è°ƒåœæ¨¡å¼ï¼Œå®šä¹‰ä¸€ä¸ªä¸­ä»‹è§’è‰²æ¥å°è£…ä¸€ç³»åˆ—å¯¹è±¡ä¹‹é—´çš„äº¤äº’ï¼Œä½¿åŸæœ‰å¯¹è±¡ä¹‹é—´çš„è€¦åˆæ¾æ•£ï¼Œä¸”å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å®ƒä»¬ä¹‹é—´çš„äº¤äº’ã€‚</p></blockquote><p>ä¸€èˆ¬æ¥è¯´ï¼ŒåŒäº‹ç±»ä¹‹é—´çš„å…³ç³»æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼Œå¤šä¸ªåŒäº‹ç±»ä¹‹é—´äº’ç›¸å…³è”æ—¶ï¼Œä»–ä»¬ä¹‹é—´çš„å…³ç³»ä¼šå‘ˆç°ä¸ºå¤æ‚çš„ç½‘çŠ¶ç»“æ„ï¼Œè¿™æ˜¯ä¸€ç§è¿‡åº¦è€¦åˆçš„æ¶æ„ï¼Œå³ä¸åˆ©äºç±»çš„å¤ç”¨ï¼Œä¹Ÿä¸ç¨³å®šã€‚ä¾‹å¦‚åœ¨ä¸‹å›¾ä¸­ï¼Œæœ‰å…­ä¸ªåŒäº‹ç±»å¯¹è±¡ï¼Œå‡å¦‚å¯¹è±¡1å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆå°†ä¼šæœ‰4ä¸ªå¯¹è±¡å—åˆ°å½±å“ã€‚å¦‚æœå¯¹è±¡2å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆå°†ä¼šæœ‰5ä¸ªå¯¹è±¡å—åˆ°å½±å“ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒåŒäº‹ç±»ä¹‹é—´ç›´æ¥å…³è”çš„è®¾è®¡æ˜¯ä¸å¥½çš„ã€‚</p><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F-%E5%8F%8D%E9%9D%A2%E4%BE%8B%E5%AD%90.png" class="" title="ä¸­ä»‹è€…æ¨¡å¼-åé¢ä¾‹å­"><p>å¦‚æœå¼•å…¥ä¸­ä»‹è€…æ¨¡å¼ï¼Œé‚£ä¹ˆåŒäº‹ç±»ä¹‹é—´çš„å…³ç³»å°†å˜ä¸ºæ˜Ÿå‹ç»“æ„ï¼Œä»ä¸‹å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œä»»ä½•ä¸€ä¸ªç±»çš„å˜åŠ¨ï¼Œåªä¼šå½±å“çš„ç±»æœ¬èº«ï¼Œä»¥åŠä¸­ä»‹è€…ï¼Œè¿™æ ·å°±å‡å°äº†ç³»ç»Ÿçš„è€¦åˆã€‚ä¸€ä¸ªå¥½çš„è®¾è®¡ï¼Œå¿…å®šä¸ä¼šæŠŠæ‰€æœ‰çš„å¯¹è±¡å…³ç³»å¤„ç†é€»è¾‘å°è£…åœ¨æœ¬ç±»ä¸­ï¼Œè€Œæ˜¯ä½¿ç”¨ä¸€ä¸ªä¸“é—¨çš„ç±»æ¥ç®¡ç†é‚£äº›ä¸å±äºè‡ªå·±çš„è¡Œä¸ºã€‚</p><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F-%E4%BC%98%E5%8C%96%E5%90%8E%E4%BE%8B%E5%AD%90.png" class="" title="ä¸­ä»‹è€…æ¨¡å¼-ä¼˜åŒ–åä¾‹å­"><p><strong>ç»“æ„ï¼š</strong></p><blockquote><ul><li><strong>æŠ½è±¡ä¸­ä»‹è€…ï¼ˆMediatorï¼‰è§’è‰²ï¼š</strong>å®ƒæ˜¯ä¸­ä»‹è€…çš„æ¥å£ï¼Œæä¾›äº†åŒäº‹å¯¹è±¡æ³¨å†Œä¸è½¬å‘åŒäº‹å¯¹è±¡ä¿¡æ¯çš„æŠ½è±¡æ–¹æ³•ã€‚</li><li><strong>å…·ä½“ä¸­ä»‹è€…ï¼ˆConcreteMediatorï¼‰è§’è‰²ï¼š</strong>å®ç°ä¸­ä»‹è€…æ¥å£ï¼Œå®šä¹‰ä¸€ä¸ª List æ¥ç®¡ç†åŒäº‹å¯¹è±¡ï¼Œåè°ƒå„ä¸ªåŒäº‹è§’è‰²ä¹‹é—´çš„äº¤äº’å…³ç³»ï¼Œå› æ­¤å®ƒä¾èµ–äºåŒäº‹è§’è‰²ã€‚</li><li><strong>æŠ½è±¡åŒäº‹ç±»ï¼ˆColleagueï¼‰è§’è‰²ï¼š</strong>å®šä¹‰åŒäº‹ç±»çš„æ¥å£ï¼Œä¿å­˜ä¸­ä»‹è€…å¯¹è±¡ï¼Œæä¾›åŒäº‹å¯¹è±¡äº¤äº’çš„æŠ½è±¡æ–¹æ³•ï¼Œå®ç°æ‰€æœ‰ç›¸äº’å½±å“çš„åŒäº‹ç±»çš„å…¬å…±åŠŸèƒ½ã€‚</li><li><strong>å…·ä½“åŒäº‹ç±»ï¼ˆConcrete Colleagueï¼‰è§’è‰²ï¼š</strong>æ˜¯æŠ½è±¡åŒäº‹ç±»çš„å®ç°è€…ï¼Œå½“éœ€è¦ä¸å…¶ä»–åŒäº‹å¯¹è±¡äº¤äº’æ—¶ï¼Œç”±ä¸­ä»‹è€…å¯¹è±¡è´Ÿè´£åç»­çš„äº¤äº’ã€‚</li></ul></blockquote><p><strong>ä¾‹å­ï¼š</strong><br>ç°åœ¨ç§Ÿæˆ¿åŸºæœ¬éƒ½æ˜¯é€šè¿‡æˆ¿å±‹ä¸­ä»‹ï¼Œæˆ¿ä¸»å°†æˆ¿å±‹æ‰˜ç®¡ç»™æˆ¿å±‹ä¸­ä»‹ï¼Œè€Œç§Ÿæˆ¿è€…ä»æˆ¿å±‹ä¸­ä»‹è·å–æˆ¿å±‹ä¿¡æ¯ã€‚æˆ¿å±‹ä¸­ä»‹å……å½“ç§Ÿæˆ¿è€…ä¸æˆ¿å±‹æ‰€æœ‰è€…ä¹‹é—´çš„ä¸­ä»‹è€…ã€‚</p><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F-%E4%BE%8B%E5%AD%90%E7%B1%BB%E5%9B%BE.png" class="" title="ä¸­ä»‹è€…æ¨¡å¼-ä¾‹å­ç±»å›¾"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æŠ½è±¡ä¸­ä»‹è€…</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Mediator</span> &#123;</span><br><span class="line">    <span class="comment">//ç”³æ˜ä¸€ä¸ªè”ç»œæ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">constact</span><span class="params">(String message,Person person)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŠ½è±¡åŒäº‹ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="keyword">protected</span> String name;</span><br><span class="line">    <span class="keyword">protected</span> Mediator mediator;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">(String name,Mediator mediator)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.mediator = mediator;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å…·ä½“åŒäº‹ç±» æˆ¿å±‹æ‹¥æœ‰è€…</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HouseOwner</span> <span class="keyword">extends</span> <span class="title class_">Person</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">HouseOwner</span><span class="params">(String name, Mediator mediator)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(name, mediator);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä¸ä¸­ä»‹è€…è”ç³»</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">constact</span><span class="params">(String message)</span>&#123;</span><br><span class="line">        mediator.constact(message, <span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è·å–ä¿¡æ¯</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getMessage</span><span class="params">(String message)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æˆ¿ä¸»&quot;</span> + name +<span class="string">&quot;è·å–åˆ°çš„ä¿¡æ¯ï¼š&quot;</span> + message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å…·ä½“åŒäº‹ç±» æ‰¿ç§Ÿäºº</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Tenant</span> <span class="keyword">extends</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Tenant</span><span class="params">(String name, Mediator mediator)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(name, mediator);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä¸ä¸­ä»‹è€…è”ç³»</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">constact</span><span class="params">(String message)</span>&#123;</span><br><span class="line">        mediator.constact(message, <span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è·å–ä¿¡æ¯</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getMessage</span><span class="params">(String message)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç§Ÿæˆ¿è€…&quot;</span> + name +<span class="string">&quot;è·å–åˆ°çš„ä¿¡æ¯ï¼š&quot;</span> + message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸­ä»‹æœºæ„</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MediatorStructure</span> <span class="keyword">extends</span> <span class="title class_">Mediator</span> &#123;</span><br><span class="line">    <span class="comment">//é¦–å…ˆä¸­ä»‹ç»“æ„å¿…é¡»çŸ¥é“æ‰€æœ‰æˆ¿ä¸»å’Œç§Ÿæˆ¿è€…çš„ä¿¡æ¯</span></span><br><span class="line">    <span class="keyword">private</span> HouseOwner houseOwner;</span><br><span class="line">    <span class="keyword">private</span> Tenant tenant;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> HouseOwner <span class="title function_">getHouseOwner</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> houseOwner;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setHouseOwner</span><span class="params">(HouseOwner houseOwner)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.houseOwner = houseOwner;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Tenant <span class="title function_">getTenant</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> tenant;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setTenant</span><span class="params">(Tenant tenant)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.tenant = tenant;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">constact</span><span class="params">(String message, Person person)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (person == houseOwner) &#123;          <span class="comment">//å¦‚æœæ˜¯æˆ¿ä¸»ï¼Œåˆ™ç§Ÿæˆ¿è€…è·å¾—ä¿¡æ¯</span></span><br><span class="line">            tenant.getMessage(message);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;       <span class="comment">//åæ­£åˆ™æ˜¯æˆ¿ä¸»è·å¾—ä¿¡æ¯</span></span><br><span class="line">            houseOwner.getMessage(message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//ä¸€ä¸ªæˆ¿ä¸»ã€ä¸€ä¸ªç§Ÿæˆ¿è€…ã€ä¸€ä¸ªä¸­ä»‹æœºæ„</span></span><br><span class="line">        <span class="type">MediatorStructure</span> <span class="variable">mediator</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MediatorStructure</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æˆ¿ä¸»å’Œç§Ÿæˆ¿è€…åªéœ€è¦çŸ¥é“ä¸­ä»‹æœºæ„å³å¯</span></span><br><span class="line">        <span class="type">HouseOwner</span> <span class="variable">houseOwner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HouseOwner</span>(<span class="string">&quot;å¼ ä¸‰&quot;</span>, mediator);</span><br><span class="line">        <span class="type">Tenant</span> <span class="variable">tenant</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Tenant</span>(<span class="string">&quot;æå››&quot;</span>, mediator);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ä¸­ä»‹ç»“æ„è¦çŸ¥é“æˆ¿ä¸»å’Œç§Ÿæˆ¿è€…</span></span><br><span class="line">        mediator.setHouseOwner(houseOwner);</span><br><span class="line">        mediator.setTenant(tenant);</span><br><span class="line"></span><br><span class="line">        tenant.constact(<span class="string">&quot;éœ€è¦ç§Ÿä¸‰å®¤çš„æˆ¿å­&quot;</span>);</span><br><span class="line">        houseOwner.constact(<span class="string">&quot;æˆ‘è¿™æœ‰ä¸‰å®¤çš„æˆ¿å­ï¼Œä½ éœ€è¦ç§Ÿå—ï¼Ÿ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>ä¼˜ç¼ºç‚¹</strong></p><blockquote><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>æ¾æ•£è€¦åˆï¼šä¸­ä»‹è€…æ¨¡å¼é€šè¿‡æŠŠå¤šä¸ªåŒäº‹å¯¹è±¡ä¹‹é—´çš„äº¤äº’å°è£…åˆ°ä¸­ä»‹è€…å¯¹è±¡é‡Œé¢ï¼Œä»è€Œä½¿å¾—åŒäº‹å¯¹è±¡ä¹‹é—´æ¾æ•£è€¦åˆï¼ŒåŸºæœ¬ä¸Šå¯ä»¥åšåˆ°äº’è¡¥ä¾èµ–ã€‚è¿™æ ·ä¸€æ¥ï¼ŒåŒäº‹å¯¹è±¡å°±å¯ä»¥ç‹¬ç«‹åœ°å˜åŒ–å’Œå¤ç”¨ï¼Œè€Œä¸å†åƒä»¥å‰é‚£æ ·â€œç‰µä¸€å¤„è€ŒåŠ¨å…¨èº«â€äº†ã€‚</li><li>é›†ä¸­æ§åˆ¶äº¤äº’ï¼šå¤šä¸ªåŒäº‹å¯¹è±¡çš„äº¤äº’ï¼Œè¢«å°è£…åœ¨ä¸­ä»‹è€…å¯¹è±¡é‡Œé¢é›†ä¸­ç®¡ç†ï¼Œä½¿å¾—è¿™äº›äº¤äº’è¡Œä¸ºå‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œåªéœ€è¦ä¿®æ”¹ä¸­ä»‹è€…å¯¹è±¡å°±å¯ä»¥äº†ï¼Œå½“ç„¶å¦‚æœæ˜¯å·²ç»åšå¥½çš„ç³»ç»Ÿï¼Œé‚£ä¹ˆå°±æ‰©å±•ä¸­ä»‹è€…å¯¹è±¡ï¼Œè€Œå„ä¸ªåŒäº‹ç±»ä¸éœ€è¦åšä¿®æ”¹ã€‚</li><li>ä¸€å¯¹å¤šå…³è”è½¬å˜ä¸ºä¸€å¯¹ä¸€çš„å…³è”ï¼šæ²¡æœ‰ä½¿ç”¨ä¸­ä»‹è€…æ¨¡å¼çš„æ—¶å€™ï¼ŒåŒäº‹å¯¹è±¡ä¹‹é—´çš„å…³ç³»é€šå¸¸æ˜¯ä¸€å¯¹å¤šçš„ï¼Œå¼•å…¥ä¸­ä»‹è€…å¯¹è±¡ä»¥åï¼Œä¸­ä»‹è€…å¯¹è±¡å’ŒåŒäº‹å¯¹è±¡çš„å…³ç³»é€šå¸¸å˜æˆåŒå‘çš„ä¸€å¯¹ä¸€ï¼Œè¿™ä¼šè®©å¯¹è±¡çš„å…³ç³»æ›´å®¹æ˜“ç†è§£å’Œå®ç°ã€‚</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>å½“åŒäº‹ç±»å¤ªå¤šæ—¶ï¼Œä¸­ä»‹è€…çš„èŒè´£å°†å¾ˆå¤§ï¼Œå®ƒä¼šå˜å¾—å¤æ‚è€Œåºå¤§ï¼Œä»¥è‡³äºç³»ç»Ÿéš¾ä»¥ç»´æŠ¤ã€‚</li></ul></blockquote><p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p><blockquote><ul><li>ç³»ç»Ÿä¸­å¯¹è±¡ä¹‹é—´å­˜åœ¨å¤æ‚çš„å¼•ç”¨å…³ç³»ï¼Œç³»ç»Ÿç»“æ„æ··ä¹±ä¸”éš¾ä»¥ç†è§£ã€‚</li><li>å½“æƒ³åˆ›å»ºä¸€ä¸ªè¿è¡Œäºå¤šä¸ªç±»ä¹‹é—´çš„å¯¹è±¡ï¼Œåˆä¸æƒ³ç”Ÿæˆæ–°çš„å­ç±»æ—¶ã€‚</li></ul></blockquote><h3 id="3-3-11-è§£é‡Šå™¨æ¨¡å¼"><a href="#3-3-11-è§£é‡Šå™¨æ¨¡å¼" class="headerlink" title="3.3.11 è§£é‡Šå™¨æ¨¡å¼"></a>3.3.11 è§£é‡Šå™¨æ¨¡å¼</h3><blockquote><p>ç»™å®šä¸€ä¸ªè¯­è¨€ï¼Œå®šä¹‰å®ƒçš„æ–‡æ³•è¡¨ç¤ºï¼Œå¹¶å®šä¹‰ä¸€ä¸ªè§£é‡Šå™¨ï¼Œè¿™ä¸ªè§£é‡Šå™¨ä½¿ç”¨è¯¥æ ‡è¯†æ¥è§£é‡Šè¯­è¨€ä¸­çš„å¥å­ã€‚<br>åœ¨è§£é‡Šå™¨æ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å°†å¾…è§£å†³çš„é—®é¢˜ï¼Œæå–å‡ºè§„åˆ™ï¼ŒæŠ½è±¡ä¸ºä¸€ç§â€œè¯­è¨€â€ã€‚æ¯”å¦‚åŠ å‡æ³•è¿ç®—ï¼Œè§„åˆ™ä¸ºï¼šç”±æ•°å€¼å’ŒÂ±ç¬¦å·ç»„æˆçš„åˆæ³•åºåˆ—ï¼Œâ€œ1+3-2â€ å°±æ˜¯è¿™ç§è¯­è¨€çš„å¥å­ã€‚è§£é‡Šå™¨å°±æ˜¯è¦è§£æå‡ºæ¥è¯­å¥çš„å«ä¹‰ã€‚ä½†æ˜¯å¦‚ä½•æè¿°è§„åˆ™å‘¢ï¼Ÿ</p></blockquote><p><strong>æ–‡æ³•ï¼ˆè¯­æ³•ï¼‰è§„åˆ™ï¼š</strong><br>æ–‡æ³•æ˜¯ç”¨äºæè¿°è¯­è¨€çš„è¯­æ³•ç»“æ„çš„å½¢å¼è§„åˆ™ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">expression ::= value | plus | minus</span><br><span class="line">plus ::= expression â€˜+â€™ expression   </span><br><span class="line">minus ::= expression â€˜-â€™ expression  </span><br><span class="line">value ::= integer</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼š è¿™é‡Œçš„ç¬¦å·â€œ::&#x3D;â€è¡¨ç¤ºâ€œå®šä¹‰ä¸ºâ€çš„æ„æ€ï¼Œç«–çº¿ | è¡¨ç¤ºæˆ–ï¼Œå·¦å³çš„å…¶ä¸­ä¸€ä¸ªï¼Œå¼•å·å†…ä¸ºå­—ç¬¦æœ¬èº«ï¼Œå¼•å·å¤–ä¸ºè¯­æ³•ã€‚<br>ä¸Šé¢è§„åˆ™æè¿°ä¸º ï¼šè¡¨è¾¾å¼å¯ä»¥æ˜¯ä¸€ä¸ªå€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯plusæˆ–è€…minusè¿ç®—ï¼Œè€Œpluså’Œminusåˆæ˜¯ç”±è¡¨è¾¾å¼ç»“åˆè¿ç®—ç¬¦æ„æˆï¼Œå€¼çš„ç±»å‹ä¸ºæ•´å‹æ•°ã€‚</p></blockquote><p><strong>æŠ½è±¡è¯­æ³•æ ‘ï¼š</strong><br>åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼ŒæŠ½è±¡è¯­æ³•æ ‘ï¼ˆAbstractSyntaxTreeï¼ŒASTï¼‰ï¼Œæˆ–ç®€ç§°è¯­æ³•æ ‘ï¼ˆSyntax treeï¼‰ï¼Œæ˜¯æºä»£ç è¯­æ³•ç»“æ„çš„ä¸€ç§æŠ½è±¡è¡¨ç¤ºã€‚å®ƒä»¥æ ‘çŠ¶çš„å½¢å¼è¡¨ç°ç¼–ç¨‹è¯­è¨€çš„è¯­æ³•ç»“æ„ï¼Œæ ‘ä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹éƒ½è¡¨ç¤ºæºä»£ç ä¸­çš„ä¸€ç§ç»“æ„ã€‚ç”¨æ ‘å½¢æ¥è¡¨ç¤ºç¬¦åˆæ–‡æ³•è§„åˆ™çš„å¥å­ã€‚</p><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A7%A3%E9%87%8A%E5%99%A8%E6%A8%A1%E5%BC%8F-%E8%AF%AD%E6%B3%95%E6%A0%91.png" class="" title="è§£é‡Šå™¨æ¨¡å¼-è¯­æ³•æ ‘"><p><strong>ç»“æ„ï¼š</strong></p><blockquote><ul><li><strong>æŠ½è±¡è¡¨è¾¾å¼ï¼ˆAbstract Expressionï¼‰è§’è‰²ï¼š</strong>å®šä¹‰è§£é‡Šå™¨çš„æ¥å£ï¼Œçº¦å®šè§£é‡Šå™¨çš„è§£é‡Šæ“ä½œï¼Œä¸»è¦åŒ…å«è§£é‡Šæ–¹æ³• interpret()ã€‚</li><li><strong>ç»ˆç»“ç¬¦è¡¨è¾¾å¼ï¼ˆTerminal Expressionï¼‰è§’è‰²ï¼š</strong>æ˜¯æŠ½è±¡è¡¨è¾¾å¼çš„å­ç±»ï¼Œç”¨æ¥å®ç°æ–‡æ³•ä¸­ä¸ç»ˆç»“ç¬¦ç›¸å…³çš„æ“ä½œï¼Œæ–‡æ³•ä¸­çš„æ¯ä¸€ä¸ªç»ˆç»“ç¬¦éƒ½æœ‰ä¸€ä¸ªå…·ä½“ç»ˆç»“è¡¨è¾¾å¼ä¸ä¹‹ç›¸å¯¹åº”ã€‚</li><li><strong>éç»ˆç»“ç¬¦è¡¨è¾¾å¼ï¼ˆNonterminal Expressionï¼‰è§’è‰²ï¼š</strong>ä¹Ÿæ˜¯æŠ½è±¡è¡¨è¾¾å¼çš„å­ç±»ï¼Œç”¨æ¥å®ç°æ–‡æ³•ä¸­ä¸éç»ˆç»“ç¬¦ç›¸å…³çš„æ“ä½œï¼Œæ–‡æ³•ä¸­çš„æ¯æ¡è§„åˆ™éƒ½å¯¹åº”äºä¸€ä¸ªéç»ˆç»“ç¬¦è¡¨è¾¾å¼ã€‚</li><li><strong>ç¯å¢ƒï¼ˆContextï¼‰è§’è‰²ï¼š</strong>é€šå¸¸åŒ…å«å„ä¸ªè§£é‡Šå™¨éœ€è¦çš„æ•°æ®æˆ–æ˜¯å…¬å…±çš„åŠŸèƒ½ï¼Œä¸€èˆ¬ç”¨æ¥ä¼ é€’è¢«æ‰€æœ‰è§£é‡Šå™¨å…±äº«çš„æ•°æ®ï¼Œåé¢çš„è§£é‡Šå™¨å¯ä»¥ä»è¿™é‡Œè·å–è¿™äº›å€¼ã€‚</li><li><strong>å®¢æˆ·ç«¯ï¼ˆClientï¼‰ï¼š</strong>ä¸»è¦ä»»åŠ¡æ˜¯å°†éœ€è¦åˆ†æçš„å¥å­æˆ–è¡¨è¾¾å¼è½¬æ¢æˆä½¿ç”¨è§£é‡Šå™¨å¯¹è±¡æè¿°çš„æŠ½è±¡è¯­æ³•æ ‘ï¼Œç„¶åè°ƒç”¨è§£é‡Šå™¨çš„è§£é‡Šæ–¹æ³•ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡ç¯å¢ƒè§’è‰²é—´æ¥è®¿é—®è§£é‡Šå™¨çš„è§£é‡Šæ–¹æ³•ã€‚</li></ul></blockquote><img src="/2024/05/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A7%A3%E9%87%8A%E5%99%A8%E6%A8%A1%E5%BC%8F-%E4%BE%8B%E5%AD%90%E7%B1%BB%E5%9B%BE.png" class="" title="è§£é‡Šå™¨æ¨¡å¼-ä¾‹å­ç±»å›¾"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æŠ½è±¡è§’è‰²AbstractExpression</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">AbstractExpression</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="type">int</span> <span class="title function_">interpret</span><span class="params">(Context context)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç»ˆç»“ç¬¦è¡¨è¾¾å¼è§’è‰²</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Value</span> <span class="keyword">extends</span> <span class="title class_">AbstractExpression</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> value;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Value</span><span class="params">(<span class="type">int</span> value)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">interpret</span><span class="params">(Context context)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Integer</span>(value).toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//éç»ˆç»“ç¬¦è¡¨è¾¾å¼è§’è‰²  åŠ æ³•è¡¨è¾¾å¼</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Plus</span> <span class="keyword">extends</span> <span class="title class_">AbstractExpression</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> AbstractExpression left;</span><br><span class="line">    <span class="keyword">private</span> AbstractExpression right;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Plus</span><span class="params">(AbstractExpression left, AbstractExpression right)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.left = left;</span><br><span class="line">        <span class="built_in">this</span>.right = right;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">interpret</span><span class="params">(Context context)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> left.interpret(context) + right.interpret(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;(&quot;</span> + left.toString() + <span class="string">&quot; + &quot;</span> + right.toString() + <span class="string">&quot;)&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">///éç»ˆç»“ç¬¦è¡¨è¾¾å¼è§’è‰² å‡æ³•è¡¨è¾¾å¼</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Minus</span> <span class="keyword">extends</span> <span class="title class_">AbstractExpression</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> AbstractExpression left;</span><br><span class="line">    <span class="keyword">private</span> AbstractExpression right;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Minus</span><span class="params">(AbstractExpression left, AbstractExpression right)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.left = left;</span><br><span class="line">        <span class="built_in">this</span>.right = right;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">interpret</span><span class="params">(Context context)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> left.interpret(context) - right.interpret(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;(&quot;</span> + left.toString() + <span class="string">&quot; - &quot;</span> + right.toString() + <span class="string">&quot;)&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç»ˆç»“ç¬¦è¡¨è¾¾å¼è§’è‰² å˜é‡è¡¨è¾¾å¼</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Variable</span> <span class="keyword">extends</span> <span class="title class_">AbstractExpression</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Variable</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">interpret</span><span class="params">(Context ctx)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> ctx.getValue(<span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¯å¢ƒç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Context</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Map&lt;Variable, Integer&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;Variable, Integer&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">assign</span><span class="params">(Variable <span class="keyword">var</span>, Integer value)</span> &#123;</span><br><span class="line">        map.put(<span class="keyword">var</span>, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getValue</span><span class="params">(Variable <span class="keyword">var</span>)</span> &#123;</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">value</span> <span class="operator">=</span> map.get(<span class="keyword">var</span>);</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Context</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Context</span>();</span><br><span class="line"></span><br><span class="line">        <span class="type">Variable</span> <span class="variable">a</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Variable</span>(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">        <span class="type">Variable</span> <span class="variable">b</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Variable</span>(<span class="string">&quot;b&quot;</span>);</span><br><span class="line">        <span class="type">Variable</span> <span class="variable">c</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Variable</span>(<span class="string">&quot;c&quot;</span>);</span><br><span class="line">        <span class="type">Variable</span> <span class="variable">d</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Variable</span>(<span class="string">&quot;d&quot;</span>);</span><br><span class="line">        <span class="type">Variable</span> <span class="variable">e</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Variable</span>(<span class="string">&quot;e&quot;</span>);</span><br><span class="line">        <span class="comment">//Value v = new Value(1);</span></span><br><span class="line"></span><br><span class="line">        context.assign(a, <span class="number">1</span>);</span><br><span class="line">        context.assign(b, <span class="number">2</span>);</span><br><span class="line">        context.assign(c, <span class="number">3</span>);</span><br><span class="line">        context.assign(d, <span class="number">4</span>);</span><br><span class="line">        context.assign(e, <span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">AbstractExpression</span> <span class="variable">expression</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Minus</span>(<span class="keyword">new</span> <span class="title class_">Plus</span>(<span class="keyword">new</span> <span class="title class_">Plus</span>(<span class="keyword">new</span> <span class="title class_">Plus</span>(a, b), c), d), e);</span><br><span class="line"></span><br><span class="line">        System.out.println(expression + <span class="string">&quot;= &quot;</span> + expression.interpret(context));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>ä¼˜ç¼ºç‚¹</strong></p><blockquote><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>æ˜“äºæ”¹å˜å’Œæ‰©å±•æ–‡æ³•ï¼šç”±äºåœ¨è§£é‡Šå™¨æ¨¡å¼ä¸­ä½¿ç”¨ç±»æ¥è¡¨ç¤ºè¯­è¨€çš„æ–‡æ³•è§„åˆ™ï¼Œå› æ­¤å¯ä»¥é€šè¿‡ç»§æ‰¿ç­‰æœºåˆ¶æ¥æ”¹å˜æˆ–æ‰©å±•æ–‡æ³•ã€‚æ¯ä¸€æ¡æ–‡æ³•è§„åˆ™éƒ½å¯ä»¥è¡¨ç¤ºä¸ºä¸€ä¸ªç±»ï¼Œå› æ­¤å¯ä»¥æ–¹ä¾¿åœ°å®ç°ä¸€ä¸ªç®€å•çš„è¯­è¨€ã€‚</li><li>å®ç°æ–‡æ³•è¾ƒä¸ºå®¹æ˜“ï¼šåœ¨æŠ½è±¡è¯­æ³•æ ‘ä¸­æ¯ä¸€ä¸ªè¡¨è¾¾å¼èŠ‚ç‚¹ç±»çš„å®ç°æ–¹å¼éƒ½æ˜¯ç›¸ä¼¼çš„ï¼Œè¿™äº›ç±»çš„ä»£ç ç¼–å†™éƒ½ä¸ä¼šç‰¹åˆ«å¤æ‚ã€‚</li><li>å¢åŠ æ–°çš„è§£é‡Šè¡¨è¾¾å¼è¾ƒä¸ºæ–¹ä¾¿ï¼šå¦‚æœç”¨æˆ·éœ€è¦å¢åŠ æ–°çš„è§£é‡Šè¡¨è¾¾å¼åªéœ€è¦å¯¹åº”å¢åŠ ä¸€ä¸ªæ–°çš„ç»ˆç»“ç¬¦è¡¨è¾¾å¼æˆ–éç»ˆç»“ç¬¦è¡¨è¾¾å¼ç±»ï¼ŒåŸæœ‰è¡¨è¾¾å¼ç±»ä»£ç æ— é¡»ä¿®æ”¹ï¼Œç¬¦åˆ â€œå¼€é—­åŸåˆ™â€ã€‚</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>å¯¹äºå¤æ‚æ–‡æ³•éš¾ä»¥ç»´æŠ¤ï¼šåœ¨è§£é‡Šå™¨æ¨¡å¼ä¸­ï¼Œæ¯ä¸€æ¡è§„åˆ™è‡³å°‘éœ€è¦å®šä¹‰ä¸€ä¸ªç±»ï¼Œå› æ­¤å¦‚æœä¸€ä¸ªè¯­è¨€åŒ…å«å¤ªå¤šæ–‡æ³•è§„åˆ™ï¼Œç±»çš„ä¸ªæ•°å°†ä¼šæ€¥å‰§å¢åŠ ï¼Œå¯¼è‡´ç³»ç»Ÿéš¾ä»¥ç®¡ç†å’Œç»´æŠ¤ã€‚</li><li>æ‰§è¡Œæ•ˆç‡è¾ƒä½ï¼šç”±äºåœ¨è§£é‡Šå™¨æ¨¡å¼ä¸­ä½¿ç”¨äº†å¤§é‡çš„å¾ªç¯å’Œé€’å½’è°ƒç”¨ï¼Œå› æ­¤åœ¨è§£é‡Šè¾ƒä¸ºå¤æ‚çš„å¥å­æ—¶å…¶é€Ÿåº¦å¾ˆæ…¢ï¼Œè€Œä¸”ä»£ç çš„è°ƒè¯•è¿‡ç¨‹ä¹Ÿæ¯”è¾ƒéº»çƒ¦ã€‚</li></ul></blockquote><p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p><blockquote><ul><li>å½“è¯­è¨€çš„æ–‡æ³•è¾ƒä¸ºç®€å•ï¼Œä¸”æ‰§è¡Œæ•ˆç‡ä¸æ˜¯å…³é”®é—®é¢˜æ—¶ã€‚</li><li>å½“é—®é¢˜é‡å¤å‡ºç°ï¼Œä¸”å¯ä»¥ç”¨ä¸€ç§ç®€å•çš„è¯­è¨€æ¥è¿›è¡Œè¡¨è¾¾æ—¶ã€‚</li><li>å½“ä¸€ä¸ªè¯­è¨€éœ€è¦è§£é‡Šæ‰§è¡Œï¼Œå¹¶ä¸”è¯­è¨€ä¸­çš„å¥å­å¯ä»¥è¡¨ç¤ºä¸ºä¸€ä¸ªæŠ½è±¡è¯­æ³•æ ‘çš„æ—¶å€™ã€‚</li></ul></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> è§£å†³æ–¹æ¡ˆ </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SQLä¼˜åŒ–</title>
      <link href="/2024/04/01/SQL%E4%BC%98%E5%8C%96/"/>
      <url>/2024/04/01/SQL%E4%BC%98%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h2 id="ä»¥å°è¡¨é©±åŠ¨å¤§è¡¨ï¼š"><a href="#ä»¥å°è¡¨é©±åŠ¨å¤§è¡¨ï¼š" class="headerlink" title="ä»¥å°è¡¨é©±åŠ¨å¤§è¡¨ï¼š"></a>ä»¥å°è¡¨é©±åŠ¨å¤§è¡¨ï¼š</h2><blockquote><p>é¦–å…ˆå°†å°è¡¨è¿›è¡Œæ‰«æï¼Œç„¶åå†æ ¹æ®å°è¡¨çš„ç»“æœå¯¹å¤§è¡¨è¿›è¡Œè¿æ¥æˆ–è¿‡æ»¤ï¼Œä»¥å‡å°‘å¤§è¡¨çš„æ•°æ®é‡ï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡ã€‚</p></blockquote><ul><li><p><strong>joinæ“ä½œï¼š</strong>å°è¡¨é©±åŠ¨å¤§è¡¨çš„å‰ææ˜¯å¤§è¡¨æœ‰å»ºç«‹å…³è”å­—æ®µçš„ç´¢å¼•ï¼Œå¦‚æœé€‰æ‹©Aè¡¨ä½œä¸ºé©±åŠ¨è¡¨ï¼ŒBè¡¨ä½œä¸ºè¢«é©±åŠ¨è¡¨ï¼Œæ•´ä¸ªè¿‡ç¨‹å°±æ˜¯å…ˆä»Aè¡¨ä¸­æ‹¿ä¸€è¡Œæ•°æ®ï¼Œå†æ‹¿å»ä¸Bè¡¨åŒ¹é…ï¼Œæ€»çš„æ—¶é—´å¤æ‚åº¦å°±æ˜¯Aè¡¨çš„è¡Œæ•°*Bè¡¨èµ°ç´¢å¼•çš„æ—¶é—´logNï¼Œæ‰€ä»¥åº”é€‰æ‹©Aè¡¨ä½œä¸ºå°è¡¨</p></li><li><p><strong>Inå­æŸ¥è¯¢ï¼š</strong>åœ¨ä½¿ç”¨Inå­æŸ¥è¯¢æ—¶ï¼ŒMySql çš„æ‰§è¡Œé¡ºåºä¼šå…ˆæ‰§è¡Œå­æŸ¥è¯¢ï¼Œå†æ‰§è¡Œä¸»æŸ¥è¯¢ã€‚æ‰€ä»¥ä½¿ç”¨æ—¶ï¼Œå°†å°è¡¨ä½œä¸ºä¸»æŸ¥è¯¢çš„å­æŸ¥è¯¢ï¼Œå³å°†å°è¡¨çš„ç»“æœä½œä¸ºInå…³é”®å­—åé¢çš„å­æŸ¥è¯¢ï¼Œè€Œå°†å¤§è¡¨ä½œä¸ºå¤–å±‚ä¸»æŸ¥è¯¢ã€‚è¿™æ ·æ•°æ®åº“å¼•æ“ä¼šå…ˆæ‰§è¡Œå°è¡¨çš„å­æŸ¥è¯¢ï¼Œè·å–ç»“æœé›†åå†å»åŒ¹é…å¤–å±‚ä¸»æŸ¥è¯¢çš„ç»“æœï¼Œä»è€Œå‡å°‘å¤§è¡¨çš„æ‰«ææ¬¡æ•°ã€‚<br>ä¾‹å¦‚ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> rate <span class="keyword">from</span> B <span class="keyword">where</span> id <span class="keyword">in</span>(<span class="keyword">select</span> id <span class="keyword">in</span> A) </span><br><span class="line"><span class="comment">-- è¿™é‡Œçš„Aåº”ä¸ºå°è¡¨</span></span><br></pre></td></tr></table></figure></li><li><p><strong>Existså­æŸ¥è¯¢ï¼š</strong>åœ¨ä½¿ç”¨Existså­æŸ¥è¯¢æ—¶ï¼Œä¼šå…ˆå¯¹where å‰çš„ä¸»æŸ¥è¯¢è¯¢è¿›è¡ŒæŸ¥è¯¢,ç„¶åç”¨ä¸»æŸ¥è¯¢çš„ç»“æœä¸€ä¸ªä¸€ä¸ªçš„ä»£å…¥existsçš„æŸ¥è¯¢è¿›è¡Œåˆ¤æ–­ã€‚æ‰€ä»¥ä½¿ç”¨Existsæ—¶ï¼Œè¦å°†å°è¡¨ä½œä¸ºå­æŸ¥è¯¢ã€‚è¿™æ ·æ•°æ®åº“å¼•æ“ä¼šå…ˆæ‰§è¡Œå°è¡¨çš„å­æŸ¥è¯¢ï¼Œè·å–ç»“æœé›†åå†å»åˆ¤æ–­å¤–å±‚ä¸»æŸ¥è¯¢æ˜¯å¦å­˜åœ¨ç¬¦åˆæ¡ä»¶çš„è®°å½•ï¼Œä»è€Œå‡å°‘å¤§è¡¨çš„æ‰«ææ¬¡æ•°ã€‚<br>ä¾‹å¦‚ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> rate <span class="keyword">from</span> B <span class="keyword">where</span> <span class="keyword">exists</span> (<span class="keyword">Select</span> <span class="operator">*</span> <span class="keyword">from</span> A <span class="keyword">where</span> B.id<span class="operator">=</span>A.id <span class="keyword">and</span> money <span class="operator">&gt;</span><span class="number">1000</span> );</span><br><span class="line"><span class="comment">-- è¿™é‡Œçš„Aåº”ä¸ºå°è¡¨</span></span><br></pre></td></tr></table></figure></li></ul><blockquote><p>æ³¨æ„ï¼šExistså’ŒInéƒ½æœ‰è¿‡æ»¤åŠŸèƒ½ï¼Œå®ƒä»¬æœ€å¤§çš„å·®åˆ«å°±æ˜¯inå¼•å¯¼çš„å­å¥åªèƒ½å¯¹ä¸€ä¸ªå­—æ®µè¿›è¡Œé™åˆ¶ï¼ŒExistså¯ä»¥å¯¹å¤šä¸ªå­—æ®µè¿›è¡Œé™åˆ¶</p></blockquote><h2 id="é¿å…ä½¿ç”¨-select"><a href="#é¿å…ä½¿ç”¨-select" class="headerlink" title="é¿å…ä½¿ç”¨ select *"></a>é¿å…ä½¿ç”¨ select *</h2><p><strong>åŸå› ï¼š</strong></p><ul><li>å¦‚æœå®é™…ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œæ ¹æœ¬ç”¨ä¸ä¸Šé‚£ä¹ˆå¤šåˆ—çš„æ•°æ®ï¼Œé‚£å¤šæŸ¥å‡ºçš„æ•°æ®æµªè´¹äº†ä¸€å®šçš„å†…å­˜å’Œcpuèµ„æº</li><li>select * ä¸ä¼šèµ°è¦†ç›–ç´¢å¼•ï¼Œä¼šå‡ºç°å¤§é‡çš„å›è¡¨æ“ä½œ<br>è¦†ç›–ç´¢å¼•ï¼šæ‰€æŸ¥çš„åˆ—æ•°æ®ï¼Œæ­£å¥½ä¸ºç´¢å¼•çš„è¯ï¼Œå°±ä¸éœ€è¦å›è¡¨æ“ä½œ</li></ul><h2 id="Union-å’Œ-Union-all-ï¼Œå¦‚æœéœ€è¦ç”¨åˆ°ï¼Œå°½é‡é€‰æ‹©Union-all"><a href="#Union-å’Œ-Union-all-ï¼Œå¦‚æœéœ€è¦ç”¨åˆ°ï¼Œå°½é‡é€‰æ‹©Union-all" class="headerlink" title="Union å’Œ Union all ï¼Œå¦‚æœéœ€è¦ç”¨åˆ°ï¼Œå°½é‡é€‰æ‹©Union all"></a>Union å’Œ Union all ï¼Œå¦‚æœéœ€è¦ç”¨åˆ°ï¼Œå°½é‡é€‰æ‹©Union all</h2><p><strong>åŸå› ï¼š</strong>ä½¿ç”¨union allå…³é”®å­—ï¼Œå¯ä»¥è·å–æ‰€æœ‰æ•°æ®ï¼ŒåŒ…å«é‡å¤çš„æ•°æ®ã€‚<br>  ä½¿ç”¨unionå…³é”®å­—åï¼Œå¯ä»¥è·å–æ’é‡åçš„æ•°æ®ï¼Œæ’é‡çš„è¿‡ç¨‹éœ€è¦éå†ã€æ’åºå’Œæ¯”è¾ƒï¼Œå®ƒæ›´è€—æ—¶ï¼Œæ›´æ¶ˆè€—cpuèµ„æº<br>æ‰€ä»¥å¦‚æœæ²¡è¯´éœ€è¦æ’é‡çš„åœºæ™¯ï¼Œå¯ä»¥å°±ç”¨union all</p><h2 id="éœ€è¦æ’å…¥å¤šä¸ªæ•°æ®åˆ°è¡¨ä¸­æ—¶ï¼Œä½¿ç”¨æ‰¹é‡æ’å…¥ï¼Œä¸è¦å¾ªç¯ä¸€ä¸ªä¸€ä¸ªæ’å…¥"><a href="#éœ€è¦æ’å…¥å¤šä¸ªæ•°æ®åˆ°è¡¨ä¸­æ—¶ï¼Œä½¿ç”¨æ‰¹é‡æ’å…¥ï¼Œä¸è¦å¾ªç¯ä¸€ä¸ªä¸€ä¸ªæ’å…¥" class="headerlink" title="éœ€è¦æ’å…¥å¤šä¸ªæ•°æ®åˆ°è¡¨ä¸­æ—¶ï¼Œä½¿ç”¨æ‰¹é‡æ’å…¥ï¼Œä¸è¦å¾ªç¯ä¸€ä¸ªä¸€ä¸ªæ’å…¥"></a>éœ€è¦æ’å…¥å¤šä¸ªæ•°æ®åˆ°è¡¨ä¸­æ—¶ï¼Œä½¿ç”¨æ‰¹é‡æ’å…¥ï¼Œä¸è¦å¾ªç¯ä¸€ä¸ªä¸€ä¸ªæ’å…¥</h2><p><strong>åŸå› ï¼š</strong>é¢‘ç¹è¯·æ±‚æ•°æ®åº“ï¼Œæ˜¯ä¼šæ¶ˆè€—ä¸€å®šæ€§èƒ½çš„ï¼Œå°½é‡å‡å°‘è¯·æ±‚æ•°æ®åº“çš„æ¬¡æ•°ã€‚å½“ç„¶ï¼Œä¸€æ¬¡æ€§æ’å…¥å¤ªå¤šæ•°æ®ï¼Œæ•°æ®åº“æ‰§è¡Œä¹Ÿä¼šå¾ˆæ…¢ï¼Œè¶…è¿‡500æ¡å¯ä»¥åˆ†æ‰¹æ’å…¥æ•°æ®<br><strong>ä¾‹å­ï¼š</strong><br>orderMapper.insertBatch(list):<br><strong>sqlè¯­å¥ï¼š</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">order</span>(id,code,user_id) </span><br><span class="line"><span class="keyword">values</span>(<span class="number">123</span>,<span class="string">&#x27;001&#x27;</span>,<span class="number">100</span>),(<span class="number">124</span>,<span class="string">&#x27;002&#x27;</span>,<span class="number">100</span>),(<span class="number">125</span>,<span class="string">&#x27;003&#x27;</span>,<span class="number">101</span>);</span><br></pre></td></tr></table></figure><h2 id="éœ€è¦åˆ¤æ–­æŸä¸ªæ•°æ®æ˜¯å¦å­˜åœ¨æ—¶ï¼Œåˆ«å†ç”¨count-äº†ï¼Œç”¨limitä»£æ›¿ï¼ï¼ï¼"><a href="#éœ€è¦åˆ¤æ–­æŸä¸ªæ•°æ®æ˜¯å¦å­˜åœ¨æ—¶ï¼Œåˆ«å†ç”¨count-äº†ï¼Œç”¨limitä»£æ›¿ï¼ï¼ï¼" class="headerlink" title="éœ€è¦åˆ¤æ–­æŸä¸ªæ•°æ®æ˜¯å¦å­˜åœ¨æ—¶ï¼Œåˆ«å†ç”¨count(*) äº†ï¼Œç”¨limitä»£æ›¿ï¼ï¼ï¼"></a>éœ€è¦åˆ¤æ–­æŸä¸ªæ•°æ®æ˜¯å¦å­˜åœ¨æ—¶ï¼Œåˆ«å†ç”¨count(*) äº†ï¼Œç”¨limitä»£æ›¿ï¼ï¼ï¼</h2><p><strong>åŸå› ï¼š</strong><br>ç”¨count(*) å…¶å®ç›¸å½“äºå…¨è¡¨æ‰«æäº†ï¼Œå› ä¸ºæ¯æ¡æ•°æ®éƒ½è¦éå†åˆ°ï¼Œè®¡ç®—æœ‰å¤šå°‘æ¡æ•°æ®æ—¶ç¬¦åˆæ¡ä»¶çš„<br>è€Œç”¨LIMIT 1ï¼Œæ•°æ®åº“æŸ¥è¯¢æ—¶é‡åˆ°ä¸€æ¡å°±ä¼šè¿”å›ï¼Œè€Œä¸ä¼šå†ç»§ç»­æŸ¥æ‰¾è¿˜æœ‰å¤šå°‘æ¡æ•°æ®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">ä¸€èˆ¬åšæ³•ï¼š</span><br><span class="line">####sqlå†™æ³•ï¼š</span><br><span class="line">   select <span class="title function_">count</span><span class="params">(*)</span> from user where status=<span class="number">1</span> <span class="type">and</span> <span class="variable">sex</span> <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">####javaä»£ç ï¼š</span><br><span class="line">   <span class="type">int</span> <span class="variable">nums</span> <span class="operator">=</span> xxDao.countXxxxByXxx(params);</span><br><span class="line">   <span class="keyword">if</span> ( nums &gt; <span class="number">0</span> ) &#123;</span><br><span class="line">          <span class="comment">//å½“å­˜åœ¨æ—¶ï¼Œæ‰§è¡Œè¿™é‡Œçš„ä»£ç </span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">//å½“ä¸å­˜åœ¨æ—¶ï¼Œæ‰§è¡Œè¿™é‡Œçš„ä»£ç </span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">ä¼˜åŒ–åï¼š</span><br><span class="line">####sqlå†™æ³•ï¼š</span><br><span class="line">   select <span class="number">1</span> from user where status=<span class="number">1</span> <span class="type">and</span> <span class="variable">sex</span> <span class="operator">=</span> <span class="number">1</span> limit <span class="number">1</span></span><br><span class="line">####javaä»£ç ï¼š</span><br><span class="line">    <span class="type">Integer</span> <span class="variable">exist</span> <span class="operator">=</span> xxDao.existXxxxByXxx(params);</span><br><span class="line">    <span class="keyword">if</span> ( exist != NULL ) &#123;</span><br><span class="line">        <span class="comment">//å½“å­˜åœ¨æ—¶ï¼Œæ‰§è¡Œè¿™é‡Œçš„ä»£ç </span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//å½“ä¸å­˜åœ¨æ—¶ï¼Œæ‰§è¡Œè¿™é‡Œçš„ä»£ç </span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨group-byçš„æ—¶å€™ï¼Œå…ˆwhereè¿‡æ»¤ï¼Œå†åˆ†ç»„ï¼Œé¿å…æ•°æ®é‡è¿‡å¤§ï¼Œåˆ†ç»„å¾ˆæ…¢"><a href="#ä½¿ç”¨group-byçš„æ—¶å€™ï¼Œå…ˆwhereè¿‡æ»¤ï¼Œå†åˆ†ç»„ï¼Œé¿å…æ•°æ®é‡è¿‡å¤§ï¼Œåˆ†ç»„å¾ˆæ…¢" class="headerlink" title="ä½¿ç”¨group byçš„æ—¶å€™ï¼Œå…ˆwhereè¿‡æ»¤ï¼Œå†åˆ†ç»„ï¼Œé¿å…æ•°æ®é‡è¿‡å¤§ï¼Œåˆ†ç»„å¾ˆæ…¢"></a>ä½¿ç”¨group byçš„æ—¶å€™ï¼Œå…ˆwhereè¿‡æ»¤ï¼Œå†åˆ†ç»„ï¼Œé¿å…æ•°æ®é‡è¿‡å¤§ï¼Œåˆ†ç»„å¾ˆæ…¢</h2><h2 id="å°½é‡ä¸è¦ä½¿ç´¢å¼•å¤±æ•ˆï¼š"><a href="#å°½é‡ä¸è¦ä½¿ç´¢å¼•å¤±æ•ˆï¼š" class="headerlink" title="å°½é‡ä¸è¦ä½¿ç´¢å¼•å¤±æ•ˆï¼š"></a>å°½é‡ä¸è¦ä½¿ç´¢å¼•å¤±æ•ˆï¼š</h2><p><strong>â… ã€æŸ¥è¯¢è¯­å¥ä¸­ä½¿ç”¨ORå…³é”®å­—ï¼Œä¸” orå‰åä¸¤ä¸ªæ¡ä»¶ æœ‰ä¸€ä¸ªä¸ä½¿ç”¨ç´¢å¼•ï¼Œé‚£ä¹ˆæŸ¥è¯¢å°†ä¸èµ°ç´¢å¼•ã€‚</strong><br>æŸ¥è¯¢è¯­å¥åªæœ‰ORå…³é”®å­—æ—¶ï¼Œå¦‚æœORå‰åçš„ä¸¤ä¸ªæ¡ä»¶çš„åˆ—éƒ½æ˜¯ç´¢å¼•ï¼Œé‚£ä¹ˆæŸ¥è¯¢ä¸­å°†ä½¿ç”¨ç´¢å¼•ã€‚å¦‚æœORå‰åæœ‰ä¸€ä¸ªæ¡ä»¶çš„åˆ—ä¸æ˜¯ç´¢å¼•ï¼Œé‚£ä¹ˆæŸ¥è¯¢ä¸­å°†ä¸ä½¿ç”¨ç´¢å¼•ã€‚å¯ä»¥é€‰æ‹©ç”¨union æˆ–inæ¥ä»£æ›¿orã€‚</p><p><strong>â…¡ã€ä½¿ç”¨äº† LIKE å…³é”®å­—ï¼Œä½†åŒ¹é…çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸º % ï¼Œé‚£ä¹ˆæŸ¥è¯¢å°†ä¸èµ°ç´¢å¼•ã€‚</strong><br>åœ¨æŸ¥è¯¢è¯­å¥ä¸­ä½¿ç”¨ LIKE å…³é”®å­—è¿›è¡ŒæŸ¥è¯¢æ—¶ï¼Œå¦‚æœåŒ¹é…å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºâ€œ%â€ï¼Œç´¢å¼•ä¸ä¼šè¢«ä½¿ç”¨ã€‚å¦‚æœâ€œ%â€ä¸æ˜¯åœ¨ç¬¬ä¸€ä¸ªä½ç½®ï¼Œç´¢å¼•å°±ä¼šè¢«ä½¿ç”¨ã€‚ã€æœ€å·¦å‰ç¼€åŒ¹é…åŸåˆ™ã€‘</p><p><strong>â…¢ã€ä½¿ç”¨å¤åˆç´¢å¼•ï¼Œä½†æŸ¥è¯¢è¯­å¥ä¸­æ²¡æœ‰ä½¿ç”¨å¤åˆç´¢å¼•çš„ç¬¬ä¸€ä¸ªå­—æ®µï¼Œé‚£ä¹ˆæŸ¥è¯¢å°†ä¸èµ°ç´¢å¼•ã€‚</strong><br>å¤åˆç´¢å¼•æ˜¯åœ¨è¡¨çš„å¤šä¸ªå­—æ®µä¸Šåˆ›å»ºä¸€ä¸ªç´¢å¼•ï¼Œåªæœ‰æŸ¥è¯¢æ¡ä»¶ä¸­ä½¿ç”¨äº†è¿™äº›å­—æ®µä¸­çš„ç¬¬ä¸€ä¸ªå­—æ®µï¼Œç´¢å¼•æ‰ä¼šè¢«ä½¿ç”¨ã€‚ã€æœ€å·¦å‰ç¼€åŒ¹é…åŸåˆ™ã€‘</p><p><strong>â…£ã€å½“ä½¿ç”¨ç´¢å¼•å’Œä¸ä½¿ç”¨ç´¢å¼•çš„æ•ˆç‡å·®ä¸å¤šæ—¶ï¼Œå¯èƒ½ä¸ä¼šèµ°ç´¢å¼•</strong></p><p><strong>â…¤ã€å¯¹ç´¢å¼•åˆ—ä½¿ç”¨åˆ—è¿ç®—æˆ–å‡½æ•°æ—¶ï¼Œä¹Ÿä¸ä¼šèµ°ç´¢å¼•</strong><br>ä¾‹å¦‚ï¼šå‡è®¾rateæ˜¯ç´¢å¼•ï¼Œé‚£ä¹ˆä»¥ä¸‹è¿™ä¸¤ç§æƒ…å†µæ˜¯ä¸ä¼šèµ°ç´¢å¼•çš„</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> rate <span class="operator">+</span> <span class="number">1</span> <span class="operator">=</span> <span class="number">2</span> ;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> SUBSTR(rate,<span class="number">1</span>,<span class="number">3</span>) <span class="operator">=</span> <span class="string">&#x27;100&#x27;</span>;</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨â€œCASE-WHEN-è¡¨è¾¾å¼-then-â€æ—¶ï¼Œä¸è¦åœ¨è¡¨è¾¾å¼ä¸­å†™selectè¯­å¥"><a href="#ä½¿ç”¨â€œCASE-WHEN-è¡¨è¾¾å¼-then-â€æ—¶ï¼Œä¸è¦åœ¨è¡¨è¾¾å¼ä¸­å†™selectè¯­å¥" class="headerlink" title="ä½¿ç”¨â€œCASE WHEN è¡¨è¾¾å¼ then â€æ—¶ï¼Œä¸è¦åœ¨è¡¨è¾¾å¼ä¸­å†™selectè¯­å¥"></a>ä½¿ç”¨â€œCASE WHEN è¡¨è¾¾å¼ then â€æ—¶ï¼Œä¸è¦åœ¨è¡¨è¾¾å¼ä¸­å†™selectè¯­å¥</h2><p>å½“selectæŸ¥è¯¢é‡Œå­˜åœ¨â€œCASE WHEN è¡¨è¾¾å¼ then â€ æ—¶ï¼Œè®¿é—®è·¯å¾„ç±»ä¼¼forå¾ªç¯ï¼Œæ‰€ä»¥ä¸è¦åœ¨è¡¨è¾¾å¼ä¸­å†™selectè¯­å¥ï¼Œä¸ç„¶æ¯è¿›è¡Œä¸€æ¬¡åˆ¤æ–­ï¼Œéƒ½å»æŸ¥è¡¨ï¼Œæ•ˆç‡å¾ˆä½</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ç¤ºä¾‹ï¼š</span></span><br><span class="line">    <span class="keyword">select</span>  a.id,</span><br><span class="line">            <span class="keyword">case</span> <span class="keyword">when</span> a.formid <span class="keyword">in</span> (<span class="keyword">select</span> id <span class="keyword">from</span> b <span class="keyword">where</span> b.salary <span class="operator">&gt;</span><span class="number">0</span>) <span class="keyword">then</span> <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span> <span class="number">2</span></span><br><span class="line">            <span class="keyword">end</span> test</span><br><span class="line">    <span class="keyword">from</span> test a</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ä¼˜åŒ–ï¼š</span></span><br><span class="line">     <span class="keyword">select</span>  a.id,</span><br><span class="line">            <span class="keyword">case</span> <span class="keyword">when</span> a.formid <span class="operator">=</span> c.id <span class="keyword">then</span> <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span> <span class="number">2</span></span><br><span class="line">            <span class="keyword">end</span> test</span><br><span class="line">    <span class="keyword">from</span> test a</span><br><span class="line">    <span class="keyword">left</span> <span class="keyword">join</span> (<span class="keyword">select</span> id <span class="keyword">from</span> b <span class="keyword">where</span> b.salary <span class="operator">&gt;</span><span class="number">0</span>) c <span class="keyword">on</span> c.id <span class="operator">=</span> a.formid</span><br></pre></td></tr></table></figure><blockquote><p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ç¯‡ä¸é”™çš„ï¼š<br><a href="https://lxg-gofor.github.io/2022/04/13/mysql/mysql8-sql%E4%BC%98%E5%8C%96/">https://lxg-gofor.github.io/2022/04/13/mysql/mysql8-sql%E4%BC%98%E5%8C%96/</a></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> SQLä¼˜åŒ– </tag>
            
            <tag> è§£å†³æ–¹æ¡ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¥èº«</title>
      <link href="/2023/07/17/%E5%81%A5%E8%BA%AB/"/>
      <url>/2023/07/17/%E5%81%A5%E8%BA%AB/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬”è®°è‡ªç”¨ï¼Œä¾µåˆ "><a href="#ç¬”è®°è‡ªç”¨ï¼Œä¾µåˆ " class="headerlink" title="ç¬”è®°è‡ªç”¨ï¼Œä¾µåˆ "></a>ç¬”è®°è‡ªç”¨ï¼Œä¾µåˆ </h1><h1 id="å‡ºè‡ªBç«™upä¸»ï¼šå¥½äººæ¾æ¾"><a href="#å‡ºè‡ªBç«™upä¸»ï¼šå¥½äººæ¾æ¾" class="headerlink" title="å‡ºè‡ªBç«™upä¸»ï¼šå¥½äººæ¾æ¾"></a>å‡ºè‡ªBç«™upä¸»ï¼šå¥½äººæ¾æ¾</h1><p>æ­¤å¤„é™„ä¸Šè§†é¢‘é“¾æ¥ï¼š<a href="https://www.bilibili.com/video/BV1Hk4y187jF">https://www.bilibili.com/video/BV1Hk4y187jF</a></p><h2 id="é…é‡çš„é¡ºåº"><a href="#é…é‡çš„é¡ºåº" class="headerlink" title="é…é‡çš„é¡ºåº:"></a>é…é‡çš„é¡ºåº:</h2><img src="/2023/07/17/%E5%81%A5%E8%BA%AB/0.jpg" class="" title="é…é‡çš„é¡ºåº"><h2 id="è®­ç»ƒæ—¶é•¿"><a href="#è®­ç»ƒæ—¶é•¿" class="headerlink" title="è®­ç»ƒæ—¶é•¿:"></a>è®­ç»ƒæ—¶é•¿:</h2><img src="/2023/07/17/%E5%81%A5%E8%BA%AB/1.jpg" class="" title="è®­ç»ƒæ—¶é•¿"><h2 id="ä¸åŒç›®çš„-ä¸åŒé…é‡"><a href="#ä¸åŒç›®çš„-ä¸åŒé…é‡" class="headerlink" title="ä¸åŒç›®çš„ ä¸åŒé…é‡:"></a>ä¸åŒç›®çš„ ä¸åŒé…é‡:</h2><img src="/2023/07/17/%E5%81%A5%E8%BA%AB/2.jpg" class="" title="ä¸åŒç›®çš„ ä¸åŒé…é‡"><h2 id="ä¸‰åˆ†åŒ–è®­ç»ƒè®¡åˆ’"><a href="#ä¸‰åˆ†åŒ–è®­ç»ƒè®¡åˆ’" class="headerlink" title="ä¸‰åˆ†åŒ–è®­ç»ƒè®¡åˆ’:"></a>ä¸‰åˆ†åŒ–è®­ç»ƒè®¡åˆ’:</h2><img src="/2023/07/17/%E5%81%A5%E8%BA%AB/3.jpg" class="" title="ä¸‰åˆ†åŒ–è®­ç»ƒè®¡åˆ’"><h2 id="å››åˆ†åŒ–è®­ç»ƒè®¡åˆ’"><a href="#å››åˆ†åŒ–è®­ç»ƒè®¡åˆ’" class="headerlink" title="å››åˆ†åŒ–è®­ç»ƒè®¡åˆ’:"></a>å››åˆ†åŒ–è®­ç»ƒè®¡åˆ’:</h2><img src="/2023/07/17/%E5%81%A5%E8%BA%AB/4.jpg" class="" title="å››åˆ†åŒ–è®­ç»ƒè®¡åˆ’"><h2 id="å…·ä½“åŠ¨ä½œä»å±äºåŠ¨ä½œæ¨¡å¼"><a href="#å…·ä½“åŠ¨ä½œä»å±äºåŠ¨ä½œæ¨¡å¼" class="headerlink" title="å…·ä½“åŠ¨ä½œä»å±äºåŠ¨ä½œæ¨¡å¼:"></a>å…·ä½“åŠ¨ä½œä»å±äºåŠ¨ä½œæ¨¡å¼:</h2><img src="/2023/07/17/%E5%81%A5%E8%BA%AB/5.jpg" class="" title="å…·ä½“åŠ¨ä½œä»å±äºåŠ¨ä½œæ¨¡å¼"><h2 id="èƒ¸è‚Œ"><a href="#èƒ¸è‚Œ" class="headerlink" title="èƒ¸è‚Œ:"></a>èƒ¸è‚Œ:</h2><img src="/2023/07/17/%E5%81%A5%E8%BA%AB/x1.jpg" class="" title="èƒ¸è‚Œ1"><img src="/2023/07/17/%E5%81%A5%E8%BA%AB/x2.jpg" class="" title="èƒ¸è‚Œ2"><h2 id="èƒŒéƒ¨è‚Œç¾¤"><a href="#èƒŒéƒ¨è‚Œç¾¤" class="headerlink" title="èƒŒéƒ¨è‚Œç¾¤:"></a>èƒŒéƒ¨è‚Œç¾¤:</h2><img src="/2023/07/17/%E5%81%A5%E8%BA%AB/b2.jpg" class="" title="èƒŒçš„åŠ¨ä½œæ¨¡å¼"><img src="/2023/07/17/%E5%81%A5%E8%BA%AB/bs.jpg" class="" title="ä¸ŠèƒŒ"><img src="/2023/07/17/%E5%81%A5%E8%BA%AB/bx.jpg" class="" title="ä¸‹èƒŒ"><h2 id="è…¹è‚Œ"><a href="#è…¹è‚Œ" class="headerlink" title="è…¹è‚Œ:"></a>è…¹è‚Œ:</h2><img src="/2023/07/17/%E5%81%A5%E8%BA%AB/f.jpg" class="" title="è…¹è‚Œ"><h2 id="è‚±äºŒå¤´è‚Œ"><a href="#è‚±äºŒå¤´è‚Œ" class="headerlink" title="è‚±äºŒå¤´è‚Œ:"></a>è‚±äºŒå¤´è‚Œ:</h2><img src="/2023/07/17/%E5%81%A5%E8%BA%AB/gonger1.jpg" class="" title="è‚±äºŒå¤´è‚Œ1"><h2 id="è‚±ä¸‰å¤´è‚Œ"><a href="#è‚±ä¸‰å¤´è‚Œ" class="headerlink" title="è‚±ä¸‰å¤´è‚Œ:"></a>è‚±ä¸‰å¤´è‚Œ:</h2><img src="/2023/07/17/%E5%81%A5%E8%BA%AB/gongsan1.jpg" class="" title="è‚±ä¸‰å¤´è‚Œ1"><h2 id="ä¸‰è§’è‚Œå‰æŸ"><a href="#ä¸‰è§’è‚Œå‰æŸ" class="headerlink" title="ä¸‰è§’è‚Œå‰æŸ:"></a>ä¸‰è§’è‚Œå‰æŸ:</h2><img src="/2023/07/17/%E5%81%A5%E8%BA%AB/jq1.jpg" class="" title="ä¸‰è§’è‚Œå‰æŸ1"><img src="/2023/07/17/%E5%81%A5%E8%BA%AB/jq2.jpg" class="" title="ä¸‰è§’è‚Œå‰æŸ2"><h2 id="ä¸‰è§’è‚Œä¸­æŸ"><a href="#ä¸‰è§’è‚Œä¸­æŸ" class="headerlink" title="ä¸‰è§’è‚Œä¸­æŸ:"></a>ä¸‰è§’è‚Œä¸­æŸ:</h2><img src="/2023/07/17/%E5%81%A5%E8%BA%AB/jz2.jpg" class="" title="ä¸‰è§’è‚Œä¸­æŸ1"><img src="/2023/07/17/%E5%81%A5%E8%BA%AB/jz3.jpg" class="" title="ä¸‰è§’è‚Œä¸­æŸ2"><h2 id="ä¸‰è§’è‚ŒåæŸ"><a href="#ä¸‰è§’è‚ŒåæŸ" class="headerlink" title="ä¸‰è§’è‚ŒåæŸ:"></a>ä¸‰è§’è‚ŒåæŸ:</h2><img src="/2023/07/17/%E5%81%A5%E8%BA%AB/jh1.jpg" class="" title="ä¸‰è§’è‚ŒåæŸ1"><h2 id="è‚¡å››å¤´è‚Œ"><a href="#è‚¡å››å¤´è‚Œ" class="headerlink" title="è‚¡å››å¤´è‚Œ:"></a>è‚¡å››å¤´è‚Œ:</h2><img src="/2023/07/17/%E5%81%A5%E8%BA%AB/gusi1.jpg" class="" title="è‚¡å››å¤´è‚Œ1"><h2 id="è‚¡äºŒå¤´è‚Œ"><a href="#è‚¡äºŒå¤´è‚Œ" class="headerlink" title="è‚¡äºŒå¤´è‚Œ:"></a>è‚¡äºŒå¤´è‚Œ:</h2><img src="/2023/07/17/%E5%81%A5%E8%BA%AB/guer1.jpg" class="" title="è‚¡äºŒå¤´è‚Œ1"><img src="/2023/07/17/%E5%81%A5%E8%BA%AB/guer2.jpg" class="" title="è‚¡äºŒå¤´è‚Œ2"><h2 id="è‡€å¤§è‚Œ"><a href="#è‡€å¤§è‚Œ" class="headerlink" title="è‡€å¤§è‚Œ:"></a>è‡€å¤§è‚Œ:</h2><img src="/2023/07/17/%E5%81%A5%E8%BA%AB/t1.jpg" class="" title="è‡€å¤§è‚Œ1"><img src="/2023/07/17/%E5%81%A5%E8%BA%AB/t2.jpg" class="" title="è‡€å¤§è‚Œ2"><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“:"></a>æ€»ç»“:</h2><img src="/2023/07/17/%E5%81%A5%E8%BA%AB/%E6%80%BB%E7%BB%93.jpg" class="" title="æ€»ç»“">]]></content>
      
      
      
        <tags>
            
            <tag> è¿åŠ¨ </tag>
            
            <tag> å¥åº· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DDDé¢†åŸŸé©±åŠ¨è®¾è®¡</title>
      <link href="/2023/07/14/DDD%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/"/>
      <url>/2023/07/14/DDD%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/</url>
      
        <content type="html"><![CDATA[<h1 id="DDDé¢†åŸŸé©±åŠ¨è®¾è®¡"><a href="#DDDé¢†åŸŸé©±åŠ¨è®¾è®¡" class="headerlink" title="DDDé¢†åŸŸé©±åŠ¨è®¾è®¡"></a>DDDé¢†åŸŸé©±åŠ¨è®¾è®¡</h1><h2 id="ä»€ä¹ˆæ˜¯é¢†åŸŸé©±åŠ¨è®¾è®¡"><a href="#ä»€ä¹ˆæ˜¯é¢†åŸŸé©±åŠ¨è®¾è®¡" class="headerlink" title="ä»€ä¹ˆæ˜¯é¢†åŸŸé©±åŠ¨è®¾è®¡"></a>ä»€ä¹ˆæ˜¯é¢†åŸŸé©±åŠ¨è®¾è®¡</h2><p>åˆè¢«ç§°ä½œåŸºäºé¢†åŸŸçš„å·¥ç¨‹è®¾è®¡ã€‚</p><p><strong>é‚£ä¹ˆä»€ä¹ˆæ˜¯é¢†åŸŸï¼Ÿ</strong></p><p>æˆ‘ä»¬æš‚ä¸”å¯ä»¥å°†å…¶ç†è§£ä¸º<strong>ä¸šåŠ¡é—®é¢˜çš„èŒƒç•´</strong>ã€‚æ¯”å¦‚è¯´æ‰“æ‰®è‡ªå·±è¿™é¡¹ä¸šåŠ¡å°±å¯ä»¥åˆ†ä¸ºè´­ä¹°è¡£æœã€åŒ–å¦†å’Œå¥èº«ä¸‰ä¸ªé¢†åŸŸï¼Œè€Œè´­ä¹°è¡£æœè¿™ä¸€é¢†åŸŸå°±åŒ…æ‹¬äº†æŒ‘è¡£æœï¼Œè¯•è¡£æœå’Œä»˜æ¬¾ã€‚</p><p>æ€»çš„æ¥è¯´é¢†åŸŸé©±åŠ¨è®¾è®¡å…¶å®å°±æ˜¯å°†ä¸šåŠ¡ä¸Šè¦åšçš„ä¸€ä»¶<strong>å¤§äº‹</strong>,é€šè¿‡æ¨æ¼”å’ŒæŠ½è±¡<strong>æ‹†åˆ†æˆå¤šä¸ªå†…èšçš„é¢†åŸŸã€‚</strong></p><h2 id="DDDåè¯æ¦‚å¿µ"><a href="#DDDåè¯æ¦‚å¿µ" class="headerlink" title="DDDåè¯æ¦‚å¿µ"></a>DDDåè¯æ¦‚å¿µ</h2><h3 id="ä»€ä¹ˆæ˜¯DP"><a href="#ä»€ä¹ˆæ˜¯DP" class="headerlink" title="ä»€ä¹ˆæ˜¯DP"></a>ä»€ä¹ˆæ˜¯DP</h3><p>Domain Primitiveï¼Œåœ¨DDDä¸­DPå¯ä»¥è¯´æ˜¯ä¸€åˆ‡æ¨¡å‹ã€æ–¹æ³•ã€æ¶æ„çš„åŸºç¡€ï¼Œä»–æ˜¯åœ¨ç‰¹å®šé¢†åŸŸã€æ‹¥æœ‰ç²¾ç¡®å®šä¹‰ã€å¯ä»¥è‡ªæˆ‘éªŒè¯ã€æ‹¥æœ‰è¡Œä¸ºçš„å¯¹è±¡ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯é¢†åŸŸçš„æœ€å°ç»„æˆéƒ¨åˆ†ã€‚</p><p>DPçš„ä¸‰æ¡åŸåˆ™ï¼š</p><ul><li>è®©éšæ€§çš„æ¦‚å¿µæ˜¾æ€§åŒ–ï¼šæ¯”å¦‚æ‰‹æœºå·ç æ˜¯å…·æœ‰åŒºå·çš„ï¼Œå¦‚æœç”¨Stringæ¥è®°å½•æ‰‹æœºå·ç çš„è¯å°±è®°å½•ä¸äº†åŒºå·ï¼Œå¦‚æœè‡ªè¡Œåˆ›å»ºä¸€ä¸ªDPå¯¹è±¡ï¼Œé‡Œé¢åŒ…æ‹¬äº†æ‰‹æœºå·ç å’ŒåŒºå·ç­‰å±æ€§ï¼Œå°±èƒ½åšåˆ°å°†éšæ€§æ¦‚å¿µæ˜¾æ€§åŒ–çš„ã€‚</li><li>è®©éšæ€§çš„ä¸Šä¸‹æ–‡æ˜¾æ€§åŒ–ï¼šéšæ€§çš„æ¦‚å¿µéƒ½æ˜¾æ€§åŒ–ä¹‹åï¼Œéšæ€§çš„ä¸Šä¸‹æ–‡è‡ªç„¶ä¹Ÿæ˜¾æ€§åŒ–äº†ã€‚</li><li>å°è£…å¤šå¯¹è±¡è¡Œä¸ºï¼šä¸€ä¸ªDPå¯ä»¥å°è£…å¤šä¸ªDPã€‚</li></ul><h3 id="ä»€ä¹ˆæ˜¯Entity"><a href="#ä»€ä¹ˆæ˜¯Entity" class="headerlink" title="ä»€ä¹ˆæ˜¯Entity"></a>ä»€ä¹ˆæ˜¯Entity</h3><p>å’ŒDPç›¸æ¯”ï¼Œä»–ä¿©éƒ½æ˜¯<strong>å……è¡€</strong>çš„ï¼Œä½†æ˜¯Entityæ˜¯æœ‰çŠ¶æ€çš„ï¼ŒDPæ˜¯ç»„æˆå®ä½“çš„åŸºç¡€ç±»å‹ï¼ŒEntityåˆ™æ˜¯æœ‰çŠ¶æ€çš„é¢†åŸŸå®ä½“ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼š ä¹°é—¨ç¥¨ï¼Œå¦‚æœé—¨ç¥¨æœ‰æŒ‡å®šä½ç½®ï¼Œé‚£ä¹ˆè¿™ä¸ªä½ç½®å°±æ˜¯æœ‰çŠ¶æ€çš„Entityï¼Œç¨‹åºéœ€è¦é€šè¿‡ä»–çš„å”¯ä¸€idè¿½è¸ªä»–çš„çŠ¶æ€ï¼Œé¢„å®šçŠ¶æ€å’Œè¡Œåˆ—æ•°ç­‰ç­‰ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šä½ç½®ï¼Œè¿›åˆ°é‡Œé¢éšä¾¿åï¼Œé‚£ä¹ˆå°±æ˜¯æ— çŠ¶æ€çš„DPï¼Œç¨‹åºåªéœ€è¦çŸ¥é“åº§ä½çš„æ€»æ•°ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯ACLé˜²è…å±‚"><a href="#ä»€ä¹ˆæ˜¯ACLé˜²è…å±‚" class="headerlink" title="ä»€ä¹ˆæ˜¯ACLé˜²è…å±‚"></a>ä»€ä¹ˆæ˜¯ACLé˜²è…å±‚</h3><p>å°†ä¸¤ä¸ªä¸åŒçš„é¢†åŸŸç•Œå®šå¼€ï¼Œä½¿å¾—ä¸¤è€…ç»“æ„ä¸å—å¯¹æ–¹çš„å½±å“ï¼Œå¯ä»¥é€šè¿‡æ¥å£çš„å½¢å¼ï¼Œå¯¹å¤–æä¾›<br>è®¿é—®æ¥å£ï¼Œè¿™æ ·å³ä½¿ä¸šåŠ¡é€»è¾‘äº§ç”Ÿå˜åŒ–ï¼Œä¹Ÿä¸ä¼šå½±å“åˆ«çš„ç³»ç»Ÿï¼Œå¦‚æœè¦è¿›è¡Œè½¬ä¹‰ï¼Œä¹Ÿå¯ä»¥åœ¨é˜²è…å±‚å†…å®Œæˆã€‚</p><h3 id="æœ‰çš„æ²¡çš„éƒ½æ¦‚è§ˆ"><a href="#æœ‰çš„æ²¡çš„éƒ½æ¦‚è§ˆ" class="headerlink" title="æœ‰çš„æ²¡çš„éƒ½æ¦‚è§ˆ"></a>æœ‰çš„æ²¡çš„éƒ½æ¦‚è§ˆ</h3><ul><li>DP: æŠ½è±¡å¹¶å°è£…è‡ªæ£€å’Œä¸€äº›éšæ€§å±æ€§çš„è®¡ç®—é€»è¾‘ï¼Œä¸”è¿™äº›å±æ€§æ˜¯æ— çŠ¶æ€çš„ã€‚</li><li>Entity: æŠ½è±¡å¹¶å°è£…å•å¯¹è±¡æœ‰çŠ¶æ€çš„é€»è¾‘ã€‚</li><li>Domain Service: æŠ½è±¡å¹¶å°è£…<strong>å¤šå¯¹è±¡</strong>çš„æœ‰çŠ¶æ€é€»è¾‘ã€‚</li><li>Repository: æŠ½è±¡å¹¶å°è£…å¤–éƒ¨æ•°æ®è®¿é—®é€»è¾‘ã€‚</li></ul><h2 id="DDDæ€æƒ³ä¸‹çš„ç¼–ç è¿‡ç¨‹"><a href="#DDDæ€æƒ³ä¸‹çš„ç¼–ç è¿‡ç¨‹" class="headerlink" title="DDDæ€æƒ³ä¸‹çš„ç¼–ç è¿‡ç¨‹"></a>DDDæ€æƒ³ä¸‹çš„ç¼–ç è¿‡ç¨‹</h2><ol><li>é¦–å…ˆå¯¹éœ€è¦å¤„ç†çš„ä¸šåŠ¡é—®é¢˜è¿›è¡Œæ€»è§ˆã€‚</li><li>ç„¶åé¢†åŸŸå¯¹è±¡(Entity) è¿›è¡Œåˆ’åˆ†ï¼Œæ˜ç¡®æ¯ä¸ªé¢†åŸŸå¯¹è±¡çš„åŒ…å«çš„ä¿¡æ¯å’ŒèŒè´£è¾¹ç•Œå¹¶è¿›è¡Œè·¨å¯¹è±¡ï¼Œå¤šå¯¹è±¡çš„é€»è¾‘ç»„ç»‡ (Domain Service)ã€‚</li><li>æ¥ç€åœ¨ä¸Šå±‚åº”ç”¨ä¸­æ ¹æ®ä¸šåŠ¡æè¿°å»ç¼–æ’Entityå’ŒDomain Serviceã€‚</li><li>æœ€åå†åšä¸€äº›ä¸‹æ°´é“ï¼ˆè„ï¼Œè€¦åˆé«˜ï¼‰å·¥ä½œï¼Œå»å¯¹ä¸‹å±‚çš„æ•°æ®è®¿é—®ï¼ŒRPCè°ƒç”¨å»åšä¸€äº›å…·ä½“å®ç°ã€‚</li></ol><h2 id="èšåˆ"><a href="#èšåˆ" class="headerlink" title="èšåˆ"></a>èšåˆ</h2><p>èšåˆæ˜¯å¯¹å­˜åœ¨å¼•ç”¨å…³ç³»çš„ä¸€ç»„å¯¹è±¡çš„å°è£…ï¼Œä»–çš„ç›®çš„å°±æ˜¯å±è”½æ‰å†…éƒ¨å¯¹è±¡ä¹‹é—´å¤æ‚çš„å…³è”å…³ç³»åªå¯¹å¤–æš´éœ²ç»Ÿä¸€æ¥å£ã€‚<br>ä¾‹å­ï¼šåœ¨å†™è®ºæ–‡æ—¶çš„å„ç§æ­¥éª¤èšåˆåœ¨ä¸€èµ·å°±æ˜¯ä¸€ä¸ªä¸å†™è®ºæ–‡ç›¸å…³çš„èšåˆã€‚</p><img src="/2023/07/14/DDD%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/1.png" class="" title="èšåˆæ¦‚å¿µ"><h3 id="èšåˆæ ¹"><a href="#èšåˆæ ¹" class="headerlink" title="èšåˆæ ¹"></a>èšåˆæ ¹</h3><p>èšåˆæ ¹æ˜¯æ•´ä¸ªèšåˆå½“ä¸­å”¯ä¸€èƒ½å¤Ÿè¢«å¤–éƒ¨å¼•ç”¨çš„å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´èšåˆæ‰€æš´éœ²çš„æ¥å£åªå…è®¸æ“ä½œæ ¹å¯¹è±¡ã€‚</p><h3 id="è¾¹ç•Œ"><a href="#è¾¹ç•Œ" class="headerlink" title="è¾¹ç•Œ"></a>è¾¹ç•Œ</h3><p>åˆ¤æ–­å“ªäº›å¯¹è±¡å¯ä»¥è¢«åˆ’å…¥èšåˆçš„æ¡ä»¶</p><h3 id="æ³¨é”€å¾®ä¿¡è´¦å·çš„ä¾‹å­ï¼š"><a href="#æ³¨é”€å¾®ä¿¡è´¦å·çš„ä¾‹å­ï¼š" class="headerlink" title="æ³¨é”€å¾®ä¿¡è´¦å·çš„ä¾‹å­ï¼š"></a>æ³¨é”€å¾®ä¿¡è´¦å·çš„ä¾‹å­ï¼š</h3><p>æ³¨é”€çš„æ—¶å€™éœ€è¦æ£€æŸ¥é’±åŒ…é‡Œçš„ä½™é¢ï¼ŒåŒæ—¶è¿˜è¦æ£€æŸ¥ç»‘å®šçš„é“¶è¡Œå¡ï¼Œä½†æ˜¯èŠå¤©æ¶ˆæ¯å¾®ä¿¡æ²¡æœ‰ä¿å­˜ï¼Œæ‰€ä»¥å°±ä¸ç”¨ç®¡äº†</p><img src="/2023/07/14/DDD%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/3.png" class="" title="æ³¨é”€å¾®ä¿¡è´¦å·çš„ä¾‹å­"><img src="/2023/07/14/DDD%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/2.png" class="" title="èšåˆæ¥å£å†™æ³•"><p>è¿™é‡Œæ‰‹æœºå·å°±æ˜¯å¾®ä¿¡è´¦å·çš„èšåˆæ ¹</p>]]></content>
      
      
      
        <tags>
            
            <tag> DDD </tag>
            
            <tag> é¢†åŸŸé©±åŠ¨è®¾è®¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Dockerå­¦ä¹ ç¬”è®°</title>
      <link href="/2023/06/09/Docker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
      <url>/2023/06/09/Docker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="åˆè¯†Docker"><a href="#åˆè¯†Docker" class="headerlink" title="åˆè¯†Docker"></a>åˆè¯†Docker</h1><p>åœ¨æˆ‘ä»¬å¹³å¸¸éƒ¨ç½²é¡¹ç›®çš„æ—¶å€™å¸¸å¸¸ä¼šé¢ä¸´ç»„ä»¶å¤šï¼Œè¿è¡Œç¯å¢ƒå¤æ‚çš„é—®é¢˜ï¼Œè€Œè¿™ä¼šå¯¼è‡´ï¼š</p><ul><li>ä¾èµ–å…³ç³»å¤æ‚ï¼Œå‡ºç°å…¼å®¹æ€§é—®é¢˜</li><li>å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒä¸ä¸€æ ·çš„é—®é¢˜</li></ul><p>è£…è¿‡ç¯å¢ƒçš„å°ä¼™ä¼´åº”è¯¥éƒ½çŸ¥é“è¿™æ˜¯ä¸€ä¸ªå¤šä¹ˆçƒ¦äººçš„è¿‡ç¨‹ï¼Œè£…ä¸Šäº†è¿˜å¥½è¯´ï¼Œè£…ä¸ä¸Šé‚£å°±çœŸçš„æ˜¯ç™½è´¹å¿ƒæœºï¼Œæµªè´¹æ—¶é—´ã€‚</p><p>è¿™æ—¶ï¼ŒDockerç»™å‡ºäº†ä¸€ä¸ªå¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆï¼š</p><p>1ã€è§£å†³å¤§å‹é¡¹ç›®ä¾èµ–å…³ç³»å¤æ‚ï¼Œä¸åŒç»„ä»¶ä¾èµ–çš„å…¼å®¹æ€§é—®é¢˜</p><ul><li>Dockerå…è®¸å¼€å‘ä¸­å°†åº”ç”¨ã€ä¾èµ–ã€å‡½æ•°åº“ã€é…ç½®ä¸€èµ·æ‰“åŒ…ï¼Œå½¢æˆå¯ç§»æ¤é•œåƒ</li><li>Dockeråº”ç”¨è¿è¡Œåœ¨å®¹å™¨ä¸­ï¼Œä½¿ç”¨æ²™ç®±æœºåˆ¶ï¼Œç›¸äº’éš”ç¦»</li></ul><p>2ã€è§£å†³å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒæœ‰å·®å¼‚çš„é—®é¢˜</p><ul><li>Dockeré•œåƒä¸­åŒ…å«å®Œæ•´è¿è¡Œç¯å¢ƒï¼ŒåŒ…æ‹¬ç³»ç»Ÿå‡½æ•°åº“ï¼Œä»…ä¾èµ–ç³»ç»Ÿçš„Linuxå†…æ ¸ï¼Œå› æ­¤å¯ä»¥åœ¨ä»»æ„Linuxæ“ä½œç³»ç»Ÿä¸Šè¿è¡Œ</li></ul><img src="/2023/06/09/Docker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/1.png" class="" title="Dockeræ¦‚å¿µ"><h2 id="Dockeræ¶æ„"><a href="#Dockeræ¶æ„" class="headerlink" title="Dockeræ¶æ„"></a>Dockeræ¶æ„</h2><img src="/2023/06/09/Docker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/2.png" class="" title="Dockeræ¶æ„"><h2 id="Dockerå®‰è£…"><a href="#Dockerå®‰è£…" class="headerlink" title="Dockerå®‰è£…"></a>Dockerå®‰è£…</h2><h3 id="å®‰è£…Docker"><a href="#å®‰è£…Docker" class="headerlink" title="å®‰è£…Docker"></a>å®‰è£…Docker</h3><p>Docker åˆ†ä¸º CE å’Œ EE ä¸¤å¤§ç‰ˆæœ¬ã€‚CE å³ç¤¾åŒºç‰ˆï¼ˆå…è´¹ï¼Œæ”¯æŒå‘¨æœŸ 7 ä¸ªæœˆï¼‰ï¼ŒEE å³ä¼ä¸šç‰ˆï¼Œå¼ºè°ƒå®‰å…¨ï¼Œä»˜è´¹ä½¿ç”¨ï¼Œæ”¯æŒå‘¨æœŸ 24 ä¸ªæœˆã€‚</p><p>Docker CE åˆ†ä¸º stable test å’Œ nightly ä¸‰ä¸ªæ›´æ–°é¢‘é“ã€‚</p><p>å®˜æ–¹ç½‘ç«™ä¸Šæœ‰å„ç§ç¯å¢ƒä¸‹çš„ å®‰è£…æŒ‡å—ï¼Œè¿™é‡Œä¸»è¦ä»‹ç» Docker CE åœ¨ CentOSä¸Šçš„å®‰è£…ã€‚</p><h3 id="CentOSå®‰è£…Docker"><a href="#CentOSå®‰è£…Docker" class="headerlink" title="CentOSå®‰è£…Docker"></a>CentOSå®‰è£…Docker</h3><p>Docker CE æ”¯æŒ 64 ä½ç‰ˆæœ¬ CentOS 7ï¼Œå¹¶ä¸”è¦æ±‚å†…æ ¸ç‰ˆæœ¬ä¸ä½äº 3.10ï¼Œ CentOS 7 æ»¡è¶³æœ€ä½å†…æ ¸çš„è¦æ±‚ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨CentOS 7å®‰è£…Dockerã€‚</p><h3 id="å¸è½½ï¼ˆå¯é€‰ï¼‰"><a href="#å¸è½½ï¼ˆå¯é€‰ï¼‰" class="headerlink" title="å¸è½½ï¼ˆå¯é€‰ï¼‰"></a>å¸è½½ï¼ˆå¯é€‰ï¼‰</h3><p>å¦‚æœä¹‹å‰å®‰è£…è¿‡æ—§ç‰ˆæœ¬çš„Dockerï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢å‘½ä»¤å¸è½½ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">yum remove docker \</span><br><span class="line">    docker-client \</span><br><span class="line">    docker-client-latest \</span><br><span class="line">    docker-common \</span><br><span class="line">    docker-latest \</span><br><span class="line">    docker-latest-logrotate \</span><br><span class="line">    docker-logrotate \</span><br><span class="line">    docker-selinux \</span><br><span class="line">    docker-engine-selinux \</span><br><span class="line">    docker-engine \</span><br><span class="line">    docker-ce</span><br></pre></td></tr></table></figure><h3 id="å®‰è£…docker"><a href="#å®‰è£…docker" class="headerlink" title="å®‰è£…docker"></a>å®‰è£…docker</h3><p>é¦–å…ˆéœ€è¦å¤§å®¶è™šæ‹Ÿæœºè”ç½‘ï¼Œå®‰è£…yumå·¥å…·</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum install -y yum-utils \</span><br><span class="line">   device-mapper-persistent-data \</span><br><span class="line">   lvm2 --skip-broken</span><br></pre></td></tr></table></figure><p>æ›´æ–°XFSæ–‡ä»¶ç³»ç»Ÿç®¡ç†å·¥å…·ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum update xfsprogs -y</span><br></pre></td></tr></table></figure><p>ç„¶åæ›´æ–°æœ¬åœ°é•œåƒæºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è®¾ç½®dockeré•œåƒæº</span></span><br><span class="line">yum-config-manager \</span><br><span class="line">    --add-repo \</span><br><span class="line">    https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è§£å†³åŸŸåé—®é¢˜</span></span><br><span class="line">sed -i &#x27;s/download.docker.com/mirrors.aliyun.com\/docker-ce/g&#x27;/etc/yum.repos.d/docker-ce.repo</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ›´æ–°é•œåƒæºç¼“å­˜</span></span><br><span class="line">yum makecache fast</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ç„¶åè¾“å…¥å‘½ä»¤</span></span><br><span class="line">yum install -y docker-ce</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">docker-ceä¸ºç¤¾åŒºå…è´¹ç‰ˆæœ¬ã€‚ç¨ç­‰ç‰‡åˆ»ï¼Œdockerå³å¯å®‰è£…æˆåŠŸã€‚</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¸€å®šè¦å…³é—­é˜²ç«å¢™åï¼Œå†å¯åŠ¨docker</span></span><br><span class="line">systemctl stop firewalld</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ç¦æ­¢å¼€æœºå¯åŠ¨é˜²ç«å¢™</span></span><br><span class="line">systemctl disablefirewalld</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é€šè¿‡å‘½ä»¤å¯åŠ¨dockerï¼š</span></span><br><span class="line">systemctl start docker</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ç„¶åè¾“å…¥å‘½ä»¤ï¼Œå¯ä»¥æŸ¥çœ‹dockerç‰ˆæœ¬</span></span><br><span class="line">docker --version</span><br></pre></td></tr></table></figure><h3 id="é…ç½®é•œåƒ"><a href="#é…ç½®é•œåƒ" class="headerlink" title="é…ç½®é•œåƒ"></a>é…ç½®é•œåƒ</h3><p>dockerå®˜æ–¹é•œåƒä»“åº“ç½‘é€Ÿè¾ƒå·®ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®å›½å†…é•œåƒï¼š<br>å‚è€ƒé˜¿é‡Œäº‘çš„é•œåƒåŠ é€Ÿæ–‡æ¡£ï¼š<br><a href="https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors">https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure><p>æ€»ç»“</p><ul><li>ä»€ä¹ˆæ˜¯Dockerï¼š<br>  å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿæ„å»ºåº”ç”¨é•œåƒã€äº¤ä»˜åº”ç”¨ã€è¿è¡Œåº”ç”¨çš„æŠ€æœ¯</li><li>ä»€ä¹ˆæ˜¯é•œåƒï¼š<br>  å°†åº”ç”¨ç¨‹åºåŠå…¶ä¾èµ–ã€ç¯å¢ƒã€é…ç½®æ‰“åŒ…åœ¨ä¸€èµ·å°±æ˜¯é•œåƒ</li><li>ä»€ä¹ˆæ˜¯å®¹å™¨ï¼š<br>  é•œåƒè¿è¡Œèµ·æ¥å°±æ˜¯å®¹å™¨ï¼Œä¸€ä¸ªé•œåƒå¯ä»¥è¿è¡Œå¤šä¸ªå®¹å™¨</li><li>Dockerå·¥ä½œæµï¼š<br>  æ„å»ºè‡ªå®šä¹‰é•œåƒæˆ–è€…ä»DockerRegistryæ‹‰å–é•œåƒ<br>  æ ¹æ®é•œåƒåˆ›å»ºå®¹å™¨ï¼Œå¹¶è¿è¡Œ</li></ul><p>è¡¥å……ï¼š<br>    Dockerå®¹å™¨åŒ–è™šæ‹ŸåŒ–ä¸ä¼ ç»Ÿè™šæ‹Ÿæœºæ¯”è¾ƒ</p><img src="/2023/06/09/Docker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/3.png" class="" title="Dockerå®¹å™¨åŒ–è™šæ‹ŸåŒ–ä¸ä¼ ç»Ÿè™šæ‹Ÿæœºæ¯”è¾ƒ"><h1 id="Dockerå‘½ä»¤"><a href="#Dockerå‘½ä»¤" class="headerlink" title="Dockerå‘½ä»¤"></a>Dockerå‘½ä»¤</h1><h2 id="Dockerè¿›ç¨‹ç›¸å…³å‘½ä»¤"><a href="#Dockerè¿›ç¨‹ç›¸å…³å‘½ä»¤" class="headerlink" title="Dockerè¿›ç¨‹ç›¸å…³å‘½ä»¤"></a>Dockerè¿›ç¨‹ç›¸å…³å‘½ä»¤</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">å¯åŠ¨dockeræœåŠ¡</span></span><br><span class="line">systemctl start docker</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">åœæ­¢dockeræœåŠ¡</span></span><br><span class="line">systemctl stop docker</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">é‡å¯dockeræœåŠ¡</span></span><br><span class="line">systemctl restart docker</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">æŸ¥çœ‹dockeræœåŠ¡çŠ¶æ€</span></span><br><span class="line">systemctl status docker</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">è®¾ç½®å¼€æœºå¯åŠ¨dockeræœåŠ¡</span></span><br><span class="line">systemctl enable docker</span><br></pre></td></tr></table></figure><h2 id="Dockeré•œåƒç›¸å…³å‘½ä»¤"><a href="#Dockeré•œåƒç›¸å…³å‘½ä»¤" class="headerlink" title="Dockeré•œåƒç›¸å…³å‘½ä»¤"></a>Dockeré•œåƒç›¸å…³å‘½ä»¤</h2><img src="/2023/06/09/Docker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/4.png" class="" title="Dockeré•œåƒç›¸å…³å‘½ä»¤"><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹æœ¬åœ°æ‰€æœ‰çš„é•œåƒ</span></span><br><span class="line">docker images</span><br><span class="line">docker images â€“q # æŸ¥çœ‹æ‰€é•œåƒçš„id</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä»ç½‘ç»œä¸­æŸ¥æ‰¾éœ€è¦çš„é•œåƒ</span></span><br><span class="line">docker search é•œåƒåç§°</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ‹‰å–é•œåƒ</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä»Dockerä»“åº“ä¸‹è½½é•œåƒåˆ°æœ¬åœ°ï¼Œé•œåƒåç§°æ ¼å¼ä¸º åç§°:ç‰ˆæœ¬å·ï¼Œå¦‚æœç‰ˆæœ¬å·ä¸æŒ‡å®šåˆ™æ˜¯æœ€æ–°çš„ç‰ˆæœ¬ã€‚ å¦‚æœä¸çŸ¥é“é•œåƒç‰ˆæœ¬ï¼Œå¯ä»¥å»docker hub æœç´¢å¯¹åº”é•œåƒæŸ¥çœ‹ã€‚</span></span><br><span class="line">docker pull é•œåƒåç§°</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ é™¤æœ¬åœ°é•œåƒ</span></span><br><span class="line">docker rmi é•œåƒid # åˆ é™¤æŒ‡å®šæœ¬åœ°é•œåƒ</span><br><span class="line">docker rmi `docker images -q` # åˆ é™¤æ‰€æœ‰æœ¬åœ°é•œåƒ</span><br></pre></td></tr></table></figure><h2 id="Dockerå®¹å™¨ç›¸å…³å‘½ä»¤"><a href="#Dockerå®¹å™¨ç›¸å…³å‘½ä»¤" class="headerlink" title="Dockerå®¹å™¨ç›¸å…³å‘½ä»¤"></a>Dockerå®¹å™¨ç›¸å…³å‘½ä»¤</h2><img src="/2023/06/09/Docker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/5.png" class="" title="Dockerå®¹å™¨ç›¸å…³å‘½ä»¤"><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹å®¹å™¨</span></span><br><span class="line">docker ps # æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨</span><br><span class="line">docker ps â€“a # æŸ¥çœ‹æ‰€æœ‰å®¹å™¨</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ›å»ºå¹¶å¯åŠ¨å®¹å™¨</span></span><br><span class="line">docker run å‚æ•°</span><br><span class="line"></span><br><span class="line">å‚æ•°è¯´æ˜:</span><br><span class="line">â€¢ -i: ä¿æŒå®¹å™¨è¿è¡Œã€‚é€šå¸¸ä¸ -t åŒæ—¶ä½¿ç”¨ã€‚åŠ å…¥itè¿™ä¸¤ä¸ªå‚æ•°åï¼Œå®¹å™¨åˆ›å»ºåè‡ªåŠ¨è¿›å…¥å®¹å™¨ä¸­ï¼Œé€€å‡ºå®¹å™¨åï¼Œå®¹å™¨è‡ªåŠ¨å…³é—­ã€‚</span><br><span class="line">â€¢ -t: ä¸ºå®¹å™¨é‡æ–°åˆ†é…ä¸€ä¸ªä¼ªè¾“å…¥ç»ˆç«¯ï¼Œé€šå¸¸ä¸ -i åŒæ—¶ä½¿ç”¨ã€‚</span><br><span class="line">â€¢ -d: ä»¥å®ˆæŠ¤(åå°)æ¨¡å¼è¿è¡Œå®¹å™¨ã€‚åˆ›å»ºä¸€ä¸ªå®¹å™¨åœ¨åå°è¿è¡Œï¼Œéœ€è¦ä½¿ç”¨docker exec è¿›å…¥å®¹å™¨ã€‚é€€å‡ºåï¼Œå®¹å™¨ä¸ä¼šå…³é—­ã€‚</span><br><span class="line">â€¢ -it: åˆ›å»ºçš„å®¹å™¨ä¸€èˆ¬ç§°ä¸ºäº¤äº’å¼å®¹å™¨ï¼Œ-id åˆ›å»ºçš„å®¹å™¨ä¸€èˆ¬ç§°ä¸ºå®ˆæŠ¤å¼å®¹å™¨</span><br><span class="line">â€¢ --name: ä¸ºåˆ›å»ºçš„å®¹å™¨å‘½åã€‚</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä»¥åå°æ–¹å¼è¿è¡Œå®¹å™¨ï¼Œå¹¶è¿›å…¥å®¹å™¨</span></span><br><span class="line">[root@hecs-33111 ~]# docker run-id --name=c2 redis:5.0 /bin/bash</span><br><span class="line">3842cee27f9b97fa7fb512aa53f835351f8860ffd5a4dc0e19b9e36d7aadf54</span><br><span class="line">[root@hecs-33111 ~]# docker exec-it c2 /bin/bash</span><br><span class="line">root@3842cee27f9b:/data# </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è¿›å…¥å®¹å™¨</span></span><br><span class="line">docker exec å‚æ•° # é€€å‡ºå®¹å™¨ï¼Œå®¹å™¨ä¸ä¼šå…³é—­</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åœæ­¢å®¹å™¨</span></span><br><span class="line">docker stop å®¹å™¨åç§°</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯åŠ¨å®¹å™¨</span></span><br><span class="line">docker start å®¹å™¨åç§°</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ é™¤å®¹å™¨</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">å¦‚æœå®¹å™¨æ˜¯è¿è¡ŒçŠ¶æ€åˆ™åˆ é™¤å¤±è´¥ï¼Œéœ€è¦åœæ­¢å®¹å™¨æ‰èƒ½åˆ é™¤</span></span><br><span class="line">docker rm å®¹å™¨åç§°</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹å®¹å™¨ä¿¡æ¯</span></span><br><span class="line">docker inspect å®¹å™¨åç§°</span><br></pre></td></tr></table></figure><h1 id="Dockerå®¹å™¨çš„æ•°æ®å·"><a href="#Dockerå®¹å™¨çš„æ•°æ®å·" class="headerlink" title="Dockerå®¹å™¨çš„æ•°æ®å·"></a>Dockerå®¹å™¨çš„æ•°æ®å·</h1><p>Dockerå®¹å™¨ä¸­äº§ç”Ÿçš„æ•°æ®æœ¬èº«ä¹Ÿæ˜¯ä¿å­˜åœ¨å®¹å™¨ä¸­çš„ï¼Œæ‰€ä»¥åˆ é™¤å®¹å™¨çš„è¯å®¹å™¨ä¸­çš„æ•°æ®ä¹Ÿä¼šä¸€å¹¶è¢«åˆ é™¤ã€‚è¿˜æœ‰äº›æ—¶å€™Dockerå®¹å™¨ä¹‹é—´æˆ–è€…å’Œå¤–éƒ¨æœºå™¨ä¹‹é—´éœ€è¦è¿›è¡Œæ•°æ®äº¤äº’ã€‚</p><p>å¦‚æœæƒ³è¦è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜å°±éœ€è¦ç”¨åˆ°æ•°æ®å·ã€‚</p><img src="/2023/06/09/Docker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/6.png" class="" title="Dockerå®¹å™¨çš„æ•°æ®å·"><h2 id="é…ç½®æ•°æ®å·"><a href="#é…ç½®æ•°æ®å·" class="headerlink" title="é…ç½®æ•°æ®å·"></a>é…ç½®æ•°æ®å·</h2><p>åœ¨åˆ›å»ºå®¹å™¨æ—¶ï¼Œä½¿ç”¨-vå‚æ•°è®¾ç½®æ•°æ®å·</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run ... â€“v å®¿ä¸»æœºç›®å½•(æ–‡ä»¶):å®¹å™¨å†…ç›®å½•(æ–‡ä»¶) ...</span><br></pre></td></tr></table></figure><p>æ³¨æ„äº‹é¡¹ï¼š</p><ul><li>ç›®å½•å¿…é¡»æ˜¯ç»å¯¹è·¯å¾„</li><li>å¦‚æœç›®å½•ä¸å­˜åœ¨ä¼šè‡ªåŠ¨åˆ›å»º</li><li>å¯ä»¥æŒ‚åœ¨å¤šä¸ªæ•°æ®å·ï¼Œå³å®¹å™¨Aå’Œå®¹å™¨Bå¯ä»¥ä½¿ç”¨åŒä¸€ä¸ªæ•°æ®å·</li></ul><p><strong>å¤šä¸ªå®¹å™¨æŒ‚è½½ä¸€ä¸ªæ•°æ®å·</strong></p><p>ä¾‹å­ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å…ˆåˆ›å»ºå¯åŠ¨å®¹å™¨c3å¹¶æŒ‚è½½æ•°æ®å·</span></span><br><span class="line">docker run â€“it --name=c3 â€“v /volume centos:7 /bin/bash</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ›å»ºå¯åŠ¨ c1 c2 å®¹å™¨ï¼Œä½¿ç”¨ â€“-volumes-from å‚æ•° è®¾ç½®æ•°æ®å·</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä½¿ç”¨å‚æ•°--volumes-fromæ¥è¾¾åˆ°ä¸c3å®¹å™¨ä½¿ç”¨åŒä¸€ä¸ªæ•°æ®å·çš„æ•ˆæœ</span></span><br><span class="line">docker run â€“it --name=c1 --volumes-from c3 centos:7 /bin/bash </span><br><span class="line">docker run â€“it --name=c2 --volumes-from c3 centos:7 /bin/bash</span><br></pre></td></tr></table></figure><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><ol><li>æ•°æ®å·æ¦‚å¿µ</li></ol><ul><li>å®¿ä¸»æœºçš„ä¸€ä¸ªç›®å½•æˆ–æ–‡ä»¶</li></ul><ol start="2"><li>æ•°æ®å·ä½œç”¨</li></ol><ul><li>å®¹å™¨æ•°æ®æŒä¹…åŒ–</li><li>å®¢æˆ·ç«¯å’Œå®¹å™¨æ•°æ®äº¤æ¢</li><li>å®¹å™¨é—´æ•°æ®äº¤æ¢</li></ul><ol start="3"><li>æ•°æ®å·å®¹å™¨</li></ol><ul><li>åˆ›å»ºä¸€ä¸ªå®¹å™¨ï¼ŒæŒ‚è½½ä¸€ä¸ªç›®å½•ï¼Œè®©å…¶ä»–å®¹å™¨ç»§æ‰¿è‡ªè¯¥å®¹å™¨(â€“volume-from)ã€‚</li><li>é€šè¿‡ç®€å•æ–¹å¼å®ç°æ•°æ®å·é…ç½®</li></ul><h1 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h1><h2 id="Dockeré•œåƒåŸç†"><a href="#Dockeré•œåƒåŸç†" class="headerlink" title="Dockeré•œåƒåŸç†"></a>Dockeré•œåƒåŸç†</h2><p>ç»è¿‡ä»¥ä¸Šå‡ ç« çš„ä»‹ç»ï¼Œç›¸ä¿¡ä½ å·²ç»å¯¹Dockeræœ‰äº†æ›´è¿›ä¸€æ­¥çš„äº†è§£ï¼Œå¦‚æœè¿˜æ²¡æœ‰è‡ªå·±æ‹‰å–è¿‡å‡ ä¸ªé•œåƒå¹¶éƒ¨ç½²å®¹å™¨çš„è¯èµ¶ç´§å…ˆå»è¯•è¯•å§ï¼Œå¦‚æœå·²ç»å°è¯•è¿‡äº†ï¼Œé‚£ä¹ˆä½ å¯èƒ½ä¼šå‘ç°ï¼š</p><ul><li>Dockerä¸­CentOSçš„é•œåƒå¤§å°åªæœ‰200mï¼Œä½†æ˜¯æ“ä½œç³»ç»Ÿçš„ISOå´æœ‰å‡ ä¸ªG</li><li>ä¸€ä¸ªTomcatçš„å®‰è£…åŒ…åªæœ‰70mï¼Œä½†æ˜¯Dockerä¸­æ‹‰å–çš„é•œåƒå´æœ‰500m</li></ul><p>è¿™å°±è¦æ¶‰åŠåˆ°Dockeré•œåƒçš„åŸç†äº†ï¼Œä¸‹é¢æˆ‘ä»¬å°†å±•å¼€å¯¹Dockeré•œåƒåŸç†çš„ä»‹ç»ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬è¦äº†è§£ä¸€ä¸ªæ“ä½œç³»ç»Ÿçš„ç»„æˆéƒ¨åˆ†ï¼š</p><ul><li>è¿›ç¨‹è°ƒåº¦å­ç¨‹åº</li><li>è¿›ç¨‹é€šä¿¡å­ç¨‹åº</li><li>å†…å­˜ç®¡ç†å­ç¨‹åº</li><li>è®¾å¤‡ç®¡ç†å­ç¨‹åº</li><li><strong>æ–‡ä»¶ç®¡ç†å­ç¨‹åº</strong></li><li>ç½‘ç»œé€šä¿¡å­ç¨‹åº</li><li>ä½œä¸šæ§åˆ¶å­ç¨‹åº</li></ul><p>å…¶ä¸­æ–‡ä»¶ç®¡ç†å­ç³»ç»Ÿ</p><ol><li>rootfs: rootæ–‡ä»¶ç³»ç»Ÿï¼ŒåŒ…å«çš„å°±æ˜¯å…¸å‹ Linux ç³»ç»Ÿä¸­çš„&#x2F;devï¼Œ&#x2F;procï¼Œ&#x2F;binï¼Œ&#x2F;etcç­‰æ ‡å‡†ç›®å½•å’Œæ–‡ä»¶</li><li>bootfs: åŠ è½½å¼•å¯¼ç¨‹åº(bootloader)+å†…æ ¸ (kernel)</li><li>ä¸åŒçš„linuxå‘è¡Œç‰ˆæœ¬ï¼ŒbootfsåŸºæœ¬ä¸€æ ·ï¼Œrootfsä¸åŒ</li></ol><ul><li>Dockeré•œåƒæ˜¯ç”±ç‰¹æ®Šçš„æ–‡ä»¶ç³»ç»Ÿå åŠ è€Œæˆçš„</li><li>æœ€ä½ç«¯æ˜¯bootfså¹¶ä½¿ç”¨å®¿ä¸»æœºçš„bootfs</li><li>ç¬¬äºŒå±‚æ˜¯rootæ–‡ä»¶ç³»ç»Ÿrootfs,ç§°ä¸ºbase image</li><li>ç„¶åå†å¾€ä¸Šå¯ä»¥å‚åŠ å…¶ä»–ç³»ç»Ÿçš„é•œåƒæ–‡ä»¶</li><li>ç»Ÿä¸€æ–‡ä»¶ç³»ç»Ÿ(Union File Svstem)æŠ€æœ¯èƒ½å¤Ÿå°†ä¸åŒçš„å±‚æ•´åˆæˆä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œä¸ºè¿™äº›å±‚æä¾›ä¸€ä¸ªç»Ÿä¸€çš„è§†è§’ï¼Œè¿™æ ·å°±éšè—äº†å¤šå±‚çš„å­˜åœ¨ï¼Œåœ¨ç”¨æˆ·çš„è§’åº¦æ¥çœ‹ï¼Œåªå­˜åœ¨ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿã€‚</li><li>ä¸€ä¸ªé•œåƒå¯ä»¥æ”¾åœ¨å¦ä¸€ä¸ªé•œåƒçš„ä¸Šé¢ï¼Œä½äºä¸‹é¢çš„é•œåƒç§°ä¸ºçˆ¶é•œåƒï¼Œæœ€åº•å±‚çš„é•œåƒç§°ä¸ºåŸºç¡€é•œåƒå½“ä»ä¸€ä¸ªé•œåƒå¯åŠ¨å®¹å™¨çš„æ—¶å€™ï¼ŒDockerä¼šåœ¨æœ€é¡¶å±‚åŠ è½½ä¸€ä¸ªè¯»å†™æ–‡ä»¶ç³»ç»Ÿä½œä¸ºå®¹å™¨</li></ul><img src="/2023/06/09/Docker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/7.png" class="" title="Dockeré•œåƒåŸç†"><h2 id="é•œåƒåˆ¶ä½œ"><a href="#é•œåƒåˆ¶ä½œ" class="headerlink" title="é•œåƒåˆ¶ä½œ"></a>é•œåƒåˆ¶ä½œ</h2><p>æœ‰ä¸¤ç§æ–¹æ³•ï¼š<br><strong>ä¸€ã€å®¹å™¨è½¬ä¸ºé•œåƒ</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">commit å®¹å™¨id é•œåƒåç§°:ç‰ˆæœ¬å·</span><br><span class="line">save -o å‹ç¼©æ–‡ä»¶åç§° é•œåƒåç§°:ç‰ˆæœ¬å·</span><br><span class="line">load - å‹ç¼©æ–‡ä»¶åç§°</span><br></pre></td></tr></table></figure><img src="/2023/06/09/Docker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/8.png" class="" title="Dockeré•œåƒåŸç†2"><p><strong>äºŒã€dockerfile</strong></p><ul><li>Dockerfile æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶</li><li>åŒ…å«äº†ä¸€æ¡æ¡çš„æŒ‡ä»¤</li><li>æ¯ä¸€æ¡æŒ‡ä»¤æ„å»ºä¸€å±‚ï¼ŒåŸºäºåŸºç¡€é•œåƒï¼Œæœ€ç»ˆæ„å»ºå‡ºä¸€ä¸ªæ–°çš„é•œåƒ</li><li>å¯¹äºå¼€å‘äººå‘˜ï¼šå¯ä»¥ä¸ºå¼€å‘å›¢é˜Ÿæä¾›ä¸€ä¸ªå®Œå…¨ä¸€è‡´çš„å¼€å‘ç¯å¢ƒ</li><li>å¯¹äºæµ‹è¯•äººå‘˜ï¼šå¯ä»¥ç›´æ¥æ‹¿å¼€å‘æ—¶æ‰€æ„å»ºçš„é•œåƒæˆ–è€…é€šè¿‡Dockerfileæ–‡ä»¶æ„å»ºä¸€ä¸ªæ–°çš„é•œåƒå¼€å§‹å·¥ä½œäº†å¯¹äºè¿ç»´äººå‘˜ï¼šåœ¨éƒ¨ç½²æ—¶ï¼Œå¯ä»¥å®ç°åº”ç”¨çš„æ— ç¼ç§»æ¤</li></ul><img src="/2023/06/09/Docker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/9.png" class="" title="dockerfileå…³é”®å­—1"><img src="/2023/06/09/Docker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/10.png" class="" title="dockerfileå…³é”®å­—2"><h3 id="æ¡ˆä¾‹"><a href="#æ¡ˆä¾‹" class="headerlink" title="æ¡ˆä¾‹"></a>æ¡ˆä¾‹</h3><p>è‡ªå®šä¹‰ä¸€ä¸ª centos7é•œåƒ</p><ol><li>é»˜è®¤ç™»å½•è·¯å¾„ä¸º&#x2F;usr</li><li>å¯ä»¥ä½¿ç”¨vim<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">## æ­¥éª¤</span></span></span><br><span class="line">1. å®šä¹‰ä¸€ä¸ªçˆ¶é•œåƒ FROM centos:7</span><br><span class="line">2. å®šä¹‰ä½œè€…ä¿¡æ¯ MAINTAINER Shelton &lt;uli65535@gmail.com&gt;</span><br><span class="line">3. æ‰§è¡Œå®‰è£…vimçš„å‘½ä»¤ RUN yum install -y vim</span><br><span class="line">4. å®šä¹‰é»˜è®¤çš„å·¥ä½œç›®å½•WORKDIR /usr</span><br><span class="line">5. å®šä¹‰å®¹å™¨çš„å¯åŠ¨æ‰§è¡Œå‘½ä»¤CMD /bin/bash</span><br></pre></td></tr></table></figure></li></ol><h1 id="DockeræœåŠ¡ç¼–æ’"><a href="#DockeræœåŠ¡ç¼–æ’" class="headerlink" title="DockeræœåŠ¡ç¼–æ’"></a>DockeræœåŠ¡ç¼–æ’</h1><p>å¾®æœåŠ¡æ¶æ„çš„åº”ç”¨ç³»ç»Ÿä¸­ä¸€èˆ¬åŒ…å«è‹¥å¹²ä¸ªå¾®æœåŠ¡ï¼Œæ¯ä¸ªå¾®æœåŠ¡ä¸€èˆ¬éƒ½ä¼šéƒ¨ç½²å¤šä¸ªå®ä¾‹ï¼Œå¦‚æœæ¯ä¸ªå¾®æœåŠ¡éƒ½è¦æ‰‹åŠ¨å¯åœï¼Œç»´æŠ¤çš„å·¥ä½œé‡ä¼šå¾ˆå¤§</p><ul><li>è¦ä»Dockerfilebuildimageæˆ–è€…å»dockerhubæ‹‰å–image</li><li>è¦åˆ›å»ºå¤šä¸ªcontainer</li><li>è¦ç®¡ç†è¿™äº›container (å¯åŠ¨åœæ­¢åˆ é™¤)</li></ul><p>æœåŠ¡ç¼–æ’: æŒ‰ç…§ä¸€å®šçš„ä¸šåŠ¡è§„åˆ™æ‰¹é‡ç®¡ç†å®¹å™¨</p><p>Docker Composeå°±æ˜¯ä¸€ä¸ªç¼–æ’å¤šå®¹å™¨åˆ†å¸ƒå¼éƒ¨ç½²çš„å·¥å…·ï¼Œæä¾›å‘½ä»¤é›†ç®¡ç†å®¹å™¨åŒ–åº”ç”¨çš„å®Œæ•´å¼€å‘å‘¨æœŸï¼ŒåŒ…æ‹¬æœåŠ¡æ„å»ºå¯åŠ¨å’Œåœæ­¢ã€‚ä½¿ç”¨æ­¥éª¤:</p><ol><li>åˆ©ç”¨ Dockerfileå®šä¹‰è¿è¡Œç¯å¢ƒé•œåƒ</li><li>ä½¿ç”¨docker-composeymlå®šä¹‰ç»„æˆåº”ç”¨çš„å„æœåŠ¡</li><li>è¿è¡Œ docker-composeupå¯åŠ¨åº”ç”¨</li></ol><p><strong>å®‰è£…Docker-Compose</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Composeç›®å‰å·²ç»å®Œå…¨æ”¯æŒLinuxã€Mac OSå’ŒWindowsï¼Œ</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">åœ¨æˆ‘ä»¬å®‰è£…Composeä¹‹å‰ï¼Œéœ€è¦å…ˆå®‰è£…Docker</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">ä¸‹é¢æˆ‘ä»¬ä»¥ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶åŒ…æ–¹å¼å®‰è£…åœ¨Linuxç³»ç»Ÿä¸­ã€‚</span> </span><br><span class="line">curl -L https://github.com/docker/compose/releases/download/1.22.0/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è®¾ç½®æ–‡ä»¶å¯æ‰§è¡Œæƒé™</span> </span><br><span class="line">chmod +x /usr/local/bin/docker-compose</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯</span> </span><br><span class="line">docker-compose -version</span><br></pre></td></tr></table></figure><p><strong>å¸è½½Docker Compose</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">äºŒè¿›åˆ¶åŒ…æ–¹å¼å®‰è£…çš„ï¼Œåˆ é™¤äºŒè¿›åˆ¶æ–‡ä»¶å³å¯</span></span><br><span class="line">rm /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure><h3 id="æ¡ˆä¾‹ï¼šåŒæ—¶å¯åŠ¨nginxå’ŒSpringBooté¡¹ç›®ï¼ˆå·²ç»åˆ›å»ºä¸ºdockerä¸­çš„å®¹å™¨ï¼Œåä¸ºappï¼‰"><a href="#æ¡ˆä¾‹ï¼šåŒæ—¶å¯åŠ¨nginxå’ŒSpringBooté¡¹ç›®ï¼ˆå·²ç»åˆ›å»ºä¸ºdockerä¸­çš„å®¹å™¨ï¼Œåä¸ºappï¼‰" class="headerlink" title="æ¡ˆä¾‹ï¼šåŒæ—¶å¯åŠ¨nginxå’ŒSpringBooté¡¹ç›®ï¼ˆå·²ç»åˆ›å»ºä¸ºdockerä¸­çš„å®¹å™¨ï¼Œåä¸ºappï¼‰"></a>æ¡ˆä¾‹ï¼šåŒæ—¶å¯åŠ¨nginxå’ŒSpringBooté¡¹ç›®ï¼ˆå·²ç»åˆ›å»ºä¸ºdockerä¸­çš„å®¹å™¨ï¼Œåä¸ºappï¼‰</h3><p>1ã€åˆ›å»ºdocker-composeç›®å½•</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir ~/docker-compose</span><br><span class="line">cd ~/docker-compose</span><br></pre></td></tr></table></figure><p>2ã€ç¼–å†™ docker-compose.yml æ–‡ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">version: &#x27;3&#x27;</span><br><span class="line">services:</span><br><span class="line">  nginx:</span><br><span class="line">   image: nginx</span><br><span class="line">   ports:</span><br><span class="line">    - 80:80</span><br><span class="line">   links:</span><br><span class="line">    - app</span><br><span class="line">   volumes:</span><br><span class="line">    - ./nginx/conf.d:/etc/nginx/conf.d</span><br><span class="line">  app:</span><br><span class="line">    image: app</span><br><span class="line">    expose:</span><br><span class="line">      - &quot;8080&quot;</span><br></pre></td></tr></table></figure><p>3ã€åˆ›å»º.&#x2F;nginx&#x2F;conf.dç›®å½•</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p ./nginx/conf.d</span><br></pre></td></tr></table></figure><p>4ã€åœ¨.&#x2F;nginx&#x2F;conf.dç›®å½•ä¸‹ ç¼–å†™shelton.confæ–‡ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    access_log off;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://app:8080;</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>5ã€åœ¨~&#x2F;docker-compose ç›®å½•ä¸‹ ä½¿ç”¨docker-compose å¯åŠ¨å®¹å™¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up</span><br></pre></td></tr></table></figure><p>6ã€æµ‹è¯•è®¿é—®</p><h1 id="ç§æœ‰ä»“åº“"><a href="#ç§æœ‰ä»“åº“" class="headerlink" title="ç§æœ‰ä»“åº“"></a>ç§æœ‰ä»“åº“</h1><p>Dockerå®˜æ–¹çš„Docker hub (<a href="https://hub.docker.com/">https://hub.docker.com</a>) æ˜¯ä¸€ä¸ªç”¨äºç®¡ç†å…¬å…±é•œåƒçš„ä»“åº“ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä¸Šé¢æ‹‰å–é•œåƒåˆ°æœ¬åœ°ï¼Œä¹Ÿå¯ä»¥æŠŠæˆ‘ä»¬è‡ªå·±çš„é•œåƒæ¨é€ä¸Šå»ã€‚ä½†æ˜¯ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬çš„æœåŠ¡å™¨æ— æ³•è®¿é—®äº’è”ç½‘ï¼Œæˆ–è€…ä½ ä¸å¸Œæœ›å°†è‡ªå·±çš„é•œåƒæ”¾åˆ°å…¬ç½‘å½“ä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦æ­å»ºè‡ªå·±çš„ç§æœ‰ä»“åº“æ¥å­˜å‚¨å’Œç®¡ç†è‡ªå·±çš„é•œåƒã€‚</p><p>ä¸€ã€ç§æœ‰ä»“åº“æ­å»º</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1ã€æ‹‰å–ç§æœ‰ä»“åº“é•œåƒ</span> </span><br><span class="line">docker pull registry</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2ã€å¯åŠ¨ç§æœ‰ä»“åº“å®¹å™¨</span> </span><br><span class="line">docker run -id --name=registry -p 5000:5000 registry</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">3ã€æ‰“å¼€æµè§ˆå™¨ è¾“å…¥åœ°å€http://ç§æœ‰ä»“åº“æœåŠ¡å™¨ip:5000/v2/_catalogï¼Œçœ‹åˆ°&#123;<span class="string">&quot;repositories&quot;</span>:[]&#125; è¡¨ç¤ºç§æœ‰ä»“åº“ æ­å»ºæˆåŠŸ</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">4ã€ä¿®æ”¹daemon.json</span>   </span><br><span class="line">vim /etc/docker/daemon.json</span><br><span class="line">    </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åœ¨ä¸Šè¿°æ–‡ä»¶ä¸­æ·»åŠ ä¸€ä¸ªkeyï¼Œä¿å­˜é€€å‡ºã€‚æ­¤æ­¥ç”¨äºè®© docker ä¿¡ä»»ç§æœ‰ä»“åº“åœ°å€ï¼›æ³¨æ„å°†ç§æœ‰ä»“åº“æœåŠ¡å™¨ipä¿®æ”¹ä¸ºè‡ªå·±ç§æœ‰ä»“åº“æœåŠ¡å™¨çœŸå®ip</span> </span><br><span class="line">&#123;&quot;insecure-registries&quot;:[&quot;ç§æœ‰ä»“åº“æœåŠ¡å™¨ip:5000&quot;]&#125; </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">5ã€é‡å¯docker æœåŠ¡</span> </span><br><span class="line">systemctl restart docker</span><br><span class="line">docker start registry</span><br></pre></td></tr></table></figure><p>äºŒã€å°†é•œåƒä¸Šä¼ è‡³ç§æœ‰ä»“åº“</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1ã€æ ‡è®°é•œåƒä¸ºç§æœ‰ä»“åº“çš„é•œåƒ</span>     </span><br><span class="line">docker tag centos:7 ç§æœ‰ä»“åº“æœåŠ¡å™¨IP:5000/centos:7</span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2ã€ä¸Šä¼ æ ‡è®°çš„é•œåƒ</span>     </span><br><span class="line">docker push ç§æœ‰ä»“åº“æœåŠ¡å™¨IP:5000/centos:7</span><br></pre></td></tr></table></figure><p>ä¸‰ã€ ä»ç§æœ‰ä»“åº“æ‹‰å–é•œåƒ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">æ‹‰å–é•œåƒ</span> </span><br><span class="line">docker pull ç§æœ‰ä»“åº“æœåŠ¡å™¨ip:5000/centos:7</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Docker </tag>
            
            <tag> ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MongoDB</title>
      <link href="/2023/05/20/MongoDB/"/>
      <url>/2023/05/20/MongoDB/</url>
      
        <content type="html"><![CDATA[<h1 id="1-MongoDBç›¸å…³æ¦‚å¿µ"><a href="#1-MongoDBç›¸å…³æ¦‚å¿µ" class="headerlink" title="1. MongoDBç›¸å…³æ¦‚å¿µ"></a>1. MongoDBç›¸å…³æ¦‚å¿µ</h1><h2 id="1-1-ä¸šåŠ¡åœºæ™¯"><a href="#1-1-ä¸šåŠ¡åœºæ™¯" class="headerlink" title="1.1 ä¸šåŠ¡åœºæ™¯"></a>1.1 ä¸šåŠ¡åœºæ™¯</h2><p>ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“ (æ¯”å¦‚ MySQL), åœ¨æ•°æ®æ“ä½œçš„â€ä¸‰é«˜â€éœ€æ±‚ä»¥åŠå¯¹åº”çš„ Web 2.0 ç½‘ç«™éœ€æ±‚é¢å‰, ä¼šæœ‰â€åŠ›ä¸ä»å¿ƒâ€çš„æ„Ÿè§‰</p><p>æ‰€è°“çš„ä¸‰é«˜æ˜¯:<br><strong>é«˜å¹¶å‘,</strong><br><strong>é«˜æ€§èƒ½,</strong><br><strong>é«˜å¯ç”¨</strong></p><ul><li><p>High Performance: å¯¹æ•°æ®åº“çš„<strong>é«˜å¹¶å‘è¯»å†™</strong>çš„è¦æ±‚</p></li><li><p>High Storage: å¯¹<strong>æµ·é‡æ•°æ®</strong>çš„é«˜æ•ˆç‡å­˜å‚¨å’Œè®¿é—®çš„éœ€æ±‚</p></li><li><p>High Scalability &amp;&amp; High Available: å¯¹æ•°æ®çš„<strong>é«˜æ‰©å±•æ€§å’Œé«˜å¯ç”¨æ€§</strong>çš„éœ€æ±‚</p></li></ul><p><strong>è€Œ MongoDB å¯ä»¥åº”å¯¹ä¸‰é«˜éœ€æ±‚</strong></p><p>å…·ä½“çš„åº”ç”¨åœºæ™¯:</p><ol><li>ç¤¾äº¤åœºæ™¯, ä½¿ç”¨ MongoDB å­˜å‚¨å­˜å‚¨ç”¨æˆ·ä¿¡æ¯, ä»¥åŠç”¨æˆ·å‘è¡¨çš„æœ‹å‹åœˆä¿¡æ¯, é€šè¿‡åœ°ç†ä½ç½®ç´¢å¼•å®ç°é™„è¿‘çš„äºº, åœ°ç‚¹ç­‰åŠŸèƒ½ã€‚</li><li>æ¸¸æˆåœºæ™¯, ä½¿ç”¨ MongoDB å­˜å‚¨æ¸¸æˆç”¨æˆ·ä¿¡æ¯, ç”¨æˆ·çš„è£…å¤‡, ç§¯åˆ†ç­‰ç›´æ¥ä»¥å†…åµŒæ–‡æ¡£çš„å½¢å¼å­˜å‚¨, æ–¹ä¾¿æŸ¥è¯¢, é«˜æ•ˆç‡å­˜å‚¨å’Œè®¿é—®ã€‚</li><li>ç‰©æµåœºæ™¯, ä½¿ç”¨ MongoDB å­˜å‚¨è®¢å•ä¿¡æ¯, è®¢å•çŠ¶æ€åœ¨è¿é€è¿‡ç¨‹ä¸­ä¼šä¸æ–­æ›´æ–°, ä»¥ MongoDB å†…åµŒæ•°ç»„çš„å½¢å¼æ¥å­˜å‚¨, ä¸€æ¬¡æŸ¥è¯¢å°±èƒ½å°†è®¢å•æ‰€æœ‰çš„å˜æ›´è¯»å–å‡ºæ¥ã€‚</li><li>ç‰©è”ç½‘åœºæ™¯, ä½¿ç”¨ MongoDB å­˜å‚¨æ‰€æœ‰æ¥å…¥çš„æ™ºèƒ½è®¾å¤‡ä¿¡æ¯, ä»¥åŠè®¾å¤‡æ±‡æŠ¥çš„æ—¥å¿—ä¿¡æ¯, å¹¶å¯¹è¿™äº›ä¿¡æ¯è¿›è¡Œå¤šç»´åº¦çš„åˆ†æã€‚</li><li>è§†é¢‘ç›´æ’­, ä½¿ç”¨ MongoDB å­˜å‚¨ç”¨æˆ·ä¿¡æ¯, ç‚¹èµäº’åŠ¨ä¿¡æ¯ç­‰ã€‚</li></ol><p>è¿™äº›åº”ç”¨åœºæ™¯ä¸­, æ•°æ®æ“ä½œæ–¹é¢çš„å…±åŒç‚¹æœ‰:</p><ul><li>æ•°æ®é‡å¤§</li><li>å†™å…¥æ“ä½œé¢‘ç¹</li><li>ä»·å€¼è¾ƒä½çš„æ•°æ®, å¯¹äº‹åŠ¡æ€§è¦æ±‚ä¸é«˜</li></ul><p>å¯¹äºè¿™æ ·çš„æ•°æ®, æ›´é€‚åˆç”¨ MongoDB æ¥å®ç°æ•°æ®å­˜å‚¨</p><p>é‚£ä¹ˆæˆ‘ä»¬ä»€ä¹ˆæ—¶å€™é€‰æ‹© MongoDB å‘¢?</p><p>é™¤äº†æ¶æ„é€‰å‹ä¸Š, é™¤äº†ä¸Šè¿°ä¸‰ä¸ªç‰¹ç‚¹ä¹‹å¤–, è¿˜è¦è€ƒè™‘ä¸‹é¢è¿™äº›é—®é¢˜:</p><ul><li>åº”ç”¨ä¸éœ€è¦äº‹åŠ¡åŠå¤æ‚ JOIN æ”¯æŒ</li><li>æ–°åº”ç”¨, éœ€æ±‚ä¼šå˜, æ•°æ®æ¨¡å‹æ— æ³•ç¡®å®š, æƒ³å¿«é€Ÿè¿­ä»£å¼€å‘</li><li>åº”ç”¨éœ€è¦ 2000 - 3000 ä»¥ä¸Šçš„è¯»å†™QPSï¼ˆæ›´é«˜ä¹Ÿå¯ä»¥ï¼‰</li><li>åº”ç”¨éœ€è¦ TB ç”šè‡³ PB çº§åˆ«æ•°æ®å­˜å‚¨</li><li>åº”ç”¨å‘å±•è¿…é€Ÿ, éœ€è¦èƒ½å¿«é€Ÿæ°´å¹³æ‰©å±•</li><li>åº”ç”¨è¦æ±‚å­˜å‚¨çš„æ•°æ®ä¸ä¸¢å¤±</li><li>åº”ç”¨éœ€è¦ 99.999% é«˜å¯ç”¨</li><li>åº”ç”¨éœ€è¦å¤§é‡çš„åœ°ç†ä½ç½®æŸ¥è¯¢, æ–‡æœ¬æŸ¥è¯¢</li></ul><p>å¦‚æœä¸Šè¿°æœ‰1ä¸ªç¬¦åˆ, å¯ä»¥è€ƒè™‘ MongoDB, 2ä¸ªåŠä»¥ä¸Šçš„ç¬¦åˆ, é€‰æ‹©MongoDBç»ä¸ä¼šåæ‚”ã€‚</p><h2 id="1-2-MongoDB-ç®€ä»‹"><a href="#1-2-MongoDB-ç®€ä»‹" class="headerlink" title="1.2 MongoDB ç®€ä»‹"></a>1.2 MongoDB ç®€ä»‹</h2><p>MongoDBæ˜¯ä¸€ä¸ªå¼€æº, é«˜æ€§èƒ½, æ— æ¨¡å¼çš„æ–‡æ¡£å‹æ•°æ®åº“, å½“åˆçš„è®¾è®¡å°±æ˜¯ç”¨äºç®€åŒ–å¼€å‘å’Œæ–¹ä¾¿æ‰©å±•, æ˜¯NoSQLæ•°æ®åº“äº§å“ä¸­çš„ä¸€ç§ã€‚<strong>æ˜¯æœ€åƒå…³ç³»å‹æ•°æ®åº“ï¼ˆMySQLï¼‰çš„éå…³ç³»å‹æ•°æ®åº“</strong>ã€‚</p><p>å®ƒæ”¯æŒçš„æ•°æ®ç»“æ„éå¸¸æ¾æ•£, æ˜¯ä¸€ç§<strong>ç±»ä¼¼äºJSONçš„æ ¼å¼å«BSON</strong>, æ‰€ä»¥å®ƒæ—¢å¯ä»¥å­˜å‚¨æ¯”è¾ƒå¤æ‚çš„æ•°æ®ç±»å‹, åˆç›¸å½“çš„çµæ´»ã€‚</p><p>MongoDBä¸­çš„è®°å½•æ˜¯ä¸€ä¸ªæ–‡æ¡£, å®ƒæ˜¯ä¸€ä¸ªç”±å­—æ®µå’Œå€¼å¯¹ï¼ˆï¬eld:valueï¼‰ç»„æˆçš„æ•°æ®ç»“æ„ã€‚MongoDBæ–‡æ¡£ç±»ä¼¼äºJSONå¯¹è±¡, å³ä¸€ä¸ªæ–‡æ¡£è®¤ä¸ºå°±æ˜¯ä¸€ä¸ªå¯¹è±¡.å­—æ®µçš„æ•°æ®ç±»å‹æ˜¯å­—ç¬¦å‹, å®ƒçš„å€¼é™¤äº†ä½¿ç”¨åŸºæœ¬çš„ä¸€äº›ç±»å‹å¤–, è¿˜å¯ä»¥åŒ…æ‹¬å…¶ä»–æ–‡æ¡£, æ™®é€šæ•°ç»„å’Œæ–‡æ¡£æ•°ç»„ã€‚</p><img src="/2023/05/20/MongoDB/1.png" class="" title="MySQLä¸MongoDBç›¸æ¯”"><img src="/2023/05/20/MongoDB/2.png" class="" title="MySQLä¸MongoDBç›¸æ¯”2"><p>Mongoæœ€å¤§çš„ç‰¹ç‚¹æ˜¯å®ƒæ”¯æŒçš„æŸ¥è¯¢è¯­è¨€éå¸¸å¼ºå¤§ï¼Œå…¶è¯­æ³•æœ‰ç‚¹ç±»ä¼¼äºé¢å‘å¯¹è±¡çš„æŸ¥è¯¢è¯­è¨€ï¼Œå‡ ä¹å¯ä»¥å®ç°ç±»ä¼¼å…³ç³»æ•°æ®åº“å•è¡¨æŸ¥è¯¢çš„ç»å¤§éƒ¨åˆ†åŠŸèƒ½ï¼Œè€Œä¸”è¿˜æ”¯æŒå¯¹æ•°æ®å»ºç«‹ç´¢å¼•ã€‚</p><p>MongoDBä¸­çš„è®°å½•æ˜¯ä¸€ä¸ªæ–‡æ¡£, æ˜¯ä¸€ä¸ªé”®å€¼å¯¹ã€‚å­—æ®µçš„æ•°æ®ç±»å‹æ˜¯å­—ç¬¦å‹, å€¼é™¤äº†ä½¿ç”¨åŸºæœ¬çš„ä¸€äº›ç±»å‹ä»¥å¤–, è¿˜åŒ…æ‹¬å…¶å®ƒæ–‡æ¡£, æ™®é€šæ•°ç»„ä»¥åŠæ–‡æ¡£æ•°ç»„ã€‚</p><p>MongoDBæ•°æ®ç±»å‹å‚è€ƒåˆ—è¡¨å¦‚ä¸‹ï¼š</p><img src="/2023/05/20/MongoDB/2.png" class="" title="MySQLä¸MongoDBç›¸æ¯”2"><p>MongoDBæ•°æ®æ¨¡å‹æ˜¯é¢å‘æ–‡æ¡£çš„, æ‰€è°“æ–‡æ¡£å°±æ˜¯ä¸€ç§ç±»ä¼¼äºJSONçš„ç»“æ„, ç®€å•ç†è§£MongoDBè¿™ä¸ªæ•°æ®åº“ä¸­å­˜åœ¨çš„æ˜¯å„ç§å„æ ·çš„JSONï¼ˆBSONï¼‰</p><p>åœ¨ MongoDB ä¸­, æ•°æ®åº“å’Œé›†åˆéƒ½ä¸éœ€è¦æ‰‹åŠ¨åˆ›å»º, å½“æˆ‘ä»¬åˆ›å»ºæ–‡æ¡£æ—¶, å¦‚æœæ–‡æ¡£æ‰€åœ¨çš„é›†åˆæˆ–è€…æ•°æ®åº“ä¸å­˜åœ¨, åˆ™ä¼šè‡ªåŠ¨åˆ›å»ºæ•°æ®åº“æˆ–è€…é›†åˆ</p><h2 id="1-3-MongoDB-ç‰¹ç‚¹"><a href="#1-3-MongoDB-ç‰¹ç‚¹" class="headerlink" title="1.3 MongoDB ç‰¹ç‚¹"></a>1.3 MongoDB ç‰¹ç‚¹</h2><h3 id="1-3-1-é«˜æ€§èƒ½"><a href="#1-3-1-é«˜æ€§èƒ½" class="headerlink" title="1.3.1 é«˜æ€§èƒ½"></a>1.3.1 é«˜æ€§èƒ½</h3><p>MongoDB æä¾›é«˜æ€§èƒ½çš„æ•°æ®æŒä¹…åŒ–</p><ul><li>åµŒå…¥å¼æ•°æ®æ¨¡å‹çš„æ”¯æŒå‡å°‘äº†æ•°æ®åº“ç³»ç»Ÿä¸Šçš„ I&#x2F;O æ´»åŠ¨</li><li>ç´¢å¼•æ”¯æŒæ›´å¿«çš„æŸ¥è¯¢, å¹¶ä¸”å¯ä»¥åŒ…å«æ¥è‡ªåµŒå…¥å¼æ–‡æ¡£å’Œæ•°ç»„çš„é”® (æ–‡æœ¬ç´¢å¼•è§£å†³æœç´¢çš„éœ€æ±‚, TTL ç´¢å¼•è§£å†³å†å²æ•°æ®è‡ªåŠ¨è¿‡æœŸçš„éœ€æ±‚, åœ°ç†ä½ç½®ç´¢å¼•å¯ä»¥ç”¨äºæ„ä»¶å„ç§ O2O åº”ç”¨)</li><li>mmapv1, wiredtiger, mongorocks (rocksdb) in-memory ç­‰å¤šå¼•æ“æ”¯æŒæ»¡è¶³å„ç§åœºæ™¯éœ€æ±‚</li><li>Gridfs è§£å†³æ–‡ä»¶å­˜å‚¨éœ€æ±‚</li></ul><h3 id="1-3-2-é«˜å¯ç”¨"><a href="#1-3-2-é«˜å¯ç”¨" class="headerlink" title="1.3.2 é«˜å¯ç”¨"></a>1.3.2 é«˜å¯ç”¨</h3><p>MongoDB çš„å¤åˆ¶å·¥å…·ç§°ä½œå‰¯æœ¬é›† (replica set) å¯ä»¥æä¾›è‡ªåŠ¨æ•…éšœè½¬ç§»å’Œæ•°æ®å†—ä½™</p><h3 id="1-3-3-é«˜æ‰©å±•"><a href="#1-3-3-é«˜æ‰©å±•" class="headerlink" title="1.3.3 é«˜æ‰©å±•"></a>1.3.3 é«˜æ‰©å±•</h3><p>æ°´å¹³æ‰©å±•æ˜¯å…¶æ ¸å¿ƒåŠŸèƒ½ä¸€éƒ¨åˆ†</p><p>åˆ†ç‰‡å°†æ•°æ®åˆ†å¸ƒåœ¨ä¸€ç»„é›†ç¾¤çš„æœºå™¨ä¸Š (æµ·é‡æ•°æ®å­˜å‚¨, æœåŠ¡èƒ½åŠ›æ°´å¹³æ‰©å±•)</p><p>MongoDB æ”¯æŒåŸºäºç‰‡é”®åˆ›å»ºæ•°æ®åŒºåŸŸ, åœ¨ä¸€ä¸ªå¹³è¡¡çš„é›†ç¾¤å½“ä¸­, MongoDB å°†ä¸€ä¸ªåŒºåŸŸæ‰€è¦†ç›–çš„è¯»å†™åªå®šå‘åˆ°è¯¥åŒºåŸŸçš„é‚£äº›ç‰‡</p><h3 id="1-3-4-ä¸°å¯Œçš„æŸ¥è¯¢æ”¯æŒ"><a href="#1-3-4-ä¸°å¯Œçš„æŸ¥è¯¢æ”¯æŒ" class="headerlink" title="1.3.4 ä¸°å¯Œçš„æŸ¥è¯¢æ”¯æŒ"></a>1.3.4 ä¸°å¯Œçš„æŸ¥è¯¢æ”¯æŒ</h3><p>MongoDBæ”¯æŒä¸°å¯Œçš„æŸ¥è¯¢è¯­è¨€, æ”¯æŒè¯»å’Œå†™æ“ä½œ(CRUD), æ¯”å¦‚æ•°æ®èšåˆ, æ–‡æœ¬æœç´¢å’Œåœ°ç†ç©ºé—´æŸ¥è¯¢ç­‰ã€‚</p><h3 id="1-3-5-å…¶ä»–ç‰¹ç‚¹"><a href="#1-3-5-å…¶ä»–ç‰¹ç‚¹" class="headerlink" title="1.3.5 å…¶ä»–ç‰¹ç‚¹"></a>1.3.5 å…¶ä»–ç‰¹ç‚¹</h3><p>æ— æ¨¡å¼ï¼ˆåŠ¨æ€æ¨¡å¼ï¼‰, çµæ´»çš„æ–‡æ¡£æ¨¡å‹ã€‚</p><h1 id="2-å¸¸ç”¨åŸºæœ¬å‘½ä»¤"><a href="#2-å¸¸ç”¨åŸºæœ¬å‘½ä»¤" class="headerlink" title="2. å¸¸ç”¨åŸºæœ¬å‘½ä»¤"></a>2. å¸¸ç”¨åŸºæœ¬å‘½ä»¤</h1><h2 id="2-1-æ•°æ®åº“æ“ä½œ"><a href="#2-1-æ•°æ®åº“æ“ä½œ" class="headerlink" title="2.1 æ•°æ®åº“æ“ä½œ"></a>2.1 æ•°æ®åº“æ“ä½œ</h2><h3 id="2-1-1-é€‰æ‹©å’Œåˆ›å»ºæ•°æ®åº“"><a href="#2-1-1-é€‰æ‹©å’Œåˆ›å»ºæ•°æ®åº“" class="headerlink" title="2.1.1 é€‰æ‹©å’Œåˆ›å»ºæ•°æ®åº“"></a>2.1.1 é€‰æ‹©å’Œåˆ›å»ºæ•°æ®åº“</h3><p>é€‰æ‹©å’Œåˆ›å»ºæ•°æ®åº“</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¦‚æœæ•°æ®åº“ä¸å­˜åœ¨åˆ™è‡ªåŠ¨åˆ›å»º</span></span><br><span class="line">use æ•°æ®åº“å</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¦‚æœåˆ›å»ºäº†ä½†æ˜¯ä¸å¾€é‡Œé¢å­˜ä¸œè¥¿ä»–æ˜¯ä¸ä¼šä¿å­˜è¿™ä¸ªåº“çš„</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ç›¸å½“äºuse ä¸€ä¸ªä¸å­˜åœ¨çš„åº“ï¼Œä¼šåœ¨å†…å­˜ä¸­åˆ›å»ºè¿™ä¸ªåº“</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä½†æ˜¯ä¸å¾€é‡Œé¢æ”¾ä»»ä½•é›†åˆçš„è¯å°±ä¸ä¼šæŒä¹…åŒ–åˆ°ç£ç›˜</span></span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹æœ‰æƒé™æŸ¥çœ‹çš„æ‰€æœ‰çš„æ•°æ®åº“å‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">show dbs </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æˆ–</span></span><br><span class="line">show databases</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹å½“å‰æ­£åœ¨ä½¿ç”¨çš„æ•°æ®åº“å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db</span><br><span class="line"><span class="comment">#MongoDB ä¸­é»˜è®¤çš„æ•°æ®åº“ä¸º testï¼Œå¦‚æœä½ æ²¡æœ‰é€‰æ‹©æ•°æ®åº“ï¼Œé›†åˆå°†å­˜æ”¾åœ¨ test æ•°æ®åº“ä¸­ã€‚</span></span><br></pre></td></tr></table></figure><p>å¦å¤–ï¼š</p><p>æ•°æ®åº“åå¯ä»¥æ˜¯æ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„ä»»æ„UTF-8å­—ç¬¦ä¸²ã€‚</p><ul><li>ä¸èƒ½æ˜¯ç©ºå­—ç¬¦ä¸²ï¼ˆâ€â€)ã€‚</li><li>ä¸å¾—å«æœ‰â€™ â€˜ï¼ˆç©ºæ ¼)ã€.ã€$ã€&#x2F;ã€\å’Œ\0 (ç©ºå­—ç¬¦)ã€‚</li><li>åº”å…¨éƒ¨å°å†™ã€‚</li><li>æœ€å¤š64å­—èŠ‚ã€‚</li></ul><p>æœ‰ä¸€äº›æ•°æ®åº“åæ˜¯ä¿ç•™çš„ï¼Œå¯ä»¥ç›´æ¥è®¿é—®è¿™äº›æœ‰ç‰¹æ®Šä½œç”¨çš„æ•°æ®åº“ã€‚</p><ul><li>adminï¼šä»æƒé™çš„è§’åº¦æ¥çœ‹ï¼Œè¿™æ˜¯â€rootâ€æ•°æ®åº“ã€‚è¦æ˜¯å°†ä¸€ä¸ªç”¨æˆ·æ·»åŠ åˆ°è¿™ä¸ªæ•°æ®åº“ï¼Œè¿™ä¸ªç”¨æˆ·è‡ªåŠ¨ç»§æ‰¿æ‰€æœ‰æ•°æ®åº“çš„æƒé™ã€‚ä¸€äº›ç‰¹<br>å®šçš„æœåŠ¡å™¨ç«¯å‘½ä»¤ä¹Ÿåªèƒ½ä»è¿™ä¸ªæ•°æ®åº“è¿è¡Œï¼Œæ¯”å¦‚åˆ—å‡ºæ‰€æœ‰çš„æ•°æ®åº“æˆ–è€…å…³é—­æœåŠ¡å™¨ã€‚</li><li>localï¼šè¿™ä¸ªæ•°æ®æ°¸è¿œä¸ä¼šè¢«å¤åˆ¶ï¼Œå¯ä»¥ç”¨æ¥å­˜å‚¨é™äºæœ¬åœ°å•å°æœåŠ¡å™¨çš„ä»»æ„é›†åˆ</li><li>configï¼šå½“Mongoç”¨äºåˆ†ç‰‡è®¾ç½®æ—¶ï¼Œconfigæ•°æ®åº“åœ¨å†…éƒ¨ä½¿ç”¨ï¼Œç”¨äºä¿å­˜åˆ†ç‰‡çš„ç›¸å…³ä¿¡æ¯ã€‚</li></ul><h3 id="2-1-2-æ•°æ®åº“çš„åˆ é™¤"><a href="#2-1-2-æ•°æ®åº“çš„åˆ é™¤" class="headerlink" title="2.1.2 æ•°æ®åº“çš„åˆ é™¤"></a>2.1.2 æ•°æ®åº“çš„åˆ é™¤</h3><p>åˆ é™¤å·²ç»æŒä¹…åŒ–çš„æ•°æ®åº“</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.dropDatabase()</span><br></pre></td></tr></table></figure><h2 id="2-2é›†åˆæ“ä½œ"><a href="#2-2é›†åˆæ“ä½œ" class="headerlink" title="2.2é›†åˆæ“ä½œ"></a>2.2é›†åˆæ“ä½œ</h2><p>é›†åˆï¼Œç±»ä¼¼å…³ç³»å‹æ•°æ®åº“ä¸­çš„è¡¨ã€‚</p><p>å¯ä»¥æ˜¾ç¤ºçš„åˆ›å»ºï¼Œä¹Ÿå¯ä»¥éšå¼çš„åˆ›å»ºã€‚</p><h3 id="2-2-1-é›†åˆçš„æ˜¾å¼åˆ›å»º"><a href="#2-2-1-é›†åˆçš„æ˜¾å¼åˆ›å»º" class="headerlink" title="2.2.1 é›†åˆçš„æ˜¾å¼åˆ›å»º"></a>2.2.1 é›†åˆçš„æ˜¾å¼åˆ›å»º</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">nameï¼šè¦åˆ›å»ºçš„é›†åˆçš„åç§°</span></span><br><span class="line">db.createCollection(name)</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹å½“å‰åº“ä¸­çš„è¡¨ï¼šshow tableså‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">show collections </span><br><span class="line">æˆ–</span><br><span class="line">show tables</span><br></pre></td></tr></table></figure><p>é›†åˆçš„å‘½åè§„èŒƒï¼š</p><ul><li>é›†åˆåä¸èƒ½æ˜¯ç©ºå­—ç¬¦ä¸²â€â€ã€‚</li><li>é›†åˆåä¸èƒ½å«æœ‰\0å­—ç¬¦ï¼ˆç©ºå­—ç¬¦ï¼‰ï¼Œè¿™ä¸ªå­—ç¬¦è¡¨ç¤ºé›†åˆåçš„ç»“å°¾ã€‚</li><li>é›†åˆåä¸èƒ½ä»¥â€system.â€å¼€å¤´ï¼Œè¿™æ˜¯ä¸ºç³»ç»Ÿé›†åˆä¿ç•™çš„å‰ç¼€ã€‚</li><li>ç”¨æˆ·åˆ›å»ºçš„é›†åˆåå­—ä¸èƒ½å«æœ‰ä¿ç•™å­—ç¬¦ã€‚æœ‰äº›é©±åŠ¨ç¨‹åºçš„ç¡®æ”¯æŒåœ¨é›†åˆåé‡Œé¢åŒ…å«ï¼Œè¿™æ˜¯å› ä¸ºæŸäº›ç³»ç»Ÿç”Ÿæˆçš„é›†åˆä¸­åŒ…å«è¯¥å­—ç¬¦ã€‚é™¤éä½ è¦è®¿é—®è¿™ç§ç³»ç»Ÿåˆ›å»ºçš„é›†åˆï¼Œå¦åˆ™åƒä¸‡ä¸è¦åœ¨åå­—é‡Œå‡ºç°$ã€‚</li></ul><h3 id="2-2-2-é›†åˆçš„éšå¼åˆ›å»º"><a href="#2-2-2-é›†åˆçš„éšå¼åˆ›å»º" class="headerlink" title="2.2.2 é›†åˆçš„éšå¼åˆ›å»º"></a>2.2.2 é›†åˆçš„éšå¼åˆ›å»º</h3><p>å½“å‘ä¸€ä¸ªé›†åˆä¸­æ’å…¥ä¸€ä¸ªæ–‡æ¡£çš„æ—¶å€™ï¼Œå¦‚æœé›†åˆä¸å­˜åœ¨ï¼Œåˆ™ä¼šè‡ªåŠ¨åˆ›å»ºé›†åˆã€‚</p><h3 id="2-2-3-é›†åˆçš„åˆ é™¤"><a href="#2-2-3-é›†åˆçš„åˆ é™¤" class="headerlink" title="2.2.3 é›†åˆçš„åˆ é™¤"></a>2.2.3 é›†åˆçš„åˆ é™¤</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.collection.drop() </span><br><span class="line">æˆ–</span><br><span class="line">db.é›†åˆ.drop()</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¦‚æœæˆåŠŸåˆ é™¤é€‰å®šé›†åˆï¼Œåˆ™ drop() æ–¹æ³•è¿”å› <span class="literal">true</span>ï¼Œå¦åˆ™è¿”å› <span class="literal">false</span>ã€‚</span></span><br></pre></td></tr></table></figure><h2 id="2-3-æ–‡æ¡£åŸºæœ¬CRUD"><a href="#2-3-æ–‡æ¡£åŸºæœ¬CRUD" class="headerlink" title="2.3 æ–‡æ¡£åŸºæœ¬CRUD"></a>2.3 æ–‡æ¡£åŸºæœ¬CRUD</h2><p>æ–‡æ¡£ï¼ˆdocumentï¼‰çš„æ•°æ®ç»“æ„å’Œ JSON åŸºæœ¬ä¸€æ ·ã€‚</p><p>æ‰€æœ‰å­˜å‚¨åœ¨é›†åˆä¸­çš„æ•°æ®éƒ½æ˜¯ BSON æ ¼å¼ã€‚</p><h3 id="2-3-1-æ–‡æ¡£çš„æ’å…¥"><a href="#2-3-1-æ–‡æ¡£çš„æ’å…¥" class="headerlink" title="2.3.1 æ–‡æ¡£çš„æ’å…¥"></a>2.3.1 æ–‡æ¡£çš„æ’å…¥</h3><p>â‘ å•ä¸ªæ–‡æ¡£æ’å…¥<br>ä½¿ç”¨insert()æˆ–è€…save()å‘é›†åˆä¸­æ’å…¥æ–‡æ¡£</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">db.collection.insert( </span><br><span class="line">    &lt;document or array of documents&gt;, </span><br><span class="line">    &#123; </span><br><span class="line">        writeConcern: &lt;document&gt;, </span><br><span class="line">        ordered: &lt;boolean&gt; </span><br><span class="line">    &#125; </span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>å‚æ•°è¯´æ˜ï¼š</p><img src="/2023/05/20/MongoDB/4.png" class="" title="æ–‡æ¡£æ’å…¥æŒ‡ä»¤çš„å‚æ•°è¯´æ˜"><p>ä¾‹å­ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">db.comment.insert(</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;articleid&quot;: &quot;100000&quot;,</span><br><span class="line">        &quot;content&quot;: &quot;ä»Šå¤©å¤©æ°”çœŸå¥½,é˜³å…‰æ˜åªš&quot;,</span><br><span class="line">        &quot;userid&quot;: &quot;1001&quot;,</span><br><span class="line">        &quot;nickname&quot;: &quot;Rose&quot;,</span><br><span class="line">        &quot;createdatetime&quot;: new Date(),</span><br><span class="line">        &quot;likenum&quot;: NumberInt(10),</span><br><span class="line">        &quot;state&quot;: null</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>æç¤ºï¼š</p><ol><li>commenté›†åˆå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™ä¼šéšå¼åˆ›å»ºã€‚</li><li>mongoä¸­çš„æ•°å­—ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯doubleç±»å‹ï¼Œå¦‚æœè¦å­˜æ•´å‹ï¼Œå¿…é¡»ä½¿ç”¨å‡½æ•°NumberInt(æ•´å‹æ•°å­—)ï¼Œå¦åˆ™å–å‡ºæ¥å°±æœ‰é—®é¢˜äº†ã€‚</li><li>æ’å…¥å½“å‰æ—¥æœŸä½¿ç”¨ new Date()</li><li>æ’å…¥çš„æ•°æ®æ²¡æœ‰æŒ‡å®š _idï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆä¸»é”®å€¼</li><li>å¦‚æœæŸå­—æ®µæ²¡å€¼ï¼Œå¯ä»¥èµ‹å€¼ä¸ºnullï¼Œæˆ–ä¸å†™è¯¥å­—æ®µã€‚</li></ol><p>æ‰§è¡Œåï¼Œå¦‚ä¸‹ï¼Œè¯´æ˜æ’å…¥ä¸€ä¸ªæ•°æ®æˆåŠŸäº†ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WriteResult(&#123; &quot;nInserted&quot;: 1 &#125;)</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼š</p><ol><li>æ–‡æ¡£ä¸­çš„é”®&#x2F;å€¼å¯¹æ˜¯æœ‰åºçš„ã€‚</li><li>æ–‡æ¡£ä¸­çš„å€¼ä¸ä»…å¯ä»¥æ˜¯åœ¨åŒå¼•å·é‡Œé¢çš„å­—ç¬¦ä¸²ï¼Œè¿˜å¯ä»¥æ˜¯å…¶ä»–å‡ ç§æ•°æ®ç±»å‹ï¼ˆç”šè‡³å¯ä»¥æ˜¯æ•´ä¸ªåµŒå…¥çš„æ–‡æ¡£ï¼‰ã€‚</li><li>MongoDBåŒºåˆ†ç±»å‹å’Œå¤§å°å†™ã€‚</li><li>MongoDBçš„æ–‡æ¡£ä¸èƒ½æœ‰é‡å¤çš„é”®ã€‚</li><li>æ–‡æ¡£çš„é”®æ˜¯å­—ç¬¦ä¸²ã€‚é™¤äº†å°‘æ•°ä¾‹å¤–æƒ…å†µï¼Œé”®å¯ä»¥ä½¿ç”¨ä»»æ„UTF-8å­—ç¬¦ã€‚</li></ol><p>æ–‡æ¡£é”®å‘½åè§„èŒƒï¼š</p><ul><li>é”®ä¸èƒ½å«æœ‰\0 (ç©ºå­—ç¬¦)ã€‚è¿™ä¸ªå­—ç¬¦ç”¨æ¥è¡¨ç¤ºé”®çš„ç»“å°¾ã€‚</li><li>.å’Œ$æœ‰ç‰¹åˆ«çš„æ„ä¹‰ï¼Œåªæœ‰åœ¨ç‰¹å®šç¯å¢ƒä¸‹æ‰èƒ½ä½¿ç”¨ã€‚</li><li>ä»¥ä¸‹åˆ’çº¿â€_â€å¼€å¤´çš„é”®æ˜¯ä¿ç•™çš„(ä¸æ˜¯ä¸¥æ ¼è¦æ±‚çš„)ã€‚</li></ul><p>â‘¡æ‰¹é‡æ’å…¥</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">db.collection.insertMany( [ </span><br><span class="line">        &lt;document 1&gt;, </span><br><span class="line">        &lt;document 2&gt;,</span><br><span class="line">        ... </span><br><span class="line">    ], </span><br><span class="line">    &#123; </span><br><span class="line">        writeConcern: &lt;document&gt;, </span><br><span class="line">        ordered: &lt;boolean&gt; </span><br><span class="line">    &#125; </span><br><span class="line">)</span><br></pre></td></tr></table></figure><img src="/2023/05/20/MongoDB/5.png" class="" title="æ‰¹é‡æ’å…¥æŒ‡ä»¤çš„å‚æ•°è¯´æ˜"><p>ä¾‹å­ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">db.comment.insertMany([ </span><br><span class="line">        &#123;</span><br><span class="line">            &quot;_id&quot;: &quot;1&quot;,</span><br><span class="line">            &quot;articleid&quot;: &quot;100001&quot;,</span><br><span class="line">            &quot;content&quot;: &quot;æˆ‘ä»¬ä¸åº”è¯¥æŠŠæ¸…æ™¨æµªè´¹åœ¨æ‰‹æœºä¸Šï¼Œå¥åº·å¾ˆé‡è¦ï¼Œä¸€æ¯æ¸©æ°´å¹¸ç¦ä½ æˆ‘ä»–ã€‚&quot;,</span><br><span class="line">            &quot;userid&quot;: &quot;1002&quot;,</span><br><span class="line">            &quot;nickname&quot;: &quot;ç›¸å¿˜äºæ±Ÿæ¹–&quot;,</span><br><span class="line">            &quot;createdatetime&quot;: new Date(&quot;2019-08-05T22:08:15.522Z&quot;),</span><br><span class="line">            &quot;likenum&quot;:NumberInt(1000),</span><br><span class="line">            &quot;state&quot;:&quot;1&quot;</span><br><span class="line">        &#125;, </span><br><span class="line">        &#123;</span><br><span class="line">            &quot;_id&quot;:&quot;2&quot;,&quot;articleid&quot;:&quot;100001&quot;,&quot;content&quot;:&quot;æˆ‘å¤å¤©ç©ºè…¹å–å‡‰å¼€æ°´ï¼Œå†¬å¤©å–æ¸©å¼€æ°´&quot;,&quot;userid&quot;:&quot;1005&quot;,&quot;nickname&quot;:&quot;ä¼Šäººæ†” æ‚´&quot;,&quot;createdatetime&quot;:new Date(&quot;2019-08-05T23:58:51.485Z&quot;),&quot;likenum&quot;:NumberInt(888),&quot;state&quot;:&quot;1&quot;</span><br><span class="line">        &#125;, </span><br><span class="line">        &#123;</span><br><span class="line">            &quot;_id&quot;:&quot;3&quot;,&quot;articleid&quot;:&quot;100001&quot;,&quot;content&quot;:&quot;æˆ‘ä¸€ç›´å–å‡‰å¼€æ°´ï¼Œå†¬å¤©å¤å¤©éƒ½å–ã€‚&quot;,&quot;userid&quot;:&quot;1004&quot;,&quot;nickname&quot;:&quot;æ°å…‹èˆ¹ é•¿&quot;,&quot;createdatetime&quot;:new Date(&quot;2019-08-06T01:05:06.321Z&quot;),&quot;likenum&quot;:NumberInt(666),&quot;state&quot;:&quot;1&quot;</span><br><span class="line">        &#125;, </span><br><span class="line">        &#123;</span><br><span class="line">            &quot;_id&quot;:&quot;4&quot;,&quot;articleid&quot;:&quot;100001&quot;,&quot;content&quot;:&quot;ä¸“å®¶è¯´ä¸èƒ½ç©ºè…¹åƒé¥­ï¼Œå½±å“å¥åº·ã€‚&quot;,&quot;userid&quot;:&quot;1003&quot;,&quot;nickname&quot;:&quot;å‡¯ æ’’&quot;,&quot;createdatetime&quot;:new Date(&quot;2019-08-06T08:18:35.288Z&quot;),&quot;likenum&quot;:NumberInt(2000),&quot;state&quot;:&quot;1&quot;</span><br><span class="line">        &#125;, </span><br><span class="line">        &#123;</span><br><span class="line">            &quot;_id&quot;:&quot;5&quot;,&quot;articleid&quot;:&quot;100001&quot;,&quot;content&quot;:&quot;ç ”ç©¶è¡¨æ˜ï¼Œåˆšçƒ§å¼€çš„æ°´åƒä¸‡ä¸èƒ½å–ï¼Œå› ä¸ºçƒ« å˜´ã€‚&quot;,&quot;userid&quot;:&quot;1003&quot;,&quot;nickname&quot;:&quot;å‡¯æ’’&quot;,&quot;createdatetime&quot;:new Date(&quot;2019-08- 06T11:01:02.521Z&quot;),&quot;likenum&quot;:NumberInt(3000),&quot;state&quot;:&quot;1&quot;</span><br><span class="line">        &#125;</span><br><span class="line">]);</span><br></pre></td></tr></table></figure><p>æç¤ºï¼š</p><p>æ’å…¥æ—¶æŒ‡å®šäº†_id ï¼Œåˆ™ä¸»é”®å°±æ˜¯è¯¥å€¼ã€‚</p><p>å¦‚æœæŸæ¡æ•°æ®æ’å…¥å¤±è´¥ï¼Œå°†ä¼šç»ˆæ­¢æ’å…¥ï¼Œä½†å·²ç»æ’å…¥æˆåŠŸçš„æ•°æ®ä¸ä¼šå›æ»šæ‰ã€‚</p><p>å› ä¸ºæ‰¹é‡æ’å…¥ç”±äºæ•°æ®è¾ƒå¤šå®¹æ˜“å‡ºç°å¤±è´¥ï¼Œå› æ­¤ï¼Œå¯ä»¥ä½¿ç”¨try catchè¿›è¡Œå¼‚å¸¸æ•æ‰å¤„ç†ï¼Œæµ‹è¯•çš„æ—¶å€™å¯ä»¥ä¸å¤„ç†ã€‚<br>å¦‚:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">try &#123; </span><br><span class="line">    db.comment.insertMany([ </span><br><span class="line">        &#123;</span><br><span class="line">            &quot;_id&quot;:&quot;1&quot;,&quot;articleid&quot;:&quot;100001&quot;,&quot;content&quot;:&quot;æˆ‘ä»¬ä¸åº”è¯¥æŠŠæ¸…æ™¨æµªè´¹åœ¨æ‰‹æœºä¸Šï¼Œå¥åº·å¾ˆé‡è¦ï¼Œä¸€æ¯æ¸©æ°´å¹¸ç¦ä½ æˆ‘ ä»–ã€‚&quot;,&quot;userid&quot;:&quot;1002&quot;,&quot;nickname&quot;:&quot;ç›¸å¿˜äºæ±Ÿæ¹–&quot;,&quot;createdatetime&quot;:new Date(&quot;2019-08- 05T22:08:15.522Z&quot;),</span><br><span class="line">            &quot;likenum&quot;:NumberInt(1000),</span><br><span class="line">            &quot;state&quot;:&quot;1&quot;</span><br><span class="line">        &#125;, </span><br><span class="line">            &#123;&quot;_id&quot;:&quot;2&quot;,&quot;articleid&quot;:&quot;100001&quot;,&quot;content&quot;:&quot;æˆ‘å¤å¤©ç©ºè…¹å–å‡‰å¼€æ°´ï¼Œå†¬å¤©å–æ¸©å¼€æ°´&quot;,&quot;userid&quot;:&quot;1005&quot;,&quot;nickname&quot;:&quot;ä¼Šäººæ†” æ‚´&quot;,&quot;createdatetime&quot;:new Date(&quot;2019-08-05T23:58:51.485Z&quot;),</span><br><span class="line">            &quot;likenum&quot;:NumberInt(888),</span><br><span class="line">            &quot;state&quot;:&quot;1&quot;&#125;, </span><br><span class="line">            &#123;&quot;_id&quot;:&quot;3&quot;,&quot;articleid&quot;:&quot;100001&quot;,&quot;content&quot;:&quot;æˆ‘ä¸€ç›´å–å‡‰å¼€æ°´ï¼Œå†¬å¤©å¤å¤©éƒ½å–ã€‚&quot;,&quot;userid&quot;:&quot;1004&quot;,&quot;nickname&quot;:&quot;æ°å…‹èˆ¹ é•¿&quot;,&quot;createdatetime&quot;:new Date(&quot;2019-08-06T01:05:06.321Z&quot;),</span><br><span class="line">            &quot;likenum&quot;:NumberInt(666),</span><br><span class="line">            &quot;state&quot;:&quot;1&quot;&#125;, </span><br><span class="line">            &#123;&quot;_id&quot;:&quot;4&quot;,&quot;articleid&quot;:&quot;100001&quot;,&quot;content&quot;:&quot;ä¸“å®¶è¯´ä¸èƒ½ç©ºè…¹åƒé¥­ï¼Œå½±å“å¥åº·ã€‚&quot;,&quot;userid&quot;:&quot;1003&quot;,&quot;nickname&quot;:&quot;å‡¯ æ’’&quot;,&quot;createdatetime&quot;:new Date(&quot;2019-08-06T08:18:35.288Z&quot;),</span><br><span class="line">            &quot;likenum&quot;:NumberInt(2000),</span><br><span class="line">            &quot;state&quot;:&quot;1&quot;&#125;, </span><br><span class="line">            &#123;&quot;_id&quot;:&quot;5&quot;,&quot;articleid&quot;:&quot;100001&quot;,&quot;content&quot;:&quot;ç ”ç©¶è¡¨æ˜ï¼Œåˆšçƒ§å¼€çš„æ°´åƒä¸‡ä¸èƒ½å–ï¼Œå› ä¸ºçƒ« å˜´ã€‚&quot;,&quot;userid&quot;:&quot;1003&quot;,&quot;nickname&quot;:&quot;å‡¯æ’’&quot;,&quot;createdatetime&quot;:new Date(&quot;2019-08- 06T11:01:02.521Z&quot;),</span><br><span class="line">            &quot;likenum&quot;:NumberInt(3000),</span><br><span class="line">            &quot;state&quot;:&quot;1&quot;</span><br><span class="line">        &#125; </span><br><span class="line">    ]); </span><br><span class="line">&#125; catch (e) &#123; </span><br><span class="line">    print (e); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-3-2-æ–‡æ¡£çš„åŸºæœ¬æŸ¥è¯¢"><a href="#2-3-2-æ–‡æ¡£çš„åŸºæœ¬æŸ¥è¯¢" class="headerlink" title="2.3.2 æ–‡æ¡£çš„åŸºæœ¬æŸ¥è¯¢"></a>2.3.2 æ–‡æ¡£çš„åŸºæœ¬æŸ¥è¯¢</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.collection.find(&lt;query&gt;, [projection])</span><br></pre></td></tr></table></figure><img src="/2023/05/20/MongoDB/6.png" class="" title="æ–‡æ¡£çš„åŸºæœ¬æŸ¥è¯¢æŒ‡ä»¤çš„å‚æ•°è¯´æ˜"><p>ä¾‹å­ï¼š</p><p>â‘ æŸ¥è¯¢æ‰€æœ‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¦‚æœæˆ‘ä»¬è¦æŸ¥è¯¢spité›†åˆçš„æ‰€æœ‰æ–‡æ¡£ï¼Œæˆ‘ä»¬è¾“å…¥ä»¥ä¸‹å‘½ä»¤</span></span><br><span class="line">db.comment.find() </span><br><span class="line">æˆ–</span><br><span class="line">db.comment.find(&#123;&#125;)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä½ ä¼šå‘ç°æ¯æ¡æ–‡æ¡£ä¼šæœ‰ä¸€ä¸ªå«_idçš„å­—æ®µï¼Œè¿™ä¸ªç›¸å½“äºæˆ‘ä»¬åŸæ¥å…³ç³»æ•°æ®åº“ä¸­è¡¨çš„ä¸»é”®ï¼Œå½“ä½ åœ¨æ’å…¥æ–‡æ¡£è®°å½•æ—¶æ²¡æœ‰æŒ‡å®šè¯¥å­—æ®µï¼ŒMongoDBä¼šè‡ªåŠ¨åˆ›å»ºï¼Œå…¶ç±»å‹æ˜¯ObjectIDç±»å‹ã€‚</p><p>å¦‚æœæˆ‘ä»¬åœ¨æ’å…¥æ–‡æ¡£è®°å½•æ—¶æŒ‡å®šè¯¥å­—æ®µä¹Ÿå¯ä»¥ï¼Œå…¶ç±»å‹å¯ä»¥æ˜¯ObjectIDç±»å‹ï¼Œä¹Ÿå¯ä»¥æ˜¯MongoDBæ”¯æŒçš„ä»»æ„ç±»å‹ã€‚</p><p>å¦‚æœæˆ‘æƒ³æŒ‰ä¸€å®šæ¡ä»¶æ¥æŸ¥è¯¢ï¼Œæ¯”å¦‚æˆ‘æƒ³æŸ¥è¯¢useridä¸º1003çš„è®°å½•ï¼Œæ€ä¹ˆåŠï¼Ÿå¾ˆç®€å•ï¼åªè¦åœ¨find()ä¸­æ·»åŠ å‚æ•°å³å¯ï¼Œå‚æ•°ä¹Ÿæ˜¯jsonæ ¼å¼ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.comment.find(&#123;userid:&#x27;1003&#x27;&#125;)</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ åªéœ€è¦è¿”å›ç¬¦åˆæ¡ä»¶çš„ç¬¬ä¸€æ¡æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨findOneå‘½ä»¤æ¥å®ç°ï¼Œè¯­æ³•å’Œfindä¸€æ ·ã€‚<br>å¦‚ï¼šæŸ¥è¯¢ç”¨æˆ·ç¼–å·æ˜¯1003çš„è®°å½•ï¼Œä½†åªæœ€å¤šè¿”å›ç¬¦åˆæ¡ä»¶çš„ç¬¬ä¸€æ¡è®°å½•</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.comment.findOne(&#123;userid:&#x27;1003&#x27;&#125;)</span><br></pre></td></tr></table></figure><p>â‘¡æŠ•å½±æŸ¥è¯¢ï¼ˆProjection Queryï¼‰ï¼š</p><p>å¦‚æœè¦æŸ¥è¯¢ç»“æœè¿”å›éƒ¨åˆ†å­—æ®µï¼Œåˆ™éœ€è¦ä½¿ç”¨æŠ•å½±æŸ¥è¯¢ï¼ˆä¸æ˜¾ç¤ºæ‰€æœ‰å­—æ®µï¼Œåªæ˜¾ç¤ºæŒ‡å®šçš„å­—æ®µï¼‰ã€‚</p><p>å¦‚ï¼šæŸ¥è¯¢ç»“æœåªæ˜¾ç¤º _idã€useridã€nicknameï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.comment.find(&#123;userid:&quot;1003&quot;&#125;,&#123;userid:1,nickname:1&#125;) </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">å‡ºç°å¦‚ä¸‹ç»“æœ</span></span><br><span class="line">&#123; &quot;_id&quot; : &quot;4&quot;, &quot;userid&quot; : &quot;1003&quot;, &quot;nickname&quot; : &quot;å‡¯æ’’&quot; &#125; </span><br><span class="line">&#123; &quot;_id&quot; : &quot;5&quot;, &quot;userid&quot; : &quot;1003&quot;, &quot;nickname&quot; : &quot;å‡¯æ’’&quot; &#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°é»˜è®¤ _id ä¼šè‡ªåŠ¨æ˜¾ç¤ºã€‚</p><p>å¦‚æœä¸æƒ³è®©ä»–å‡ºç°å¯ä»¥è¿™æ ·æ“ä½œï¼š<br>å¦‚ï¼šæŸ¥è¯¢ç»“æœåªæ˜¾ç¤º ã€useridã€nickname ï¼Œä¸æ˜¾ç¤º _id ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.comment.find(&#123;userid:&quot;1003&quot;&#125;,&#123;userid:1,nickname:1,_id:0&#125;) </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">å‡ºç°å¦‚ä¸‹ç»“æœ</span></span><br><span class="line">&#123; &quot;userid&quot; : &quot;1003&quot;, &quot;nickname&quot; : &quot;å‡¯æ’’&quot; &#125; </span><br><span class="line">&#123; &quot;userid&quot; : &quot;1003&quot;, &quot;nickname&quot; : &quot;å‡¯æ’’&quot; &#125;</span><br></pre></td></tr></table></figure><h3 id="2-3-3-æ–‡æ¡£çš„æ›´æ–°"><a href="#2-3-3-æ–‡æ¡£çš„æ›´æ–°" class="headerlink" title="2.3.3 æ–‡æ¡£çš„æ›´æ–°"></a>2.3.3 æ–‡æ¡£çš„æ›´æ–°</h3><p>æ›´æ–°æ–‡æ¡£çš„è¯­æ³•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">db.collection.update(query, update, options) </span><br><span class="line">//æˆ– </span><br><span class="line">db.collection.update( </span><br><span class="line">    &lt;query&gt;, </span><br><span class="line">    &lt;update&gt;, </span><br><span class="line">    &#123; </span><br><span class="line">        upsert: &lt;boolean&gt;, </span><br><span class="line">        multi: &lt;boolean&gt;, </span><br><span class="line">        writeConcern: &lt;document&gt;, </span><br><span class="line">        collation: &lt;document&gt;, </span><br><span class="line">        arrayFilters: [ </span><br><span class="line">            &lt;filterdocument1&gt;, </span><br><span class="line">            ... </span><br><span class="line">        ], </span><br><span class="line">        hint: &lt;document|string&gt; // Available starting in MongoDB 4.2 </span><br><span class="line">    &#125; </span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>å‚æ•°ï¼š</p><img src="/2023/05/20/MongoDB/7.png" class="" title="æ–‡æ¡£çš„æ›´æ–°æŒ‡ä»¤çš„å‚æ•°è¯´æ˜"><h3 id="2-3-4-æ–‡æ¡£çš„åˆ é™¤"><a href="#2-3-4-æ–‡æ¡£çš„åˆ é™¤" class="headerlink" title="2.3.4 æ–‡æ¡£çš„åˆ é™¤"></a>2.3.4 æ–‡æ¡£çš„åˆ é™¤</h3><p>â‘ db.<collection_name>.deleteMany()<br>åˆ é™¤æ‰€æœ‰åŒ¹é…çš„æ–‡æ¡£.</p><p>â‘¡db.<collection_name>.deleteOne()<br>åˆ é™¤å•ä¸ªåŒ¹é…çš„æ–‡æ¡£</p><p>ä¾‹1ï¼šåˆ é™¤ userId&#x3D;456 çš„æ‰€æœ‰æ–‡æ¡£</p><img src="/2023/05/20/MongoDB/8.png" class="" title="æ–‡æ¡£çš„åˆ é™¤æ¼”ç¤º"><h1 id="3-ç´¢å¼•"><a href="#3-ç´¢å¼•" class="headerlink" title="3 ç´¢å¼•"></a>3 ç´¢å¼•</h1><p>MongoDBä¸­çš„ç´¢å¼•ä½¿å¾—å…¶æŸ¥è¯¢æ•ˆç‡å˜å¾—æ›´é«˜äº†ï¼ŒMongoDBçš„ç´¢å¼•åŸç†å’ŒMySQLçš„ä¸€æ ·ã€‚</p><h2 id="3-1-ç´¢å¼•çš„åˆ†ç±»"><a href="#3-1-ç´¢å¼•çš„åˆ†ç±»" class="headerlink" title="3.1 ç´¢å¼•çš„åˆ†ç±»"></a>3.1 ç´¢å¼•çš„åˆ†ç±»</h2><p>1ã€å•å­—æ®µç´¢å¼•<br>MongoDB æ”¯æŒåœ¨æ–‡æ¡£çš„å•ä¸ªå­—æ®µä¸Šåˆ›å»ºç”¨æˆ·å®šä¹‰çš„å‡åº&#x2F;é™åºç´¢å¼•, ç§°ä¸ºå•å­—æ®µç´¢å¼•</p><p>2ã€å¤åˆç´¢å¼•<br>MongoDB æ”¯æŒå¤šä¸ªå­—æ®µçš„ç”¨æˆ·å®šä¹‰ç´¢å¼•, å³å¤åˆç´¢å¼• </p><p>3ã€åœ°ç†ç©ºé—´ç´¢å¼•<br>ä¸ºäº†æ”¯æŒå¯¹åœ°ç†ç©ºé—´åæ ‡æ•°æ®çš„æœ‰æ•ˆæŸ¥è¯¢, MongoDB æä¾›äº†ä¸¤ç§ç‰¹æ®Šçš„ç´¢å¼•: è¿”å›ç»“æœæ—¶ä½¿ç”¨å¹³é¢å‡ ä½•çš„äºŒç»´ç´¢å¼•å’Œè¿”å›ç»“æœæ—¶ä½¿ç”¨çƒé¢å‡ ä½•çš„äºŒç»´çƒé¢ç´¢å¼•</p><p>4ã€å“ˆå¸Œç´¢å¼•<br>ä¸ºäº†æ”¯æŒåŸºäºæ•£åˆ—çš„åˆ†ç‰‡, MongoDB æä¾›äº†æ•£åˆ—ç´¢å¼•ç±»å‹, å®ƒå¯¹å­—æ®µå€¼çš„æ•£åˆ—è¿›è¡Œç´¢å¼•.è¿™äº›ç´¢å¼•åœ¨å…¶èŒƒå›´å†…çš„å€¼åˆ†å¸ƒæ›´åŠ éšæœº, ä½†åªæ”¯æŒç›¸ç­‰åŒ¹é…, ä¸æ”¯æŒåŸºäºèŒƒå›´çš„æŸ¥è¯¢.</p><p>5ã€æ–‡æœ¬ç´¢å¼•<br>MongoDB æä¾›äº†ä¸€ç§æ–‡æœ¬ç´¢å¼•ç±»å‹, æ”¯æŒåœ¨é›†åˆä¸­æœç´¢å­—ç¬¦ä¸²å†…å®¹ï¼Œè¿™äº›æ–‡æœ¬ç´¢å¼•ä¸å­˜å‚¨ç‰¹å®šäºè¯­è¨€çš„åœæ­¢è¯ï¼ˆä¾‹å¦‚ â€œtheâ€, â€œaâ€, â€œorâ€ï¼‰, è€Œå°†é›†åˆä¸­çš„è¯ä½œä¸ºè¯å¹², åªå­˜å‚¨æ ¹è¯ã€‚</p><h2 id="3-2-ç´¢å¼•çš„ç›¸å…³å‘½ä»¤"><a href="#3-2-ç´¢å¼•çš„ç›¸å…³å‘½ä»¤" class="headerlink" title="3.2 ç´¢å¼•çš„ç›¸å…³å‘½ä»¤"></a>3.2 ç´¢å¼•çš„ç›¸å…³å‘½ä»¤</h2><p>â‘ db.<collection_name>.getIndexes() æŸ¥çœ‹ç´¢å¼•</p><img src="/2023/05/20/MongoDB/9.png" class="" title="æŸ¥çœ‹ç´¢å¼•"><p>â‘¡db.<collection_name>.createIndex() åˆ›å»ºç´¢å¼•</p><img src="/2023/05/20/MongoDB/10.png" class="" title="åˆ›å»ºç´¢å¼•"><p>â‘¢db.Test.dropIndex() åˆ é™¤ç´¢å¼•</p><p>db.Test.dropIndexes() åˆ é™¤æ‰€æœ‰ç´¢å¼•ã€é»˜è®¤çš„_idç´¢å¼•ä¸ä¼šè¢«åˆ é™¤ã€‘</p><img src="/2023/05/20/MongoDB/11.png" class="" title="åˆ é™¤ç´¢å¼•"><p>â‘£explain() æŸ¥çœ‹æ‰§è¡Œè®¡åˆ’</p><img src="/2023/05/20/MongoDB/12.png" class="" title="æŸ¥çœ‹æ‰§è¡Œè®¡åˆ’"><h1 id="4-å‰¯æœ¬é›†"><a href="#4-å‰¯æœ¬é›†" class="headerlink" title="4 å‰¯æœ¬é›†"></a>4 å‰¯æœ¬é›†</h1><p>MongoDB é€šè¿‡ä½¿ç”¨å‰¯æœ¬é›†æ¥å®ç°å¤åˆ¶ï¼Œå‰¯æœ¬é›†åªèƒ½æœ‰ä¸€ä¸ªä¸»èŠ‚ç‚¹ã€‚</p><ul><li>å‰¯æœ¬é›†æ˜¯ä¸€ç»„ä¸¤ä¸ªæˆ–æ›´å¤šèŠ‚ç‚¹ï¼ˆé€šå¸¸æœ€å°‘éœ€è¦ 3 ä¸ªèŠ‚ç‚¹ï¼‰ï¼›</li><li>åœ¨å‰¯æœ¬é›†ä¸­ï¼Œä¸€ä¸ªèŠ‚ç‚¹æ˜¯ä¸»è¦èŠ‚ç‚¹ï¼Œå…¶ä½™èŠ‚ç‚¹æ˜¯ä»èŠ‚ç‚¹ï¼›</li><li>æ‰€æœ‰æ•°æ®ä»ä¸»èŠ‚ç‚¹å¤åˆ¶åˆ°ä»èŠ‚ç‚¹ï¼›</li><li>åœ¨è‡ªåŠ¨æ•…éšœè½¬ç§»æˆ–ç»´æŠ¤æ—¶ï¼Œå°†ä¸ºä¸»èŠ‚ç‚¹å»ºç«‹é€‰ä¸¾ï¼Œå¹¶é€‰ä¸¾ä¸€ä¸ªæ–°çš„ä¸»èŠ‚ç‚¹ï¼›</li><li>æ¢å¤å¤±è´¥çš„èŠ‚ç‚¹åï¼Œå®ƒå†æ¬¡åŠ å…¥å‰¯æœ¬é›†å¹¶ç”¨ä½œè¾…åŠ©èŠ‚ç‚¹ã€‚</li><li>å‰¯æœ¬é›†ä¸­ï¼Œä¸»èŠ‚ç‚¹ å’Œ ä»èŠ‚ç‚¹ ä¸­æ•°æ®æ˜¯ä¸€æ ·çš„ï¼Œä»èŠ‚ç‚¹å’Œä¸»èŠ‚ç‚¹ä¿æŒä¸€è‡´</li></ul><img src="/2023/05/20/MongoDB/13.png" class="" title="å‰¯æœ¬é›†"><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å‰¯æœ¬é›†æ˜¯æŒ‡åŒä¸€ä»½æ•°æ®è¢«ä¿å­˜åˆ°Nä¸ªæœºå™¨ä¸Šï¼Œæ¯ä¸ªæœºå™¨ä¸Šéƒ½æ˜¯æƒ³åŒçš„æ•°æ®ã€‚</span><br><span class="line"></span><br><span class="line">åˆ†ç‰‡æ˜¯æŒ‡ä¸€ä»½æ•°æ®è¢«åˆ†ç¦»å¼€ä¿å­˜åˆ°Nä¸ªæœºå™¨ä¸Šï¼ŒNä¸ªæœºå™¨ä¸Šçš„æ•°æ®ç»„åˆèµ·æ¥æ˜¯ä¸€ä»½æ•°æ®ã€‚</span><br></pre></td></tr></table></figure><h1 id="5-åˆ†ç‰‡"><a href="#5-åˆ†ç‰‡" class="headerlink" title="5 åˆ†ç‰‡"></a>5 åˆ†ç‰‡</h1><h2 id="5-1-åˆ†ç‰‡æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#5-1-åˆ†ç‰‡æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="5.1 åˆ†ç‰‡æ˜¯ä»€ä¹ˆï¼Ÿ"></a>5.1 åˆ†ç‰‡æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>åˆ†ç‰‡æ˜¯<strong>è·¨å¤šå°æœºå™¨å­˜å‚¨æ•°æ®</strong>çš„è¿‡ç¨‹ï¼Œå®ƒæ˜¯ MongoDB æ»¡è¶³æ•°æ®å¢é•¿éœ€æ±‚çš„æ–¹æ³•ã€‚éšç€æ•°æ®çš„ä¸æ–­å¢åŠ ï¼Œå•å°æœºå™¨å¯èƒ½ä¸è¶³ä»¥å­˜å‚¨å…¨éƒ¨æ•°æ®ï¼Œä¹Ÿæ— æ³•æä¾›è¶³å¤Ÿçš„è¯»å†™ååé‡ã€‚é€šè¿‡åˆ†ç‰‡ï¼Œå¯ä»¥æ·»åŠ æ›´å¤šè®¡ç®—æœºæ¥æ»¡è¶³æ•°æ®å¢é•¿å’Œè¯»&#x2F;å†™æ“ä½œçš„éœ€æ±‚ã€‚<strong>åˆ†ç‰‡ä¸­ï¼Œä¸åŒæœºå™¨å†…å­˜å‚¨çš„æ•°æ®æ˜¯ä¸ä¸€æ ·çš„</strong></p><h2 id="5-2-æœ‰å‰¯æœ¬é›†ä¸å°±å¤Ÿäº†ï¼Œä¸ºä»€ä¹ˆè¦åˆ†ç‰‡ï¼Ÿ"><a href="#5-2-æœ‰å‰¯æœ¬é›†ä¸å°±å¤Ÿäº†ï¼Œä¸ºä»€ä¹ˆè¦åˆ†ç‰‡ï¼Ÿ" class="headerlink" title="5.2 æœ‰å‰¯æœ¬é›†ä¸å°±å¤Ÿäº†ï¼Œä¸ºä»€ä¹ˆè¦åˆ†ç‰‡ï¼Ÿ"></a>5.2 æœ‰å‰¯æœ¬é›†ä¸å°±å¤Ÿäº†ï¼Œä¸ºä»€ä¹ˆè¦åˆ†ç‰‡ï¼Ÿ</h2><ul><li>åœ¨å¤åˆ¶ä¸­ï¼Œæ‰€æœ‰å†™æ“ä½œéƒ½å°†è½¬åˆ°ä¸»èŠ‚ç‚¹ï¼›</li><li>å¯¹å»¶è¿Ÿæ•æ„Ÿçš„æŸ¥è¯¢ä»ä¼šè½¬åˆ°ä¸»æŸ¥è¯¢ï¼›</li><li>å•ä¸ªå‰¯æœ¬é›†é™åˆ¶ä¸º 12 ä¸ªèŠ‚ç‚¹ï¼›</li><li>å½“æ´»åŠ¨æ•°æ®é›†å¾ˆå¤§æ—¶ï¼Œä¼šå‡ºç°å†…å­˜ä¸è¶³ï¼›</li><li>æœ¬åœ°ç£ç›˜ä¸å¤Ÿå¤§ï¼›</li><li>å‚ç›´æ‰©å±•ä»·æ ¼æ˜‚è´µã€‚</li></ul><h2 id="5-3-åˆ†ç‰‡ç»“æ„"><a href="#5-3-åˆ†ç‰‡ç»“æ„" class="headerlink" title="5.3 åˆ†ç‰‡ç»“æ„"></a>5.3 åˆ†ç‰‡ç»“æ„</h2><img src="/2023/05/20/MongoDB/14.png" class="" title="åˆ†ç‰‡ç»“æ„"><ul><li>Shardsï¼ˆç¢ç‰‡ï¼‰ï¼šç”¨äº<strong>å­˜å‚¨å®é™…çš„æ•°æ®å—</strong>ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæ¯ä¸ªåˆ†ç‰‡éƒ½æ˜¯ä¸€ä¸ªå•ç‹¬çš„å‰¯æœ¬é›†ï¼Œå®ƒä»¬æä¾›äº†é«˜å¯ç”¨æ€§å’Œæ•°æ®ä¸€è‡´æ€§ï¼›</li><li>Config Serversï¼ˆé…ç½®æœåŠ¡å™¨ï¼‰ï¼šç”¨äºå­˜å‚¨é›†ç¾¤çš„å…ƒæ•°æ®ï¼Œæ­¤æ•°æ®åŒ…å«é›†ç¾¤æ•°æ®é›†åˆ°ç¢ç‰‡çš„æ˜ å°„ã€‚æŸ¥è¯¢è·¯ç”±å™¨ä½¿ç”¨æ­¤å…ƒæ•°æ®å°†æ“ä½œå®šå‘åˆ°ç‰¹å®šçš„ç¢ç‰‡ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œåˆ†ç‰‡ç¾¤é›†æ°å¥½å…·æœ‰ 3 ä¸ªé…ç½®æœåŠ¡å™¨ï¼›</li><li>Query Routersï¼ˆæŸ¥è¯¢è·¯ç”±å™¨ï¼‰ï¼šæŸ¥è¯¢è·¯ç”±å™¨åŸºæœ¬ä¸Šéƒ½æ˜¯ mongo å®ä¾‹ï¼Œå¯ä¸å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºæ¥å£å¹¶å°†æ“ä½œå®šå‘åˆ°é€‚å½“çš„åˆ†ç‰‡ã€‚<strong>æŸ¥è¯¢è·¯ç”±å™¨å¤„ç†æ“ä½œå¹¶å°†å…¶å®šä½åˆ°åˆ†ç‰‡ï¼Œç„¶åå°†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯</strong>ã€‚åˆ†ç‰‡ç¾¤é›†å¯ä»¥åŒ…å«å¤šä¸ªæŸ¥è¯¢è·¯ç”±å™¨æ¥åˆ’åˆ†å®¢æˆ·ç«¯è¯·æ±‚è´Ÿè½½ã€‚å®¢æˆ·ç«¯å°†è¯·æ±‚å‘é€åˆ°ä¸€ä¸ªæŸ¥è¯¢è·¯ç”±å™¨ã€‚é€šå¸¸ï¼Œ<strong>åˆ†ç‰‡ç¾¤é›†å…·æœ‰è®¸å¤šæŸ¥è¯¢è·¯ç”±å™¨</strong>ã€‚</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> MongoDB </tag>
            
            <tag> éå…³ç³»å‹æ•°æ®åº“ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
